
<!doctype html>
<html lang="ca" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://cipfpbatoi.github.io/dwes2223/03phpoo.html">
      
      <link rel="icon" href="imagenes/favicon.png">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-8.2.5">
    
    
      
        <title>3.- PHP Orientat a Objectes - Desenvolupament web en entorn de Servidor</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.2d9f7617.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.e6a45f82.min.css">
        
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL(".",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  


  <script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-X6D0LR7TC8"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&gtag("event","search",{search_term:this.value})}),"undefined"!=typeof location$&&location$.subscribe(function(e){gtag("config","G-X6D0LR7TC8",{page_path:e.pathname})})})</script>
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-X6D0LR7TC8"></script>


    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="light-blue" data-md-color-accent="teal">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#php-orientant-a-objectes" class="md-skip">
          Salta el contingut
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="index.html" title="Desenvolupament web en entorn de Servidor" class="md-header__button md-logo" aria-label="Desenvolupament web en entorn de Servidor" data-md-component="logo">
      
  <img src="imagenes/logofp.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Desenvolupament web en entorn de Servidor
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              3.- PHP Orientat a Objectes
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="light-blue" data-md-color-accent="teal"  aria-label="Canviar a mode nit"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Canviar a mode nit" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
            </label>
          
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="light-blue" data-md-color-accent="teal"  aria-label="Canviar a mode dia"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Canviar a mode dia" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Cerca" placeholder="Cerca" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="index.html" title="Desenvolupament web en entorn de Servidor" class="md-nav__button md-logo" aria-label="Desenvolupament web en entorn de Servidor" data-md-component="logo">
      
  <img src="imagenes/logofp.png" alt="logo">

    </a>
    Desenvolupament web en entorn de Servidor
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="index.html" class="md-nav__link">
        Inicio
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="01arquitecturas.html" class="md-nav__link">
        1.- Arquitectures Web
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="02php.html" class="md-nav__link">
        2.- El llenguatge PHP
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          3.- PHP Orientat a Objectes
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="03phpoo.html" class="md-nav__link md-nav__link--active">
        3.- PHP Orientat a Objectes
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Taula de continguts">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Taula de continguts
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#classes-i-objectes" class="md-nav__link">
    Classes i Objectes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#encapsulacio" class="md-nav__link">
    Encapsulació
  </a>
  
    <nav class="md-nav" aria-label="Encapsulació">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rebent-i-enviant-objectes" class="md-nav__link">
    Rebent i enviant objectes
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#constructor" class="md-nav__link">
    Constructor
  </a>
  
    <nav class="md-nav" aria-label="Constructor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#constructors-en-php-8" class="md-nav__link">
    Constructors en PHP 8
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#classes-estatiques" class="md-nav__link">
    Classes estàtiques
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#classes-estatiques_1" class="md-nav__link">
    Classes estàtiques
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#introspeccio" class="md-nav__link">
    Introspecció
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#herencia" class="md-nav__link">
    Herència
  </a>
  
    <nav class="md-nav" aria-label="Herència">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sobreescriure-metodes" class="md-nav__link">
    Sobreescriure mètodes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#constructor-en-fills" class="md-nav__link">
    Constructor en fills
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#classes-abstractes" class="md-nav__link">
    Classes abstractes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#classes-finals" class="md-nav__link">
    Classes finals
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#interficies" class="md-nav__link">
    Interfícies
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#metodes-encadenats" class="md-nav__link">
    Mètodes encadenats
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#metodes-magics" class="md-nav__link">
    Mètodes màgics
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#espai-de-noms" class="md-nav__link">
    Espai de noms
  </a>
  
    <nav class="md-nav" aria-label="Espai de noms">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#acces" class="md-nav__link">
    Accés
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#acces_1" class="md-nav__link">
    Accés
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#organitzacio" class="md-nav__link">
    Organització
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#autoload" class="md-nav__link">
    Autoload
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gestio-derrors" class="md-nav__link">
    Gestió d'Errors
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#excepcions" class="md-nav__link">
    Excepcions
  </a>
  
    <nav class="md-nav" aria-label="Excepcions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#creant-excepcions" class="md-nav__link">
    Creant excepcions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#excepcions-multiples" class="md-nav__link">
    Excepcions múltiples
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rellancar-excepcions" class="md-nav__link">
    Rellançar excepcions
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spl" class="md-nav__link">
    SPL
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#referencies" class="md-nav__link">
    Referències
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#activitats" class="md-nav__link">
    Activitats
  </a>
  
    <nav class="md-nav" aria-label="Activitats">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#objetos" class="md-nav__link">
    Objetos
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#projecte-videoclub" class="md-nav__link">
    Projecte Videoclub
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#projecte-videoclub-20" class="md-nav__link">
    Projecte Videoclub 2.0
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="04web.html" class="md-nav__link">
        4.- Programació Web
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="05herramientas.html" class="md-nav__link">
        5.- Ferramentes Web
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="06accesoDatos.html" class="md-nav__link">
        6.- Accès a Dades
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="07frameworks.html" class="md-nav__link">
        7.- Frameworks PHP - Laravel
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="08frameworks2.html" class="md-nav__link">
        8.- Ús avançat de Frameworks
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="09rest.html" class="md-nav__link">
        8.- Serveis REST
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                


<h1 id="php-orientant-a-objectes">PHP Orientant a Objectes<a class="headerlink" href="#php-orientant-a-objectes" title="Permanent link">&para;</a></h1>
<details class="abstract">
<summary>Duració i criteris d'avaluació</summary>
<p>Duració estimada: 18 hores</p>
<hr />
<table>
<thead>
<tr>
<th>Resultat d'aprenentatge</th>
<th>Criteris d'avaluació</th>
</tr>
</thead>
<tbody>
<tr>
<td>5. Desenvolupa aplicacions Web identificant i aplicant mecanismes per a separar el codi de presentació de la lògica de negoci.</td>
<td>a) S'han identificat els avantatges de separar la lògica de negoci dels aspectes de presentació de l'aplicació. <br/> b) S'han analitzat tecnologies i mecanismes que permeten realitzar aquesta separació i les seues característiques principals. <br/> c) S'han utilitzat objectes i controls en el servidor per a generar l'aspecte visual de l'aplicació Web en el client. <br/> d) S’han utilitzat formularis generats de forma dinàmica per a respondre als esdeveniments de l'aplicació Web. <br/> e) S'han identificat i aplicat els paràmetres relatius a la configuració de l'aplicació Web. <br/> f) S'han escrit aplicacions Web amb manteniment d'estat i separació de la lògica de negoci. <br/> g) S'han aplicat els principis de la programació orientada a objectes. <br/> g) S'ha provat i documentat el codi.</td>
</tr>
</tbody>
</table>
</details>
<h2 id="classes-i-objectes">Classes i Objectes<a class="headerlink" href="#classes-i-objectes" title="Permanent link">&para;</a></h2>
<p>PHP segueix un paradigma de programació orientada a objectes (POO) basada en classes.</p>
<p>Un classe és un plantilla que defineix les propietats i mètodes per a poder crear objectes. D'aquest manera, un objecte és una instància d'una classe.</p>
<p>Tant les propietats com els mètodes es defineixen amb una visibilitat (qui pot accedir)</p>
<ul>
<li>Privat - <code>private</code>: Només pot accedir la pròpia classe.</li>
<li>Protegit - <code>protected</code>: Només pot accedir la pròpia classe o els seus descendents.</li>
<li>Público - <code>public</code>: Pot accedir qualsevol altra classe.</li>
</ul>
<p>Per a declarar una classe, s'utilitza la paraula clau <code>class</code> seguit del nom de la classe. Per a instanciar un objecte a partir de la classe, s'utilitza <code>new</code>:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos="2 "></span><span class="k">class</span> <span class="nc">NomClase</span> <span class="p">{</span>
<span class="linenos" data-linenos="3 "></span><span class="c1">// propiedades</span>
<span class="linenos" data-linenos="4 "></span><span class="c1">// y métodos</span>
<span class="linenos" data-linenos="5 "></span><span class="p">}</span>
<span class="linenos" data-linenos="6 "></span>
<span class="linenos" data-linenos="7 "></span><span class="nv">$ob</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">NomClase</span><span class="p">();</span>
</code></pre></div>
<div class="admonition important">
<p class="admonition-title">Classes amb majúscula</p>
<p>Totes les classes comencen per lletra majúscula.</p>
</div>
<p>Quan un projecte creix, és normal modelar les classes mitjançant UML (recordeu Entorns de Desenvolupament?). La classes es representen mitjançant un quadrat, separant el nom, de les propietats i els mètodes:</p>
<p><img alt="UML" src="imagenes/03/uml.png" width="500" /></p>
<p>Una vegada que hem creat un objecte, s'utilitza l'operador <code>-&gt;</code> per a accedir a una propietat o un mètode:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">$objeto-&gt;propiedad;</span>
<span class="linenos" data-linenos="2 "></span><span class="x">$objeto-&gt;método(parámetros);</span>
</code></pre></div>
<p>Si des de dins de la classe, volem accedir a una propietat o mètode de la mateixa classe, utilitzarem la referència <code>$this</code>;</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">$this-&gt;propiedad;</span>
<span class="linenos" data-linenos="2 "></span><span class="x">$this-&gt;método(parámetros);  </span>
</code></pre></div>
<p>Així doncs, com a exemple, codificaríem una persona en el fitxer <code>Persona.php</code> com:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos=" 2 "></span><span class="k">class</span> <span class="nc">Persona </span><span class="p">{</span>
<span class="linenos" data-linenos=" 3 "></span>    <span class="k">private</span> <span class="nx">string</span> <span class="nv">$nombre</span><span class="p">;</span>
<span class="linenos" data-linenos=" 4 "></span>
<span class="linenos" data-linenos=" 5 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="nf">setNombre</span><span class="p">(</span><span class="nx">string</span> <span class="nv">$nom</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-linenos=" 6 "></span>        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">nombre</span><span class="o">=</span><span class="nv">$nom</span><span class="p">;</span>
<span class="linenos" data-linenos=" 7 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos=" 8 "></span>
<span class="linenos" data-linenos=" 9 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="nf">imprimir</span><span class="p">(){</span>
<span class="linenos" data-linenos="10 "></span>        <span class="k">echo</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">nombre</span><span class="p">;</span>
<span class="linenos" data-linenos="11 "></span>        <span class="k">echo</span> <span class="s1">&#39;&lt;br&gt;&#39;</span><span class="p">;</span>
<span class="linenos" data-linenos="12 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="13 "></span><span class="p">}</span>
<span class="linenos" data-linenos="14 "></span>
<span class="linenos" data-linenos="15 "></span><span class="nv">$bruno </span><span class="o">=</span> <span class="k">new</span> <span class="nx">Persona</span><span class="p">();</span> <span class="c1">// creamos un objeto</span>
<span class="linenos" data-linenos="16 "></span><span class="nv">$bruno</span><span class="o">-&gt;</span><span class="na">setNombre</span><span class="p">(</span><span class="s2">&quot;Bruno Díaz&quot;</span><span class="p">);</span>
<span class="linenos" data-linenos="17 "></span><span class="nv">$bruno</span><span class="o">-&gt;</span><span class="na">imprimir</span><span class="p">();</span>
</code></pre></div>
<p>Encara que es poden declarar diverses classes en el mateix arxiu, és una mala pràctica. Així doncs, cada fitxer contedrá una sola classe, i es nomenarà amb el nom de la classe.</p>
<h2 id="encapsulacio">Encapsulació<a class="headerlink" href="#encapsulacio" title="Permanent link">&para;</a></h2>
<p>Les propietats es defineixen privades o protegides (si volem que les classes heretades puguen accedir).</p>
<p>Per a cada propietat, s'afigen mètodes públics (<em>getter/setter</em>):</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">public setPropiedad(tipo $param)</span>
<span class="linenos" data-linenos="2 "></span><span class="x">public getPropiedad() : tipo</span>
</code></pre></div>
<p>Les constants es defineixen públiques perquè siguen accessibles per tots els recursos.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos=" 2 "></span><span class="k">class</span> <span class="nc">MayorMenor </span><span class="p">{</span>
<span class="linenos" data-linenos=" 3 "></span>    <span class="k">private</span> <span class="nx">int</span> <span class="nv">$mayor</span><span class="p">;</span>
<span class="linenos" data-linenos=" 4 "></span>    <span class="k">private</span> <span class="nx">int</span> <span class="nv">$menor</span><span class="p">;</span>
<span class="linenos" data-linenos=" 5 "></span>
<span class="linenos" data-linenos=" 6 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="nf">setMayor</span><span class="p">(</span><span class="nx">int </span><span class="nv">$may</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-linenos=" 7 "></span>        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">mayor </span><span class="o">=</span> <span class="nv">$may</span><span class="p">;</span>
<span class="linenos" data-linenos=" 8 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos=" 9 "></span>
<span class="linenos" data-linenos="10 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="nf">setMenor</span><span class="p">(</span><span class="nx">int </span><span class="nv">$men</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-linenos="11 "></span>        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">menor </span><span class="o">=</span> <span class="nv">$men</span><span class="p">;</span>
<span class="linenos" data-linenos="12 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="13 "></span>
<span class="linenos" data-linenos="14 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="nf">getMayor</span><span class="p">()</span> <span class="o">:</span> <span class="nx">int </span><span class="p">{</span>
<span class="linenos" data-linenos="15 "></span>        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">mayor</span><span class="p">;</span>
<span class="linenos" data-linenos="16 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="17 "></span>
<span class="linenos" data-linenos="18 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="nf">getMenor</span><span class="p">()</span> <span class="o">:</span> <span class="nx">int </span><span class="p">{</span>
<span class="linenos" data-linenos="19 "></span>        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">menor</span><span class="p">;</span>
<span class="linenos" data-linenos="20 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="21 "></span><span class="p">}</span>
</code></pre></div>
<h3 id="rebent-i-enviant-objectes">Rebent i enviant objectes<a class="headerlink" href="#rebent-i-enviant-objectes" title="Permanent link">&para;</a></h3>
<p>És recomanable indicar-ho en la mena de paràmetres. Si l'objecte pot retornar nuls es posa <code>?</code> davant del nom de la classe.</p>
<div class="admonition important">
<p class="admonition-title">Objectes per referència</p>
<p>Els objectes que s'envien i reben com a paràmetres sempre es passen per referència.</p>
</div>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="cp">&lt;?php</span>
<span class="hll"><span class="linenos" data-linenos=" 2 "></span><span class="k">function</span> <span class="nf">maymen</span><span class="p">(</span><span class="k">array</span> <span class="nv">$numeros</span><span class="p">)</span> <span class="o">:</span> <span class="o">?</span><span class="nx">MayorMenor </span><span class="p">{</span>
</span><span class="linenos" data-linenos=" 3 "></span>    <span class="nv">$a </span><span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nv">$numeros</span><span class="p">);</span>
<span class="linenos" data-linenos=" 4 "></span>    <span class="nv">$b </span><span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nv">$numeros</span><span class="p">);</span>
<span class="linenos" data-linenos=" 5 "></span>
<span class="linenos" data-linenos=" 6 "></span>    <span class="nv">$result </span><span class="o">=</span> <span class="k">new</span> <span class="nx">MayorMenor</span><span class="p">();</span>
<span class="linenos" data-linenos=" 7 "></span>    <span class="nv">$result</span><span class="o">-&gt;</span><span class="na">setMayor</span><span class="p">(</span><span class="nv">$a</span><span class="p">);</span>
<span class="linenos" data-linenos=" 8 "></span>    <span class="nv">$result</span><span class="o">-&gt;</span><span class="na">setMenor</span><span class="p">(</span><span class="nv">$b</span><span class="p">);</span>
<span class="linenos" data-linenos=" 9 "></span>
<span class="linenos" data-linenos="10 "></span>    <span class="k">return</span> <span class="nv">$result</span><span class="p">;</span>
<span class="linenos" data-linenos="11 "></span><span class="p">}</span>
<span class="linenos" data-linenos="12 "></span>
<span class="linenos" data-linenos="13 "></span><span class="nv">$resultado </span><span class="o">=</span>  <span class="nx">maymen</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">76</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">388</span><span class="p">,</span><span class="mi">41</span><span class="p">,</span><span class="mi">39</span><span class="p">,</span><span class="mi">25</span><span class="p">,</span><span class="mi">97</span><span class="p">,</span><span class="mi">22</span><span class="p">]);</span>
<span class="linenos" data-linenos="14 "></span><span class="k">echo</span> <span class="s2">&quot;&lt;br&gt;Mayor: &quot;</span><span class="o">.</span><span class="nv">$resultado</span><span class="o">-&gt;</span><span class="na">getMayor</span><span class="p">();</span>
<span class="linenos" data-linenos="15 "></span><span class="k">echo</span> <span class="s2">&quot;&lt;br&gt;Menor: &quot;</span><span class="o">.</span><span class="nv">$resultado</span><span class="o">-&gt;</span><span class="na">getMenor</span><span class="p">();</span>
</code></pre></div>
<h2 id="constructor">Constructor<a class="headerlink" href="#constructor" title="Permanent link">&para;</a></h2>
<p>El constructor dels objectes es defineix mitjançant el mètode màgic <code>__construct</code>.
Pot o no tindre paràmetres, però només pot haver-hi un únic constructor.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos=" 2 "></span><span class="k">class</span> <span class="nc">Persona </span><span class="p">{</span>
<span class="linenos" data-linenos=" 3 "></span>    <span class="k">private</span> <span class="nx">string</span> <span class="nv">$nombre</span><span class="p">;</span>
<span class="linenos" data-linenos=" 4 "></span>
<span class="hll"><span class="linenos" data-linenos=" 5 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">(</span><span class="nx">string</span> <span class="nv">$nom</span><span class="p">)</span> <span class="p">{</span>
</span><span class="linenos" data-linenos=" 6 "></span>        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">nombre</span> <span class="o">=</span> <span class="nv">$nom</span><span class="p">;</span>
<span class="linenos" data-linenos=" 7 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos=" 8 "></span>
<span class="linenos" data-linenos=" 9 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="nf">imprimir</span><span class="p">(){</span>
<span class="linenos" data-linenos="10 "></span>      <span class="k">echo</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">nombre</span><span class="p">;</span>
<span class="linenos" data-linenos="11 "></span>      <span class="k">echo</span> <span class="s1">&#39;&lt;br&gt;&#39;</span><span class="p">;</span>
<span class="linenos" data-linenos="12 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="13 "></span><span class="p">}</span>
<span class="linenos" data-linenos="14 "></span>
<span class="linenos" data-linenos="15 "></span><span class="nv">$bruno </span><span class="o">=</span> <span class="k">new</span> <span class="nx">Persona</span><span class="p">(</span><span class="s2">&quot;Bruno Díaz&quot;</span><span class="p">);</span>
<span class="linenos" data-linenos="16 "></span><span class="nv">$bruno</span><span class="o">-&gt;</span><span class="na">imprimir</span><span class="p">();</span>
</code></pre></div>
<h3 id="constructors-en-php-8">Constructors en PHP 8<a class="headerlink" href="#constructors-en-php-8" title="Permanent link">&para;</a></h3>
<p>Una de les grans novetats que ofereix PHP 8 és la simplificació dels constructors amb paràmetres, la qual cosa es coneix com a promoció de les propietats del constructor*.</p>
<p>Per a això, en comptes d'haver de declarar les propietats com a privades o protegides, i després dins del constructor haver d'assignar els paràmetres a estàs propietats, el propi constructor promociona les propietats.</p>
<p>Vegem-ho millor amb un exemple. Imaginem una classe <code>Punt</code> on vulguem emmagatzemar les seues coordenades:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos=" 2 "></span><span class="k">class</span> <span class="nc">Punto</span> <span class="p">{</span>
<span class="linenos" data-linenos=" 3 "></span>    <span class="k">protected</span> <span class="nx">float</span> <span class="nv">$x</span><span class="p">;</span>
<span class="linenos" data-linenos=" 4 "></span>    <span class="k">protected</span> <span class="nx">float</span> <span class="nv">$y</span><span class="p">;</span>
<span class="linenos" data-linenos=" 5 "></span>    <span class="k">protected</span> <span class="nx">float</span> <span class="nv">$z</span><span class="p">;</span>
<span class="linenos" data-linenos=" 6 "></span>
<span class="linenos" data-linenos=" 7 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">(</span>
<span class="linenos" data-linenos=" 8 "></span>        <span class="nx">float</span> <span class="nv">$x</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
<span class="linenos" data-linenos=" 9 "></span>        <span class="nx">float</span> <span class="nv">$y</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
<span class="linenos" data-linenos="10 "></span>        <span class="nx">float</span> <span class="nv">$z</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="linenos" data-linenos="11 "></span>    <span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-linenos="12 "></span>        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">x</span> <span class="o">=</span> <span class="nv">$x</span><span class="p">;</span>
<span class="linenos" data-linenos="13 "></span>        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">y</span> <span class="o">=</span> <span class="nv">$y</span><span class="p">;</span>
<span class="linenos" data-linenos="14 "></span>        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">z</span> <span class="o">=</span> <span class="nv">$z</span><span class="p">;</span>
<span class="linenos" data-linenos="15 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="16 "></span><span class="p">}</span>
</code></pre></div>
<p>En PHP 8, quedaria de la següent manera (molt més curt, la qual cosa facilita la seua llegibilitat):</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos="2 "></span><span class="k">class</span> <span class="nc">Punto</span> <span class="p">{</span>
<span class="linenos" data-linenos="3 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">(</span>
<span class="linenos" data-linenos="4 "></span>        <span class="k">protected</span> <span class="nx">float</span> <span class="nv">$x</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
<span class="linenos" data-linenos="5 "></span>        <span class="k">protected</span> <span class="nx">float</span> <span class="nv">$y</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
<span class="linenos" data-linenos="6 "></span>        <span class="k">protected</span> <span class="nx">float</span> <span class="nv">$z</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
<span class="linenos" data-linenos="7 "></span>    <span class="p">)</span> <span class="p">{}</span>
<span class="linenos" data-linenos="8 "></span><span class="p">}</span>
</code></pre></div>
<div class="admonition info">
<p class="admonition-title">L'ordre importa</p>
<p>A l'hora de codificar l'ordre dels elements ha de ser:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos=" 2 "></span><span class="k">declare</span><span class="p">(</span><span class="nx">strict_types</span><span class="o">=</span><span class="mi">1</span><span class="p">);</span>
<span class="linenos" data-linenos=" 3 "></span>
<span class="linenos" data-linenos=" 4 "></span><span class="k">class</span> <span class="nc">NombreClase</span> <span class="p">{</span>
<span class="linenos" data-linenos=" 5 "></span>    <span class="c1">// propiedades</span>
<span class="linenos" data-linenos=" 6 "></span>
<span class="linenos" data-linenos=" 7 "></span>    <span class="c1">// constructor</span>
<span class="linenos" data-linenos=" 8 "></span>
<span class="linenos" data-linenos=" 9 "></span>    <span class="c1">// getters - setters</span>
<span class="linenos" data-linenos="10 "></span>
<span class="linenos" data-linenos="11 "></span>    <span class="c1">// resto de métodos</span>
<span class="linenos" data-linenos="12 "></span><span class="p">}</span>
<span class="linenos" data-linenos="13 "></span><span class="cp">?&gt;</span><span class="x"></span>
</code></pre></div>
</div>
<h2 id="classes-estatiques">Classes estàtiques<a class="headerlink" href="#classes-estatiques" title="Permanent link">&para;</a></h2>
<p>Són aquelles que tenen propietats i/o mètodes estàtics (també es coneixen com <em>de classe</em>, perquè el seu valor es comparteix entre totes les instàncies de la mateixa classe).</p>
<p>Es declaren amb <code>static</code> i es referencien amb <code>::</code>.</p>
<ul>
<li>Si volem accedir a un mètode estàtic, s'anteposa el nom de la classe: <code>Producte::nuevoProducto()</code>.</li>
<li>Si des d'un mètode volem accedir a una propietat estàtica de la mateixa classe, s'utilitza la referència <code>self</code>: <code>self::$numProductos</code></li>
</ul>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos=" 2 "></span><span class="k">class</span> <span class="nc">Producto</span> <span class="p">{</span>
<span class="linenos" data-linenos=" 3 "></span>    <span class="k">const</span> <span class="no">IVA</span> <span class="o">=</span> <span class="mf">0.23</span><span class="p">;</span>
<span class="linenos" data-linenos=" 4 "></span>    <span class="k">private</span> <span class="k">static</span> <span class="nv">$numProductos</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> 
<span class="linenos" data-linenos=" 5 "></span>
<span class="linenos" data-linenos=" 6 "></span>    <span class="k">public</span> <span class="k">static</span> <span class="k">function</span> <span class="nf">nuevoProducto</span><span class="p">()</span> <span class="p">{</span>
<span class="linenos" data-linenos=" 7 "></span>        <span class="nx">self</span><span class="o">::</span><span class="nv">$numProductos</span><span class="o">++</span><span class="p">;</span>
<span class="linenos" data-linenos=" 8 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos=" 9 "></span><span class="p">}</span>
<span class="linenos" data-linenos="10 "></span>
<span class="linenos" data-linenos="11 "></span><span class="nx">Producto</span><span class="o">::</span><span class="na">nuevoProducto</span><span class="p">();</span>
<span class="linenos" data-linenos="12 "></span><span class="nv">$impuesto</span> <span class="o">=</span> <span class="nx">Producto</span><span class="o">::</span><span class="na">IVA</span><span class="p">;</span>
</code></pre></div>
<h2 id="classes-estatiques_1">Classes estàtiques<a class="headerlink" href="#classes-estatiques_1" title="Permanent link">&para;</a></h2>
<p>També podem tindre classes normals que tinguen alguna propietat estàtica:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos=" 2 "></span><span class="k">class</span> <span class="nc">Producto </span><span class="p">{</span>
<span class="linenos" data-linenos=" 3 "></span>    <span class="k">const</span> <span class="no">IVA </span><span class="o">=</span> <span class="mf">0.23</span><span class="p">;</span>
<span class="linenos" data-linenos=" 4 "></span>    <span class="k">private</span> <span class="k">static</span> <span class="nv">$numProductos </span><span class="o">=</span> <span class="mi">0</span><span class="p">;</span> 
<span class="linenos" data-linenos=" 5 "></span>    <span class="k">private</span> <span class="nv">$codigo</span><span class="p">;</span>
<span class="linenos" data-linenos=" 6 "></span>
<span class="linenos" data-linenos=" 7 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">(</span><span class="nx">string </span><span class="nv">$cod</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-linenos=" 8 "></span>        <span class="nx">self</span><span class="o">::</span><span class="nv">$numProductos</span><span class="o">++</span><span class="p">;</span>
<span class="linenos" data-linenos=" 9 "></span>        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">codigo </span><span class="o">=</span> <span class="nv">$cod</span><span class="p">;</span>
<span class="linenos" data-linenos="10 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="11 "></span>
<span class="linenos" data-linenos="12 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="nf">mostrarResumen</span><span class="p">()</span> <span class="o">:</span> <span class="nx">string </span><span class="p">{</span>
<span class="linenos" data-linenos="13 "></span>        <span class="k">return</span> <span class="s2">&quot;El producto &quot;</span><span class="o">.</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">codigo</span><span class="o">.</span><span class="s2">&quot; es el número &quot;</span><span class="o">.</span><span class="nx">self</span><span class="o">::</span><span class="nv">$numProductos</span><span class="p">;</span>
<span class="linenos" data-linenos="14 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="15 "></span><span class="p">}</span>
<span class="linenos" data-linenos="16 "></span>
<span class="linenos" data-linenos="17 "></span><span class="nv">$prod1 </span><span class="o">=</span> <span class="k">new</span> <span class="nx">Producto</span><span class="p">(</span><span class="s2">&quot;PS5&quot;</span><span class="p">);</span>
<span class="linenos" data-linenos="18 "></span><span class="nv">$prod2 </span><span class="o">=</span> <span class="k">new</span> <span class="nx">Producto</span><span class="p">(</span><span class="s2">&quot;XBOX Series X&quot;</span><span class="p">);</span>
<span class="linenos" data-linenos="19 "></span><span class="nv">$prod3 </span><span class="o">=</span> <span class="k">new</span> <span class="nx">Producto</span><span class="p">(</span><span class="s2">&quot;Nintendo Switch&quot;</span><span class="p">);</span>
<span class="linenos" data-linenos="20 "></span><span class="k">echo</span> <span class="nv">$prod3</span><span class="o">-&gt;</span><span class="na">mostrarResumen</span><span class="p">();</span>
</code></pre></div>
<h2 id="introspeccio">Introspecció<a class="headerlink" href="#introspeccio" title="Permanent link">&para;</a></h2>
<p>En treballar amb classes i objectes, existeixen un conjunt de funcions ja definides pel llenguatge que permeten obtindre informació sobre els objectes:</p>
<ul>
<li><code>instanceof</code>: permet comprovar si un objecte és d'una determinada classe</li>
<li><code>get_class</code>: retorna el nom de la classe</li>
<li><code>get_declared_class</code>: retorna un array amb els noms de les classes definides</li>
<li><code>class_àlies</code>: crea un àlies</li>
<li><code>class_exists</code> / <code>method_exists</code> / <code>property_exists</code>: <code>true</code> si la classe / mètode / propietat està definida</li>
<li><code>get_class_methods</code> / <code>get_class_vars</code> / <code>get_object_vars</code>: Retorna un array amb els noms dels mètodes / propietats d'una classe / propietats d'un objecte que són accessibles des d'on es fa la crida.</li>
</ul>
<p>Un exemple d'aquestes funcions pot ser el següent:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos=" 2 "></span><span class="nv">$p </span><span class="o">=</span> <span class="k">new</span> <span class="nx">Producto</span><span class="p">(</span><span class="s2">&quot;PS5&quot;</span><span class="p">);</span>
<span class="linenos" data-linenos=" 3 "></span><span class="k">if</span> <span class="p">(</span><span class="nv">$p instanceof Producto</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-linenos=" 4 "></span>    <span class="k">echo</span> <span class="s2">&quot;Es un producto&quot;</span><span class="p">;</span>
<span class="linenos" data-linenos=" 5 "></span>    <span class="k">echo</span> <span class="s2">&quot;La clase es &quot;</span><span class="o">.</span><span class="nb">get_class</span><span class="p">(</span><span class="nv">$p</span><span class="p">);</span>
<span class="linenos" data-linenos=" 6 "></span>
<span class="linenos" data-linenos=" 7 "></span>    <span class="nb">class_alias</span><span class="p">(</span><span class="s2">&quot;Producto&quot;</span><span class="p">,</span> <span class="s2">&quot;Articulo&quot;</span><span class="p">);</span>
<span class="linenos" data-linenos=" 8 "></span>    <span class="nv">$c </span><span class="o">=</span> <span class="k">new</span> <span class="nx">Articulo</span><span class="p">(</span><span class="s2">&quot;Nintendo Switch&quot;</span><span class="p">);</span>
<span class="linenos" data-linenos=" 9 "></span>    <span class="k">echo</span> <span class="s2">&quot;Un articulo es un &quot;</span><span class="o">.</span><span class="nb">get_class</span><span class="p">(</span><span class="nv">$c</span><span class="p">);</span>
<span class="linenos" data-linenos="10 "></span>
<span class="linenos" data-linenos="11 "></span>    <span class="nb">print_r</span><span class="p">(</span><span class="nb">get_class_methods</span><span class="p">(</span><span class="s2">&quot;Producto&quot;</span><span class="p">));</span>
<span class="linenos" data-linenos="12 "></span>    <span class="nb">print_r</span><span class="p">(</span><span class="nb">get_class_vars</span><span class="p">(</span><span class="s2">&quot;Producto&quot;</span><span class="p">));</span>
<span class="linenos" data-linenos="13 "></span>    <span class="nb">print_r</span><span class="p">(</span><span class="nb">get_object_vars</span><span class="p">(</span><span class="nv">$p</span><span class="p">));</span>
<span class="linenos" data-linenos="14 "></span>
<span class="linenos" data-linenos="15 "></span>    <span class="k">if</span> <span class="p">(</span><span class="nb">method_exists</span><span class="p">(</span><span class="nv">$p</span><span class="p">,</span> <span class="s2">&quot;mostrarResumen&quot;</span><span class="p">))</span> <span class="p">{</span>
<span class="linenos" data-linenos="16 "></span>        <span class="nv">$p</span><span class="o">-&gt;</span><span class="na">mostrarResumen</span><span class="p">();</span>
<span class="linenos" data-linenos="17 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="18 "></span><span class="p">}</span>
</code></pre></div>
<div class="admonition caution">
<p class="admonition-title">Clonat</p>
<p>En assignar dos objectes no es copien, es crea una nova referència. Si volem una còpia, cal clonar-ho mitjançant el mètode <code>clone(object) : object</code></p>
<p>Si volem modificar el clonat per defecte, cal definir el mètode màgic <code>__clone()</code> que es dirà després de copiar totes les propietats.</p>
<p>Més informació en <a href="https://www.php.net/manual/es/language.oop5.cloning.php">https://www.php.net/manual/es/language.oop5.cloning.php</a></p>
</div>
<h2 id="herencia">Herència<a class="headerlink" href="#herencia" title="Permanent link">&para;</a></h2>
<p>PHP suporta herència simple, de manera que una classe només pot heretar d'una altra, no de dues classes alhora. Per a això s'utilitza la paraula clau <code>extends</code>. Si volem que la classe A hereta de la classe B farem:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">class A extends B</span>
</code></pre></div>
<p>El fill hereta els atributs i mètodes públics i protegits.</p>
<div class="admonition warning">
<p class="admonition-title">Cada classe en un arxiu</p>
</div>
<p>Com ja hem comentat, hauríem de col·locar cada classe en un arxiu diferent per a posteriorment utilitzar-lo mitjançant <code>include</code>. En els següent exemple els hem col·locats junt per a facilitar la seua llegibilitat.</p>
<p>Per exemple, tenim una classe <code>Producte</code> i una <code>Tv</code> que hereta de <code>Producte</code>:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos=" 2 "></span><span class="k">class</span> <span class="nc">Producto</span> <span class="p">{</span>
<span class="linenos" data-linenos=" 3 "></span>    <span class="k">public</span> <span class="nv">$codigo</span><span class="p">;</span>
<span class="linenos" data-linenos=" 4 "></span>    <span class="k">public</span> <span class="nv">$nombre</span><span class="p">;</span>
<span class="linenos" data-linenos=" 5 "></span>    <span class="k">public</span> <span class="nv">$nombreCorto</span><span class="p">;</span>
<span class="linenos" data-linenos=" 6 "></span>    <span class="k">public</span> <span class="nv">$PVP</span><span class="p">;</span>
<span class="linenos" data-linenos=" 7 "></span>
<span class="linenos" data-linenos=" 8 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="nf">mostrarResumen</span><span class="p">()</span> <span class="p">{</span>
<span class="linenos" data-linenos=" 9 "></span>        <span class="k">echo</span> <span class="s2">&quot;&lt;p&gt;Prod:&quot;</span><span class="o">.</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">codigo</span><span class="o">.</span><span class="s2">&quot;&lt;/p&gt;&quot;</span><span class="p">;</span>
<span class="linenos" data-linenos="10 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="11 "></span><span class="p">}</span>
<span class="linenos" data-linenos="12 "></span>
<span class="linenos" data-linenos="13 "></span><span class="k">class</span> <span class="nc">Tv</span> <span class="k">extends</span> <span class="nx">Producto</span> <span class="p">{</span>
<span class="linenos" data-linenos="14 "></span>    <span class="k">public</span> <span class="nv">$pulgadas</span><span class="p">;</span>
<span class="linenos" data-linenos="15 "></span>    <span class="k">public</span> <span class="nv">$tecnologia</span><span class="p">;</span>
<span class="linenos" data-linenos="16 "></span><span class="p">}</span>
</code></pre></div>
<p>Podemos utilizar las siguientes funciones para averiguar si hay relación entre dos clases:</p>
<ul>
<li><code>get_parent_class(object): string</code></li>
<li><code>is_subclass_of(object, string): bool</code></li>
</ul>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos=" 2 "></span><span class="nv">$t</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Tv</span><span class="p">();</span>
<span class="linenos" data-linenos=" 3 "></span><span class="nv">$t</span><span class="o">-&gt;</span><span class="na">codigo</span> <span class="o">=</span> <span class="mi">33</span><span class="p">;</span>
<span class="linenos" data-linenos=" 4 "></span><span class="k">if</span> <span class="p">(</span><span class="nv">$t</span> <span class="nx">instanceof</span> <span class="nx">Producto</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-linenos=" 5 "></span>    <span class="k">echo</span> <span class="nv">$t</span><span class="o">-&gt;</span><span class="na">mostrarResumen</span><span class="p">();</span>
<span class="linenos" data-linenos=" 6 "></span><span class="p">}</span>
<span class="linenos" data-linenos=" 7 "></span>
<span class="linenos" data-linenos=" 8 "></span><span class="nv">$padre</span> <span class="o">=</span> <span class="nb">get_parent_class</span><span class="p">(</span><span class="nv">$t</span><span class="p">);</span>
<span class="linenos" data-linenos=" 9 "></span><span class="k">echo</span> <span class="s2">&quot;&lt;br&gt;La clase padre es: &quot;</span> <span class="o">.</span> <span class="nv">$padre</span><span class="p">;</span>
<span class="linenos" data-linenos="10 "></span><span class="nv">$objetoPadre</span> <span class="o">=</span> <span class="k">new</span> <span class="nv">$padre</span><span class="p">;</span>
<span class="linenos" data-linenos="11 "></span><span class="k">echo</span> <span class="nv">$objetoPadre</span><span class="o">-&gt;</span><span class="na">mostrarResumen</span><span class="p">();</span>
<span class="linenos" data-linenos="12 "></span>
<span class="linenos" data-linenos="13 "></span><span class="k">if</span> <span class="p">(</span><span class="nb">is_subclass_of</span><span class="p">(</span><span class="nv">$t</span><span class="p">,</span> <span class="s1">&#39;Producto&#39;</span><span class="p">))</span> <span class="p">{</span>
<span class="linenos" data-linenos="14 "></span>    <span class="k">echo</span> <span class="s2">&quot;&lt;br&gt;Soy un hijo de Producto&quot;</span><span class="p">;</span>
<span class="linenos" data-linenos="15 "></span><span class="p">}</span>
</code></pre></div>
<h3 id="sobreescriure-metodes">Sobreescriure mètodes<a class="headerlink" href="#sobreescriure-metodes" title="Permanent link">&para;</a></h3>
<p>Podem crear mètodes en els fills amb el mateix nom que el pare, canviant el seu comportament.
Per a invocar als mètodes del pare -&gt; <code>parent::nombreMetodo()</code></p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos=" 2 "></span><span class="k">class</span> <span class="nc">Tv</span> <span class="k">extends</span> <span class="nx">Producto</span> <span class="p">{</span>
<span class="linenos" data-linenos=" 3 "></span>   <span class="k">public</span> <span class="nv">$pulgadas</span><span class="p">;</span>
<span class="linenos" data-linenos=" 4 "></span>   <span class="k">public</span> <span class="nv">$tecnologia</span><span class="p">;</span>
<span class="linenos" data-linenos=" 5 "></span>
<span class="linenos" data-linenos=" 6 "></span>   <span class="k">public</span> <span class="k">function</span> <span class="nf">mostrarResumen</span><span class="p">()</span> <span class="p">{</span>
<span class="linenos" data-linenos=" 7 "></span>      <span class="k">parent</span><span class="o">::</span><span class="na">mostrarResumen</span><span class="p">();</span>
<span class="linenos" data-linenos=" 8 "></span>      <span class="k">echo</span> <span class="s2">&quot;&lt;p&gt;TV &quot;</span><span class="o">.</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">tecnologia</span><span class="o">.</span><span class="s2">&quot; de &quot;</span><span class="o">.</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">pulgadas</span><span class="o">.</span><span class="s2">&quot;&lt;/p&gt;&quot;</span><span class="p">;</span>
<span class="linenos" data-linenos=" 9 "></span>   <span class="p">}</span>
<span class="linenos" data-linenos="10 "></span><span class="p">}</span>
</code></pre></div>
<h3 id="constructor-en-fills">Constructor en fills<a class="headerlink" href="#constructor-en-fills" title="Permanent link">&para;</a></h3>
<p>En els fills no es crea cap constructor de manera automàtica. Pel que si no n'hi ha, s'invoca automàticament al del pare. En canvi, si el definim en el fill, hem d'invocar al del pare de manera explícita.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1">PHP7</label><label for="__tabbed_1_2">PHP8</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos=" 2 "></span><span class="k">class</span> <span class="nc">Producto</span> <span class="p">{</span>
<span class="linenos" data-linenos=" 3 "></span>    <span class="k">public</span> <span class="nx">string</span> <span class="nv">$codigo</span><span class="p">;</span>
<span class="linenos" data-linenos=" 4 "></span>
<span class="linenos" data-linenos=" 5 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">(</span><span class="nx">string</span> <span class="nv">$codigo</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-linenos=" 6 "></span>        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">codigo</span> <span class="o">=</span> <span class="nv">$codigo</span><span class="p">;</span>
<span class="linenos" data-linenos=" 7 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos=" 8 "></span>
<span class="linenos" data-linenos=" 9 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="nf">mostrarResumen</span><span class="p">()</span> <span class="p">{</span>
<span class="linenos" data-linenos="10 "></span>        <span class="k">echo</span> <span class="s2">&quot;&lt;p&gt;Prod:&quot;</span><span class="o">.</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">codigo</span><span class="o">.</span><span class="s2">&quot;&lt;/p&gt;&quot;</span><span class="p">;</span>
<span class="linenos" data-linenos="11 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="12 "></span><span class="p">}</span>
<span class="linenos" data-linenos="13 "></span>
<span class="linenos" data-linenos="14 "></span><span class="k">class</span> <span class="nc">Tv</span> <span class="k">extends</span> <span class="nx">Producto</span> <span class="p">{</span>
<span class="linenos" data-linenos="15 "></span>    <span class="k">public</span> <span class="nv">$pulgadas</span><span class="p">;</span>
<span class="linenos" data-linenos="16 "></span>    <span class="k">public</span> <span class="nv">$tecnologia</span><span class="p">;</span>
<span class="linenos" data-linenos="17 "></span>
<span class="linenos" data-linenos="18 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">(</span><span class="nx">string </span><span class="nv">$codigo</span><span class="p">,</span> <span class="nx">int </span><span class="nv">$pulgadas</span><span class="p">,</span> <span class="nx">string </span><span class="nv">$tecnologia</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-linenos="19 "></span>        <span class="k">parent</span><span class="o">::</span><span class="na">__construct</span><span class="p">(</span><span class="nv">$codigo</span><span class="p">);</span>
<span class="linenos" data-linenos="20 "></span>        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">pulgadas </span><span class="o">=</span> <span class="nv">$pulgadas</span><span class="p">;</span>
<span class="linenos" data-linenos="21 "></span>        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">tecnologia </span><span class="o">=</span> <span class="nv">$tecnologia</span><span class="p">;</span>
<span class="linenos" data-linenos="22 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="23 "></span>
<span class="linenos" data-linenos="24 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="nf">mostrarResumen</span><span class="p">()</span> <span class="p">{</span>
<span class="linenos" data-linenos="25 "></span>        <span class="k">parent</span><span class="o">::</span><span class="na">mostrarResumen</span><span class="p">();</span>
<span class="linenos" data-linenos="26 "></span>        <span class="k">echo</span> <span class="s2">&quot;&lt;p&gt;TV &quot;</span><span class="o">.</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">tecnologia</span><span class="o">.</span><span class="s2">&quot; de &quot;</span><span class="o">.</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">pulgadas</span><span class="o">.</span><span class="s2">&quot;&lt;/p&gt;&quot;</span><span class="p">;</span>
<span class="linenos" data-linenos="27 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="28 "></span><span class="p">}</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos=" 2 "></span><span class="k">class</span> <span class="nc">Producto</span> <span class="p">{</span>
<span class="linenos" data-linenos=" 3 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">(</span><span class="k">private</span> <span class="nx">string</span> <span class="nv">$codigo</span><span class="p">)</span> <span class="p">{</span> <span class="p">}</span>
<span class="linenos" data-linenos=" 4 "></span>
<span class="linenos" data-linenos=" 5 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="nf">mostrarResumen</span><span class="p">()</span> <span class="p">{</span>
<span class="linenos" data-linenos=" 6 "></span>        <span class="k">echo</span> <span class="s2">&quot;&lt;p&gt;Prod:&quot;</span><span class="o">.</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">codigo</span><span class="o">.</span><span class="s2">&quot;&lt;/p&gt;&quot;</span><span class="p">;</span>
<span class="linenos" data-linenos=" 7 "></span>    <span class="p">}</span>        
<span class="linenos" data-linenos=" 8 "></span><span class="p">}</span>
<span class="linenos" data-linenos=" 9 "></span>
<span class="linenos" data-linenos="10 "></span><span class="k">class</span> <span class="nc">Tv</span> <span class="k">extends</span> <span class="nx">Producto</span> <span class="p">{</span>
<span class="linenos" data-linenos="11 "></span>
<span class="linenos" data-linenos="12 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">(</span>
<span class="linenos" data-linenos="13 "></span>        <span class="nx">string </span><span class="nv">$codigo</span><span class="p">,</span>
<span class="linenos" data-linenos="14 "></span>        <span class="k">private</span> <span class="nx">int </span><span class="nv">$pulgadas</span><span class="p">,</span>
<span class="linenos" data-linenos="15 "></span>        <span class="k">private</span> <span class="nx">string </span><span class="nv">$tecnologia</span><span class="p">)</span>
<span class="linenos" data-linenos="16 "></span>    <span class="p">{</span>
<span class="linenos" data-linenos="17 "></span>        <span class="k">parent</span><span class="o">::</span><span class="na">__construct</span><span class="p">(</span><span class="nv">$codigo</span><span class="p">);</span>
<span class="linenos" data-linenos="18 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="19 "></span>
<span class="linenos" data-linenos="20 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="nf">mostrarResumen</span><span class="p">()</span> <span class="p">{</span>
<span class="linenos" data-linenos="21 "></span>        <span class="k">parent</span><span class="o">::</span><span class="na">mostrarResumen</span><span class="p">();</span>
<span class="linenos" data-linenos="22 "></span>        <span class="k">echo</span> <span class="s2">&quot;&lt;p&gt;TV &quot;</span><span class="o">.</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">tecnologia</span><span class="o">.</span><span class="s2">&quot; de &quot;</span><span class="o">.</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">pulgadas</span><span class="o">.</span><span class="s2">&quot;&lt;/p&gt;&quot;</span><span class="p">;</span>
<span class="linenos" data-linenos="23 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="24 "></span><span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="classes-abstractes">Classes abstractes<a class="headerlink" href="#classes-abstractes" title="Permanent link">&para;</a></h2>
<p>Les classes abstractes obliguen a heretar d'una classe, ja que no es permet la seua instanciación. Es defineix mitjançant <code>abstract class NombreClase {</code>.
Una classe abstracta pot contindre propietats i mètodes no-abstractes, i/o mètodes abstractes.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos=" 2 "></span><span class="c1">// Clase abstracta</span>
<span class="linenos" data-linenos=" 3 "></span><span class="k">abstract</span> <span class="k">class</span> <span class="nc">Producto </span><span class="p">{</span>
<span class="linenos" data-linenos=" 4 "></span>    <span class="k">private</span> <span class="nv">$codigo</span><span class="p">;</span>
<span class="linenos" data-linenos=" 5 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="nf">getCodigo</span><span class="p">()</span> <span class="o">:</span> <span class="nx">string </span><span class="p">{</span>
<span class="linenos" data-linenos=" 6 "></span>        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">codigo</span><span class="p">;</span>
<span class="linenos" data-linenos=" 7 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos=" 8 "></span>    <span class="c1">// Método abstracto</span>
<span class="linenos" data-linenos=" 9 "></span>    <span class="k">abstract</span> <span class="k">public</span> <span class="k">function</span> <span class="nf">mostrarResumen</span><span class="p">();</span>
<span class="linenos" data-linenos="10 "></span><span class="p">}</span>
</code></pre></div>
<p>Quan una classe hereta d'una classe abstracta, obligatòriament ha d'implementar els mètodes que té el pare marcats com a abstractes.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos=" 2 "></span><span class="k">class</span> <span class="nc">Tv</span> <span class="k">extends</span> <span class="nx">Producto</span> <span class="p">{</span>
<span class="linenos" data-linenos=" 3 "></span>    <span class="k">public</span> <span class="nv">$pulgadas</span><span class="p">;</span>
<span class="linenos" data-linenos=" 4 "></span>    <span class="k">public</span> <span class="nv">$tecnologia</span><span class="p">;</span>
<span class="linenos" data-linenos=" 5 "></span>
<span class="linenos" data-linenos=" 6 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="nf">mostrarResumen</span><span class="p">()</span> <span class="p">{</span> <span class="c1">//obligado a implementarlo</span>
<span class="linenos" data-linenos=" 7 "></span>        <span class="k">echo</span> <span class="s2">&quot;&lt;p&gt;Código &quot;</span><span class="o">.</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">getCodigo</span><span class="p">()</span><span class="o">.</span><span class="s2">&quot;&lt;/p&gt;&quot;</span><span class="p">;</span>
<span class="linenos" data-linenos=" 8 "></span>        <span class="k">echo</span> <span class="s2">&quot;&lt;p&gt;TV &quot;</span><span class="o">.</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">tecnologia</span><span class="o">.</span><span class="s2">&quot; de &quot;</span><span class="o">.</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">pulgadas</span><span class="o">.</span><span class="s2">&quot;&lt;/p&gt;&quot;</span><span class="p">;</span>
<span class="linenos" data-linenos=" 9 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="10 "></span><span class="p">}</span>
<span class="linenos" data-linenos="11 "></span>
<span class="linenos" data-linenos="12 "></span><span class="nv">$t</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Tv</span><span class="p">();</span>
<span class="linenos" data-linenos="13 "></span><span class="k">echo</span> <span class="nv">$t</span><span class="o">-&gt;</span><span class="na">getCodigo</span><span class="p">();</span>
</code></pre></div>
<h2 id="classes-finals">Classes finals<a class="headerlink" href="#classes-finals" title="Permanent link">&para;</a></h2>
<p>Són classes oposades a abstractes, ja que eviten que es puga heretar una classe o mètode per a sobreescriure-ho.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos=" 2 "></span><span class="k">class</span> <span class="nc">Producto </span><span class="p">{</span>
<span class="linenos" data-linenos=" 3 "></span>    <span class="k">private</span> <span class="nv">$codigo</span><span class="p">;</span>
<span class="linenos" data-linenos=" 4 "></span>
<span class="linenos" data-linenos=" 5 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="nf">getCodigo</span><span class="p">()</span> <span class="o">:</span> <span class="nx">string </span><span class="p">{</span>
<span class="linenos" data-linenos=" 6 "></span>        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">codigo</span><span class="p">;</span>
<span class="linenos" data-linenos=" 7 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos=" 8 "></span>
<span class="linenos" data-linenos=" 9 "></span>    <span class="k">final</span> <span class="k">public</span> <span class="k">function</span> <span class="nf">mostrarResumen</span><span class="p">()</span> <span class="o">:</span> <span class="nx">string </span><span class="p">{</span>
<span class="linenos" data-linenos="10 "></span>        <span class="k">return</span> <span class="s2">&quot;Producto &quot;</span><span class="o">.</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">codigo</span><span class="p">;</span>
<span class="linenos" data-linenos="11 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="12 "></span><span class="p">}</span>
<span class="linenos" data-linenos="13 "></span>
<span class="linenos" data-linenos="14 "></span><span class="c1">// No podremos heredar de Microondas</span>
<span class="linenos" data-linenos="15 "></span><span class="k">final</span> <span class="k">class</span> <span class="nc">Microondas extends Producto </span><span class="p">{</span>
<span class="linenos" data-linenos="16 "></span>    <span class="k">private</span> <span class="nv">$potencia</span><span class="p">;</span>
<span class="linenos" data-linenos="17 "></span>
<span class="linenos" data-linenos="18 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="nf">getPotencia</span><span class="p">()</span> <span class="o">:</span> <span class="nx">int </span><span class="p">{</span>
<span class="linenos" data-linenos="19 "></span>        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">potencia</span><span class="p">;</span>
<span class="linenos" data-linenos="20 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="21 "></span>
<span class="linenos" data-linenos="22 "></span>    <span class="c1">// No podemos implementar mostrarResumen()</span>
<span class="linenos" data-linenos="23 "></span><span class="p">}</span>
</code></pre></div>
<h2 id="interficies">Interfícies<a class="headerlink" href="#interficies" title="Permanent link">&para;</a></h2>
<p>Permet definir un contracte amb les signatures dels mètodes a complir. Així doncs, només conté declaracions de funcions i totes han de ser públiques.</p>
<p>Es declaren amb la paraula clau <code>interface</code> i després les classes que complisquen el contracte el realitzen mitjançant la paraula clau <code>implements</code>.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos="2 "></span><span class="k">interface</span> <span class="nx">Nombreable</span> <span class="p">{</span>
<span class="linenos" data-linenos="3 "></span><span class="c1">// declaración de funciones</span>
<span class="linenos" data-linenos="4 "></span><span class="p">}</span>
<span class="linenos" data-linenos="5 "></span><span class="k">class</span> <span class="nc">NombreClase</span> <span class="k">implements</span> <span class="nx">NombreInterfaz</span> <span class="p">{</span>
<span class="linenos" data-linenos="6 "></span><span class="c1">// código de la clase</span>
</code></pre></div>
<p>Se permite la herencia de interfaces. Además, una clase puede implementar varios interfaces (en este caso, sí soporta la herecia múltiple, pero sólo de interfaces).</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos=" 2 "></span><span class="k">interface</span> <span class="nx">Mostrable </span><span class="p">{</span>
<span class="linenos" data-linenos=" 3 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="nf">mostrarResumen</span><span class="p">()</span> <span class="o">:</span> <span class="nx">string</span><span class="p">;</span>
<span class="linenos" data-linenos=" 4 "></span><span class="p">}</span>
<span class="linenos" data-linenos=" 5 "></span>
<span class="linenos" data-linenos=" 6 "></span><span class="k">interface</span> <span class="nx">MostrableTodo extends Mostrable </span><span class="p">{</span>
<span class="linenos" data-linenos=" 7 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="nf">mostrarTodo</span><span class="p">()</span> <span class="o">:</span> <span class="nx">string</span><span class="p">;</span>
<span class="linenos" data-linenos=" 8 "></span><span class="p">}</span>
<span class="linenos" data-linenos=" 9 "></span>
<span class="linenos" data-linenos="10 "></span><span class="k">interface</span> <span class="nx">Facturable </span><span class="p">{</span>
<span class="linenos" data-linenos="11 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="nf">generarFactura</span><span class="p">()</span> <span class="o">:</span> <span class="nx">string</span><span class="p">;</span>
<span class="linenos" data-linenos="12 "></span><span class="p">}</span>
<span class="linenos" data-linenos="13 "></span>
<span class="linenos" data-linenos="14 "></span><span class="k">class</span> <span class="nc">Producto implements MostrableTodo</span><span class="p">,</span> <span class="nx">Facturable </span><span class="p">{</span>
<span class="linenos" data-linenos="15 "></span>    <span class="c1">// Implementaciones de los métodos</span>
<span class="linenos" data-linenos="16 "></span>    <span class="c1">// Obligatoriamente deberá implementar public function mostrarResumen, mostrarTodo y generarFactura</span>
<span class="linenos" data-linenos="17 "></span><span class="p">}</span>
</code></pre></div>
<h2 id="metodes-encadenats">Mètodes encadenats<a class="headerlink" href="#metodes-encadenats" title="Permanent link">&para;</a></h2>
<p>Segueix el plantejament de la programació funcional, i també es coneix com <em>method chaining</em>. Planteja que sobre un objecte es realitzen diverses crides.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos=" 2 "></span><span class="nv">$p1 </span><span class="o">=</span> <span class="k">new</span> <span class="nx">Libro</span><span class="p">();</span>
<span class="linenos" data-linenos=" 3 "></span><span class="nv">$p1</span><span class="o">-&gt;</span><span class="na">setNombre</span><span class="p">(</span><span class="s2">&quot;Harry Potter&quot;</span><span class="p">);</span>
<span class="linenos" data-linenos=" 4 "></span><span class="nv">$p1</span><span class="o">-&gt;</span><span class="na">setAutor</span><span class="p">(</span><span class="s2">&quot;JK Rowling&quot;</span><span class="p">);</span>
<span class="linenos" data-linenos=" 5 "></span><span class="k">echo</span> <span class="nv">$p1</span><span class="p">;</span>
<span class="linenos" data-linenos=" 6 "></span>
<span class="linenos" data-linenos=" 7 "></span><span class="c1">// Method chaining</span>
<span class="linenos" data-linenos=" 8 "></span><span class="nv">$p2 </span><span class="o">=</span> <span class="k">new</span> <span class="nx">Libro</span><span class="p">();</span>
<span class="linenos" data-linenos=" 9 "></span><span class="nv">$p2</span><span class="o">-&gt;</span><span class="na">setNombre</span><span class="p">(</span><span class="s2">&quot;Patria&quot;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">setAutor</span><span class="p">(</span><span class="s2">&quot;Aramburu&quot;</span><span class="p">);</span>
<span class="linenos" data-linenos="10 "></span><span class="k">echo</span> <span class="nv">$p2</span><span class="p">;</span>
</code></pre></div>
<p>Per a facilitar-ho, modificarem tots els seus mètodes mutadores (que modifiquen dades, setters*, ...) perquè retornen una referència a <code>$this</code>:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos=" 2 "></span><span class="k">class</span> <span class="nc">Libro </span><span class="p">{</span>
<span class="linenos" data-linenos=" 3 "></span>    <span class="k">private</span> <span class="nx">string </span><span class="nv">$nombre</span><span class="p">;</span>
<span class="linenos" data-linenos=" 4 "></span>    <span class="k">private</span> <span class="nx">string </span><span class="nv">$autor</span><span class="p">;</span>
<span class="linenos" data-linenos=" 5 "></span>
<span class="linenos" data-linenos=" 6 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="nf">getNombre</span><span class="p">()</span> <span class="o">:</span> <span class="nx">string </span><span class="p">{</span>
<span class="linenos" data-linenos=" 7 "></span>        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">nombre</span><span class="p">;</span>
<span class="linenos" data-linenos=" 8 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos=" 9 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="nf">setNombre</span><span class="p">(</span><span class="nx">string </span><span class="nv">$nombre</span><span class="p">)</span> <span class="o">:</span> <span class="nx">Libro </span><span class="p">{</span> 
<span class="linenos" data-linenos="10 "></span>        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">nombre </span><span class="o">=</span> <span class="nv">$nombre</span><span class="p">;</span>
<span class="linenos" data-linenos="11 "></span>        <span class="k">return</span> <span class="nv">$this</span><span class="p">;</span>
<span class="linenos" data-linenos="12 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="13 "></span>
<span class="linenos" data-linenos="14 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="nf">getAutor</span><span class="p">()</span> <span class="o">:</span> <span class="nx">string </span><span class="p">{</span>
<span class="linenos" data-linenos="15 "></span>        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">autor</span><span class="p">;</span>
<span class="linenos" data-linenos="16 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="17 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="nf">setAutor</span><span class="p">(</span><span class="nx">string </span><span class="nv">$autor</span><span class="p">)</span> <span class="o">:</span> <span class="nx">Libro </span><span class="p">{</span>
<span class="linenos" data-linenos="18 "></span>        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">autor </span><span class="o">=</span> <span class="nv">$autor</span><span class="p">;</span>
<span class="linenos" data-linenos="19 "></span>        <span class="k">return</span> <span class="nv">$this</span><span class="p">;</span>
<span class="linenos" data-linenos="20 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="21 "></span>
<span class="linenos" data-linenos="22 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="fm">__toString</span><span class="p">()</span> <span class="o">:</span> <span class="nx">string </span><span class="p">{</span>
<span class="linenos" data-linenos="23 "></span>        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">nombre</span><span class="o">.</span><span class="s2">&quot; de &quot;</span><span class="o">.</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">autor</span><span class="p">;</span>
<span class="linenos" data-linenos="24 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="25 "></span><span class="p">}</span>
</code></pre></div>
<h2 id="metodes-magics">Mètodes màgics<a class="headerlink" href="#metodes-magics" title="Permanent link">&para;</a></h2>
<p>Totes les classes PHP ofereixen un conjunt de mètodes, també coneguts com <em>magic methods</em> que es poden sobreescriure per a substituir el seu comportament. Alguns d'ells ja els hem utilitzats.</p>
<p>Davant qualsevol dubte, és convenient consultar la <a href="https://www.php.net/manual/es/language.oop5.magic.php">documentació oficial</a>.</p>
<p>Els més destacables són:</p>
<ul>
<li><code>__construct()</code></li>
<li><code>__destruct()</code> → s'invoca en perdre la referència. S'utilitza per a tancar una connexió a la BD, tancar un fitxer, ...</li>
<li><code>__toString()</code> → representació de l'objecte com a cadena. És a dir, quan fem <code>tire $objecte</code> s'executa automàticament aquest mètode.</li>
<li><code>__get(propietat)</code>, <code>__set(propietat, valor)</code> → Permetria accedir a les propietat privades, encara que sempre és més llegible/mantenible codificar els <em>getter/setter</em>.</li>
<li><code>__isset(propietat)</code>, <code>__unset(propietat)</code> → Permet esbrinar o llevar el valor a una propietat.</li>
<li><code>__sleep()</code>, <code>__wakeup()</code> → S'executen en recuperar (<em>unserialize^) o emmagatzemar un objecte que se serialitza (</em>serialize), i s'utilitzen per a permet definir quines propietats se serialitzen.</li>
<li><code>__call()</code>, <code>__callStatic()</code> → S'executen en cridar a un mètode que no és públic. Permeten sobrecarreguen mètodes.</li>
</ul>
<h2 id="espai-de-noms">Espai de noms<a class="headerlink" href="#espai-de-noms" title="Permanent link">&para;</a></h2>
<p>Des de PHP 5.3 i també coneguts com <em>Namespaces</em>, permeten organitzar les classes/interfícies, funcions i/o constants de manera similar als paquets a <em>Java</em>.</p>
<div class="admonition tip">
<p class="admonition-title">Recomanació</p>
<p>Un només namespace per arxiu i crear una estructura de carpetes respectant els anivelles/subnivells (igual que es fa a Java)</p>
</div>
<p>Es declaren en la primera línia mitjançant la paraula clau <code>namespace</code> seguida del nom de l'espai de noms assignat (cada subnivell se separa amb la barra invertida <code>\</code>):</p>
<p>Per exemple, per a col·locar la classe <code>Producte</code> dins del <em>namespace</em> <code>Dwes\Exemples</code> ho faríem així:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos=" 2 "></span><span class="k">namespace</span> <span class="nx">Dwes\Exemples</span><span class="p">;</span>
<span class="linenos" data-linenos=" 3 "></span>
<span class="linenos" data-linenos=" 4 "></span><span class="k">const</span> <span class="no">IVA </span><span class="o">=</span> <span class="mf">0.21</span><span class="p">;</span>
<span class="linenos" data-linenos=" 5 "></span>
<span class="linenos" data-linenos=" 6 "></span><span class="k">class</span> <span class="nc">Producte </span><span class="p">{</span>
<span class="linenos" data-linenos=" 7 "></span>    <span class="k">public</span> <span class="nv">$nombre</span><span class="p">;</span>
<span class="linenos" data-linenos=" 8 "></span>      
<span class="linenos" data-linenos=" 9 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="nf">muestra</span><span class="p">()</span> <span class="o">:</span> <span class="nx">void </span><span class="p">{</span>
<span class="linenos" data-linenos="10 "></span>        <span class="k">echo</span><span class="s2">&quot;&lt;p&gt;Prod:&quot;</span> <span class="o">.</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">nombre </span><span class="o">.</span> <span class="s2">&quot;&lt;/p&gt;&quot;</span><span class="p">;</span>
<span class="linenos" data-linenos="11 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="12 "></span><span class="p">}</span>
</code></pre></div>
<h3 id="acces">Accés<a class="headerlink" href="#acces" title="Permanent link">&para;</a></h3>
<p>Per a referenciar a un recurs que conté un namespace, primer hem de tindre'l disponible fent ús de <code>include</code> o <code>require</code>. Si el recurs està en el mateix <em>namespace</em>, es realitza un accés directe (es coneix com a accés sense qualificar).</p>
<p>Realment hi ha tres tipus d'accés:</p>
<ul>
<li>sense qualificar: <code>recurs</code></li>
<li>qualificat: <code>rutaRelativa\recurs</code> → no fa falta posar el <em>namespace</em> complet</li>
<li>totalment qualificat: <code>\rutaAbsoluta\recurs</code></li>
</ul>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos=" 2 "></span><span class="k">namespace</span> <span class="nx">Dwes\Ejemplos</span><span class="p">;</span>
<span class="linenos" data-linenos=" 3 "></span>
<span class="linenos" data-linenos=" 4 "></span><span class="k">include_once</span><span class="p">(</span><span class="s2">&quot;Producto.php&quot;</span><span class="p">);</span>
<span class="linenos" data-linenos=" 5 "></span>
<span class="linenos" data-linenos=" 6 "></span><span class="k">echo</span> <span class="nx">IVA</span><span class="p">;</span> <span class="c1">// sin cualificar</span>
<span class="linenos" data-linenos=" 7 "></span><span class="k">echo</span> <span class="nx">Utilidades\IVA</span><span class="p">;</span> <span class="c1">// acceso cualificado. Daría error, no existe \Dwes\Ejemplos\Utilidades\IVA</span>
<span class="linenos" data-linenos=" 8 "></span><span class="k">echo</span> <span class="nx">\Dwes\Ejemplos\IVA</span><span class="p">;</span> <span class="c1">// totalmente cualificado</span>
<span class="linenos" data-linenos=" 9 "></span>
<span class="linenos" data-linenos="10 "></span><span class="nv">$p1 </span><span class="o">=</span> <span class="k">new</span> <span class="nx">Producto</span><span class="p">();</span> <span class="c1">// lo busca en el mismo namespace y encuentra \Dwes\Ejemplos\Producto</span>
<span class="linenos" data-linenos="11 "></span><span class="nv">$p2 </span><span class="o">=</span> <span class="k">new</span> <span class="nx">Model\Producto</span><span class="p">();</span> <span class="c1">// daría error, no existe el namespace Model. Está buscando \Dwes\Ejemplos\Model\Producto</span>
<span class="linenos" data-linenos="12 "></span><span class="nv">$p3 </span><span class="o">=</span> <span class="k">new</span> <span class="nx">\Dwes\Ejemplos\Producto</span><span class="p">();</span> <span class="c1">// \Dwes\Ejemplos\Producto</span>
</code></pre></div>
<h3 id="acces_1">Accés<a class="headerlink" href="#acces_1" title="Permanent link">&para;</a></h3>
<p>Per a evitar la referència qualificada podem declarar l'ús mitjançant <code>use</code> (similar a fer <code>import</code> a Java). Es fa en la capçalera, després del <code>namespace</code>:</p>
<p>Els tipus Posibles són:</p>
<ul>
<li><code>use const nombreCualificadoConstante</code></li>
<li><code>use function nombreCualificadoFuncion</code></li>
<li><code>use nombreCualificadoClase</code></li>
<li><code>use nombreCualificadoClase as NuevoNombre</code> // per a canviar de nom elements</li>
</ul>
<p>Per exemple, si volem utilitzar la classe <code>\Dwes\Exemples\Producte</code> des d'un recurs que es troba en l'arrel, per exemple en <code>inici.php</code>, faríem:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos="2 "></span><span class="k">include_once</span><span class="p">(</span><span class="s2">&quot;Dwes\Exemples\Producte.php&quot;</span><span class="p">);</span>
<span class="linenos" data-linenos="3 "></span>
<span class="linenos" data-linenos="4 "></span><span class="k">use</span> <span class="k">const</span> <span class="no">Dwes\Exemples\IVA</span><span class="p">;</span>
<span class="linenos" data-linenos="5 "></span><span class="k">use</span> <span class="nx">\Dwes\Exemples\Producte</span><span class="p">;</span>
<span class="linenos" data-linenos="6 "></span>
<span class="linenos" data-linenos="7 "></span><span class="k">echo</span> <span class="nx">IVA</span><span class="p">;</span>
<span class="linenos" data-linenos="8 "></span><span class="nv">$p1 </span><span class="o">=</span> <span class="k">new</span> <span class="nx">Producte</span><span class="p">();</span>
</code></pre></div>
<div class="admonition tip">
<p class="admonition-title">To <code>use</code> or not to <code>use</code></p>
<p>En resum, <code>use</code> permet accedir sense qualificar a recursos que estan en un altre <em>namespace</em>. Si estem en el mateix espai de nom, no necessitem <code>use</code>.</p>
</div>
<h3 id="organitzacio">Organització<a class="headerlink" href="#organitzacio" title="Permanent link">&para;</a></h3>
<p>Tot projecte, conforme creix, necessita organitzar el seu codi font. Es planteja una organització en la qual els arxius que interactuan amb el navegador es col·loquen en l'arrel, i les classes que definim van dins d'un namespace (i dins de la seua pròpia carpeta <code>src</code> o <code>app</code>).</p>
<figure>
<img src="imagenes/03/03organizacion.png">
<figcaption>Organització del codi font</figcaption>
</figure>

<div class="admonition tip">
<p class="admonition-title">Organització, includes i usos</p>
<ul>
<li>Col·locarem cada recurs en un fitxer a part.</li>
<li>En la primera línia indicarem la seua <em>namespace</em> (si no està en l'arrel).</li>
<li>Si utilitzem altres recursos, farem un <code>include_once</code> d'aqueixos recursos (classes, interfícies, etc...).</li>
<li>Cada recurs ha d'incloure tots els altres recursos que referencie: la classe de la qual hereta, interfícies que implementa, classes utilitzades/rebudes com a paràmetres, etc...</li>
<li>Si els recursos estan en un espai de noms diferent al que estem, emprarem <code>use</code> amb la ruta completa per a després utilitzar referències sense qualificar.</li>
</ul>
</div>
<h3 id="autoload">Autoload<a class="headerlink" href="#autoload" title="Permanent link">&para;</a></h3>
<p>No és tediós haver de fer el <code>include</code> de les classes? El autolloeu* ve al rescat.</p>
<p>Així doncs, permet carregar les classes (no les constants ni les funcions) que s'utilitzaran i evitar haver de fer el <code>include_onze</code> de cadascuna d'elles. Per a això, s'utilitza la funció <code>spl_autolloeu_register</code></p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos="2 "></span><span class="nb">spl_autoload_register</span><span class="p">(</span> <span class="k">function</span><span class="p">(</span> <span class="nv">$nombreClase </span><span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-linenos="3 "></span>    <span class="k">include_once</span> <span class="nv">$nombreClase</span><span class="o">.</span><span class="s1">&#39;.php&#39;</span><span class="p">;</span>
<span class="linenos" data-linenos="4 "></span><span class="p">}</span> <span class="p">);</span>
<span class="linenos" data-linenos="5 "></span><span class="cp">?&gt;</span><span class="x"></span>
</code></pre></div>
<div class="admonition question">
<p class="admonition-title">Per què es diuen autoload?</p>
<p>Perquè abans es realitzava mitjançant el mètode màgic <code>__autoload()</code>, el qual està <em>deprecated</em> des de PHP 7.2</p>
</div>
<p>I com organitzem ara el nostre codi aprofitant el autoload?</p>
<figure style="float: right;">
    <img src="imagenes/03/03autoload.png" width="600">
    <figcaption>Organització amb autoload</figcaption>
</figure>

<p>Per a facilitar la cerca dels recursos a incloure, és recomanable col·locar totes les classes dins d'una mateixa carpeta. Nosaltres la col·locarem dins de <code>app</code> (més endavant, quan estudiem <em>Laravel</em> veurem el motiu d'aquesta decisió). Altres carpetes que podem crear són <code>test</code> per a col·locar les proves <em>PhpUnit</em> que després realitzarem, o la carpeta <code>vendor</code> on s'emmagatzemaran les llibreries del projecte (aquesta carpeta és un estándard dins de PHP, ja que <em>Composer</em> la crea automàticament).</p>
<p>Com hem col·locat tots els nostres recursos dins de <code>app</code>, ara nostre <code>autoload.php</code> (el qual col·loquem en la carpeta arrel) només buscarà dins d'aqueixa carpeta:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos="2 "></span><span class="nb">spl_autoload_register</span><span class="p">(</span> <span class="k">function</span><span class="p">(</span> <span class="nv">$nombreClase </span><span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-linenos="3 "></span>    <span class="k">include_once</span> <span class="s2">&quot;app/&quot;</span><span class="o">.</span><span class="nv">$nombreClase</span><span class="o">.</span><span class="s1">&#39;.php&#39;</span><span class="p">;</span>
<span class="linenos" data-linenos="4 "></span><span class="p">}</span> <span class="p">);</span>
<span class="linenos" data-linenos="5 "></span><span class="cp">?&gt;</span><span class="x"></span>
</code></pre></div>
<div class="admonition tip">
<p class="admonition-title">autolloeu i rutes errònies</p>
<p>En <em>Ubuntu</em> en fer el <em>include</em> de la classe que rep com a paràmetre, les barres dels namespace (<code>\</code>) són diferents a les de les rutes (<code>/</code>). Per això, és millor que utilitzem el fitxer autoload:
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos="2 "></span><span class="nb">spl_autoload_register</span><span class="p">(</span> <span class="k">function</span><span class="p">(</span> <span class="nv">$nombreClase </span><span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-linenos="3 "></span>    <span class="nv">$ruta</span> <span class="o">=</span> <span class="s2">&quot;app</span><span class="se">\\</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$nombreClase</span><span class="o">.</span><span class="s1">&#39;.php&#39;</span><span class="p">;</span>
<span class="linenos" data-linenos="4 "></span>    <span class="nv">$ruta</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;/&quot;</span><span class="p">,</span> <span class="nv">$ruta</span><span class="p">);</span> <span class="c1">// Sustituimos las barras</span>
<span class="linenos" data-linenos="5 "></span>    <span class="k">include_once</span> <span class="nv">$ruta</span><span class="err">&#39;</span><span class="p">;</span>
<span class="linenos" data-linenos="6 "></span><span class="p">}</span> <span class="p">);</span>
<span class="linenos" data-linenos="7 "></span><span class="cp">?&gt;</span><span class="x"></span>
</code></pre></div></p>
</div>
<h2 id="gestio-derrors">Gestió d'Errors<a class="headerlink" href="#gestio-derrors" title="Permanent link">&para;</a></h2>
<p>PHP classifica els errors que ocorren en diferents nivells. Cada nivell s'identifica amb una constant. Per exemple:</p>
<ul>
<li><code>E_ERROR</code>: errors fatals, no recuperables. S'interromp el script.</li>
<li><code>E_WARNING</code>: advertiments en temps d'execució. El script no s'interromp.</li>
<li><code>E_NOTICE</code>: avisos en temps d'execució.</li>
</ul>
<p>Podeu comprovar el llistat complet de constants de <a href="https://www.php.net/manual/es/errorfunc.constants.php">https://www.php.net/manual/es/errorfunc.constants.php</a></p>
<p>Per a la configuració dels errors podem fer-ho de dues formes:</p>
<ul>
<li>A nivell de <code>php.ini</code>:</li>
<li><code>error_reporting</code>: indica els nivells d'errors a notificar<ul>
<li><code>error_reporting = E_ALL &amp; ~E_NOTICE</code> -&gt; Tots els errors menys els avisos en temps d'execució.</li>
</ul>
</li>
<li><code>display_errors</code>: indica si mostrar o no els errors per pantalla. En entorns de producció és comuna posar-ho a <code>off</code></li>
<li>mitjançant codi amb les següents funcions:<ul>
<li><code>error_reporting(codigo)</code> -&gt; Controla quins errors notificar</li>
<li><code>set_error_handler(nombreManejador)</code> -&gt; Indica que funció s'invocarà cada vegada que es trobe un error. El manejador rep com a paràmetres el nivell de l'error i el missatge</li>
</ul>
</li>
</ul>
<p>A continuació tenim un exemple mitjançant codi:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="2:2"><input checked="checked" id="__tabbed_2_1" name="__tabbed_2" type="radio" /><input id="__tabbed_2_2" name="__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="__tabbed_2_1">Funcions per a la gestió d'errors</label><label for="__tabbed_2_2">Consola</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos=" 2 "></span><span class="nb">error_reporting</span><span class="p">(</span><span class="k">E_ALL</span> <span class="o">&amp;</span> <span class="o">~</span><span class="nx">E_NOTICE </span><span class="o">&amp;</span> <span class="o">~</span><span class="k">E_WARNING</span><span class="p">);</span>
<span class="linenos" data-linenos=" 3 "></span><span class="nv">$resultado </span><span class="o">=</span> <span class="nv">$dividendo </span><span class="o">/</span> <span class="nv">$divisor</span><span class="p">;</span>
<span class="linenos" data-linenos=" 4 "></span>
<span class="linenos" data-linenos=" 5 "></span><span class="nb">error_reporting</span><span class="p">(</span><span class="k">E_ALL</span> <span class="o">&amp;</span> <span class="o">~</span><span class="nx">E_NOTICE</span><span class="p">);</span>
<span class="linenos" data-linenos=" 6 "></span><span class="nb">set_error_handler</span><span class="p">(</span><span class="s2">&quot;miManejadorErrores&quot;</span><span class="p">);</span>
<span class="linenos" data-linenos=" 7 "></span><span class="nv">$resultado </span><span class="o">=</span> <span class="nv">$dividendo </span><span class="o">/</span> <span class="nv">$divisor</span><span class="p">;</span>
<span class="linenos" data-linenos=" 8 "></span><span class="nb">restore_error_handler</span><span class="p">();</span> <span class="c1">// vuelve al anterior</span>
<span class="linenos" data-linenos=" 9 "></span>
<span class="linenos" data-linenos="10 "></span><span class="k">function</span> <span class="nf">miManejadorErrores</span><span class="p">(</span><span class="nv">$nivel</span><span class="p">,</span> <span class="nv">$mensaje</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-linenos="11 "></span>    <span class="k">switch</span><span class="p">(</span><span class="nv">$nivel</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-linenos="12 "></span>        <span class="k">case</span> <span class="k">E_WARNING</span><span class="o">:</span>
<span class="linenos" data-linenos="13 "></span>            <span class="k">echo</span> <span class="s2">&quot;&lt;strong&gt;Warning&lt;/strong&gt;: </span><span class="si">$mensaje</span><span class="s2">.&lt;br/&gt;&quot;</span><span class="p">;</span>
<span class="linenos" data-linenos="14 "></span>            <span class="k">break</span><span class="p">;</span>
<span class="linenos" data-linenos="15 "></span>        <span class="k">default</span><span class="o">:</span>
<span class="linenos" data-linenos="16 "></span>            <span class="k">echo</span> <span class="s2">&quot;Error de tipo no especificado: </span><span class="si">$mensaje</span><span class="s2">.&lt;br/&gt;&quot;</span><span class="p">;</span>
<span class="linenos" data-linenos="17 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="18 "></span><span class="p">}</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>Error de tipo no especificado: Undefined variable: dividendo.
<span class="linenos" data-linenos="2 "></span>Error de tipo no especificado: Undefined variable: divisor.
<span class="linenos" data-linenos="3 "></span>Error de tipo Warning: Division by zero.
</code></pre></div>
</div>
</div>
</div>
<h2 id="excepcions">Excepcions<a class="headerlink" href="#excepcions" title="Permanent link">&para;</a></h2>
<p>La gestió d'excepcions forma part des de PHP 5. El seu funcionament és similar a Java*, fent ús d'un bloc <code>try / catch / finally</code>.
Si detectem una situació anòmala i volem llançar una excepció, haurem de realitzar <code>throw new Exception</code> (adjuntant el missatge que l'ha provocat).</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos="2 "></span><span class="k">try</span> <span class="p">{</span>
<span class="linenos" data-linenos="3 "></span>    <span class="k">if</span> <span class="p">(</span><span class="nv">$divisor </span><span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-linenos="4 "></span>        <span class="k">throw</span> <span class="k">new</span> <span class="nx">Exception</span><span class="p">(</span><span class="s2">&quot;División por cero.&quot;</span><span class="p">);</span>
<span class="linenos" data-linenos="5 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="6 "></span>    <span class="nv">$resultado </span><span class="o">=</span> <span class="nv">$dividendo </span><span class="o">/</span> <span class="nv">$divisor</span><span class="p">;</span>
<span class="linenos" data-linenos="7 "></span><span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">Exception </span><span class="nv">$e</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-linenos="8 "></span>    <span class="k">echo</span> <span class="s2">&quot;Se ha producido el siguiente error: &quot;</span><span class="o">.</span><span class="nv">$e</span><span class="o">-&gt;</span><span class="na">getMessage</span><span class="p">();</span>
<span class="linenos" data-linenos="9 "></span><span class="p">}</span>
</code></pre></div>
<p>La classe <code>Exception</code> és la classe pare de totes les excepcions. El seu constructor rep <code>missatge[,codigoError][,excepcionPrevia]</code>.</p>
<p>A partir d'un objecte <code>Exception</code>, podem accedir als mètodes <code>getMessage()</code>i <code>getCode()</code> per a obtindre el missatge i el codi d'error de l'excepció capturada.</p>
<p>El propi llenguatge ofereix un conjunt d'excepcions ja definides, les quals podem capturar (i llançar des de PHP 7). Es recomana la seua consulta en la <a href="https://www.php.net/manual/es/class.exception.php">documentació oficial</a>.</p>
<h3 id="creant-excepcions">Creant excepcions<a class="headerlink" href="#creant-excepcions" title="Permanent link">&para;</a></h3>
<p>Per a crear una excepció, la forma més curta és crear una classe que únicament herete de <code>Exception</code>.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos="2 "></span><span class="k">class</span> <span class="nc">HolaExcepcion extends Exception </span><span class="p">{}</span>
</code></pre></div>
<p>Si volem, i és recomanable depenent dels requisits, podem sobrecarregar els mètodes màgics, per exemple, sobrecarregant el constructor i cridant al constructor del pare, o reescriure el mètode <code>__toString</code> per a canviar el seu missatge:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos=" 2 "></span><span class="k">class</span> <span class="nc">MiExcepcion extends Exception </span><span class="p">{</span>
<span class="linenos" data-linenos=" 3 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">(</span><span class="nv">$msj</span><span class="p">,</span> <span class="nv">$codigo </span><span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">Exception </span><span class="nv">$previa </span><span class="o">=</span> <span class="k">null</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-linenos=" 4 "></span>        <span class="c1">// código propio</span>
<span class="linenos" data-linenos=" 5 "></span>        <span class="k">parent</span><span class="o">::</span><span class="na">__construct</span><span class="p">(</span><span class="nv">$msj</span><span class="p">,</span> <span class="nv">$codigo</span><span class="p">,</span> <span class="nv">$previa</span><span class="p">);</span>
<span class="linenos" data-linenos=" 6 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos=" 7 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="fm">__toString</span><span class="p">()</span> <span class="p">{</span>
<span class="linenos" data-linenos=" 8 "></span>        <span class="k">return</span> <span class="no">__CLASS__</span> <span class="o">.</span> <span class="s2">&quot;: [</span><span class="si">{</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">code</span><span class="si">}</span><span class="s2">]: </span><span class="si">{</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">message</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="linenos" data-linenos=" 9 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="10 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="nf">miFuncion</span><span class="p">()</span> <span class="p">{</span>
<span class="linenos" data-linenos="11 "></span>        <span class="k">echo</span> <span class="s2">&quot;Una función personalizada para este tipo de excepción</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="linenos" data-linenos="12 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="13 "></span><span class="p">}</span>
</code></pre></div>
<p>Si definim una excepció d'aplicació dins d'un <em>namespace</em>, quan referenciem a <code>Exception</code>, haurem de referenciar-la mitjançant el seu nom totalment qualificat (<code>\Exception</code>), o utilitzant <code>use</code>:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="3:2"><input checked="checked" id="__tabbed_3_1" name="__tabbed_3" type="radio" /><input id="__tabbed_3_2" name="__tabbed_3" type="radio" /><div class="tabbed-labels"><label for="__tabbed_3_1">Mitjançant nom totalment qualificat</label><label for="__tabbed_3_2">Mitjançant <code>use</code></label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos="2 "></span><span class="k">namespace</span> <span class="nx">\Dwes\Ejemplos</span><span class="p">;</span>
<span class="linenos" data-linenos="3 "></span>
<span class="linenos" data-linenos="4 "></span><span class="k">class</span> <span class="nc">AppExcepcion extends \Exception </span><span class="p">{}</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos="2 "></span><span class="k">namespace</span> <span class="nx">\Dwes\Ejemplos</span><span class="p">;</span>
<span class="linenos" data-linenos="3 "></span>
<span class="linenos" data-linenos="4 "></span><span class="k">use</span> <span class="nx">Exception</span><span class="p">;</span>
<span class="linenos" data-linenos="5 "></span>
<span class="linenos" data-linenos="6 "></span><span class="k">class</span> <span class="nc">AppExcepcion extends Exception </span><span class="p">{}</span>
</code></pre></div>
</div>
</div>
</div>
<h3 id="excepcions-multiples">Excepcions múltiples<a class="headerlink" href="#excepcions-multiples" title="Permanent link">&para;</a></h3>
<p>Es poden usar excepcions múltiples per a comprovar diferents condicions. A l'hora de capturar-les, es fa de més específica a més general.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos=" 2 "></span><span class="nv">$email </span><span class="o">=</span> <span class="s2">&quot;ejemplo@ejemplo.com&quot;</span><span class="p">;</span>
<span class="linenos" data-linenos=" 3 "></span><span class="k">try</span> <span class="p">{</span>
<span class="linenos" data-linenos=" 4 "></span>    <span class="c1">// Comprueba si el email es válido</span>
<span class="linenos" data-linenos=" 5 "></span>    <span class="k">if</span><span class="p">(</span><span class="nb">filter_var</span><span class="p">(</span><span class="nv">$email</span><span class="p">,</span> <span class="nx">FILTER_VALIDATE_EMAIL</span><span class="p">)</span> <span class="o">===</span> <span class="k">FALSE</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-linenos=" 6 "></span>        <span class="k">throw</span> <span class="k">new</span> <span class="nx">MiExcepcion</span><span class="p">(</span><span class="nv">$email</span><span class="p">);</span>
<span class="linenos" data-linenos=" 7 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos=" 8 "></span>    <span class="c1">// Comprueba la palabra ejemplo en la dirección email</span>
<span class="linenos" data-linenos=" 9 "></span>    <span class="k">if</span><span class="p">(</span><span class="nb">strpos</span><span class="p">(</span><span class="nv">$email</span><span class="p">,</span> <span class="s2">&quot;ejemplo&quot;</span><span class="p">)</span> <span class="o">!==</span> <span class="k">FALSE</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-linenos="10 "></span>        <span class="k">throw</span> <span class="k">new</span> <span class="nx">Exception</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">$email es un email de ejemplo</span><span class="s2"> no válido&quot;</span><span class="p">);</span>
<span class="linenos" data-linenos="11 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="12 "></span><span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">MiExcepcion </span><span class="nv">$e</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-linenos="13 "></span>    <span class="k">echo</span> <span class="nv">$e</span><span class="o">-&gt;</span><span class="na">miFuncion</span><span class="p">();</span>
<span class="linenos" data-linenos="14 "></span><span class="p">}</span> <span class="k">catch</span><span class="p">(</span><span class="nx">Exception </span><span class="nv">$e</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-linenos="15 "></span>    <span class="k">echo</span> <span class="nv">$e</span><span class="o">-&gt;</span><span class="na">getMessage</span><span class="p">();</span>
<span class="linenos" data-linenos="16 "></span><span class="p">}</span>
</code></pre></div>
<div class="admonition question">
<p class="admonition-title">Autoevaluación</p>
<p>¿Qué pasaría al ejectuar el siguiente código?
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos=" 2 "></span><span class="k">class</span> <span class="nc">MainException extends Exception </span><span class="p">{}</span>
<span class="linenos" data-linenos=" 3 "></span><span class="k">class</span> <span class="nc">SubException extends MainException </span><span class="p">{}</span>
<span class="linenos" data-linenos=" 4 "></span>
<span class="linenos" data-linenos=" 5 "></span><span class="k">try</span> <span class="p">{</span>
<span class="linenos" data-linenos=" 6 "></span>    <span class="k">throw</span> <span class="k">new</span> <span class="nx">SubException</span><span class="p">(</span><span class="s2">&quot;Lanzada SubException&quot;</span><span class="p">);</span>
<span class="linenos" data-linenos=" 7 "></span><span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">MainException </span><span class="nv">$e</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-linenos=" 8 "></span>    <span class="k">echo</span> <span class="s2">&quot;Capturada MainException &quot;</span> <span class="o">.</span> <span class="nv">$e</span><span class="o">-&gt;</span><span class="na">getMessage</span><span class="p">();</span>
<span class="linenos" data-linenos=" 9 "></span><span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">SubException </span><span class="nv">$e</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-linenos="10 "></span>    <span class="k">echo</span> <span class="s2">&quot;Capturada SubException &quot;</span> <span class="o">.</span> <span class="nv">$e</span><span class="o">-&gt;</span><span class="na">getMessage</span><span class="p">();</span>
<span class="linenos" data-linenos="11 "></span><span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">Exception </span><span class="nv">$e</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-linenos="12 "></span>    <span class="k">echo</span> <span class="s2">&quot;Capturada Exception &quot;</span> <span class="o">.</span> <span class="nv">$e</span><span class="o">-&gt;</span><span class="na">getMessage</span><span class="p">();</span>
<span class="linenos" data-linenos="13 "></span><span class="p">}</span>
</code></pre></div></p>
</div>
<p>Si en el mateix <code>catch</code> volem capturar diverses excepcions, hem d'utilitzar l'operador <code>|</code>:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos="2 "></span><span class="k">class</span> <span class="nc">MainException extends Exception </span><span class="p">{}</span>
<span class="linenos" data-linenos="3 "></span><span class="k">class</span> <span class="nc">SubException extends MainException </span><span class="p">{}</span>
<span class="linenos" data-linenos="4 "></span>
<span class="linenos" data-linenos="5 "></span><span class="k">try</span> <span class="p">{</span>
<span class="linenos" data-linenos="6 "></span>    <span class="k">throw</span> <span class="k">new</span> <span class="nx">SubException</span><span class="p">(</span><span class="s2">&quot;Lanzada SubException&quot;</span><span class="p">);</span>
<span class="linenos" data-linenos="7 "></span><span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">MainException </span><span class="o">|</span> <span class="nx">SubException </span><span class="nv">$e </span><span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-linenos="8 "></span>    <span class="k">echo</span> <span class="s2">&quot;Capturada Exception &quot;</span> <span class="o">.</span> <span class="nv">$e</span><span class="o">-&gt;</span><span class="na">getMessage</span><span class="p">();</span>
<span class="linenos" data-linenos="9 "></span><span class="p">}</span>
</code></pre></div>
<p>Des de PHP 7, existeix el tipus <code>Throwable</code>, el qual és una interfície que implementen tant els errors com les excepcions, i ens permet capturar els dos tipus alhora:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos="2 "></span><span class="k">try</span> <span class="p">{</span>
<span class="linenos" data-linenos="3 "></span>    <span class="c1">// tu codigo</span>
<span class="linenos" data-linenos="4 "></span><span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">Throwable </span><span class="nv">$e</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-linenos="5 "></span>    <span class="k">echo</span> <span class="s1">&#39;Forma de capturar errores y excepciones a la vez&#39;</span><span class="p">;</span>
<span class="linenos" data-linenos="6 "></span><span class="p">}</span>
</code></pre></div>
<p>Si només volem capturar els errors fatals, podem fer ús de la classe <code>Error</code>:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos="2 "></span><span class="k">try</span> <span class="p">{</span>
<span class="linenos" data-linenos="3 "></span>    <span class="c1">// Genera una notificación que no se captura</span>
<span class="linenos" data-linenos="4 "></span>    <span class="k">echo</span> <span class="nv">$variableNoAsignada</span><span class="p">;</span>
<span class="linenos" data-linenos="5 "></span>    <span class="c1">// Error fatal que se captura</span>
<span class="linenos" data-linenos="6 "></span>    <span class="nx">funcionQueNoExiste</span><span class="p">();</span>
<span class="linenos" data-linenos="7 "></span><span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">Error </span><span class="nv">$e</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-linenos="8 "></span>    <span class="k">echo</span> <span class="s2">&quot;Error capturado: &quot;</span> <span class="o">.</span> <span class="nv">$e</span><span class="o">-&gt;</span><span class="na">getMessage</span><span class="p">();</span>
<span class="linenos" data-linenos="9 "></span><span class="p">}</span>
</code></pre></div>
<h3 id="rellancar-excepcions">Rellançar excepcions<a class="headerlink" href="#rellancar-excepcions" title="Permanent link">&para;</a></h3>
<p>En les aplicacions reals, és molt comuna capturar una excepció de sistema i llançar una d'aplicació que hem definit nostros.
També podem llançar les excepcions sense necessitat d'estar dins d'un <code>try/catch</code>.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos="2 "></span><span class="k">class</span> <span class="nc">AppException extends Exception </span><span class="p">{}</span>
<span class="linenos" data-linenos="3 "></span>
<span class="linenos" data-linenos="4 "></span><span class="k">try</span> <span class="p">{</span>
<span class="linenos" data-linenos="5 "></span>    <span class="c1">// Código de negocio que falla</span>
<span class="linenos" data-linenos="6 "></span><span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">Exception </span><span class="nv">$e</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-linenos="7 "></span>    <span class="k">throw</span> <span class="k">new</span> <span class="nx">AppException</span><span class="p">(</span><span class="s2">&quot;AppException: &quot;</span><span class="o">.</span><span class="nv">$e</span><span class="o">-&gt;</span><span class="na">getMessage</span><span class="p">(),</span> <span class="nv">$e</span><span class="o">-&gt;</span><span class="na">getCode</span><span class="p">(),</span> <span class="nv">$e</span><span class="p">);</span>
<span class="linenos" data-linenos="8 "></span><span class="p">}</span>
</code></pre></div>
<h2 id="spl">SPL<a class="headerlink" href="#spl" title="Permanent link">&para;</a></h2>
<p><em>Standard PHP Library</em> és el conjunt de funcions i utilitats que ofereix PHP, com:</p>
<ul>
<li>Estructures de dades</li>
<li>Pila, cua, cua de prioritat, llista doblement enllaçada, etc...</li>
<li>Conjunt de iteradores dissenyats per a recórrer estructures agregades</li>
<li>arrays, resultats de bases de dades, arbres XML, llistats de directoris, etc.</li>
</ul>
<p>Podeu consultar la documentació en <a href="https://www.php.net/manual/es/book.spl.php">https://www.php.net/manual/es/book.spl.php</a> o veure alguns exemples en <a href="https://diego.com.es/tutorial-de-la-libreria-spl-de-php">https://diego.com.es/tutorial-de-la-libreria-spl-de-php</a></p>
<p>També defineix un conjunt d'excepcions que podem utilitzar perquè les llancen les nostres aplicacions:</p>
<ul>
<li><code>LogicException</code> (<code>extends Exception</code>)<ul>
<li><code>BadFunctionCallException</code></li>
<li><code>BadMethodCallException</code></li>
<li><code>DomainException</code></li>
<li><code>InvalidArgumentException</code></li>
<li><code>LengthException</code></li>
<li><code>OutOfRangeException</code></li>
</ul>
</li>
<li><code>RuntimeException</code> (<code>extends Exception</code>)<ul>
<li><code>OutOfBoundsException</code></li>
<li><code>OverflowException</code></li>
<li><code>RangeException</code></li>
<li><code>UnderflowException</code></li>
<li><code>UnexpectedValueException</code></li>
</ul>
</li>
</ul>
<p>També podeu consultar la documentació d'aquestes excepcions en <a href="https://www.php.net/manual/es/spl.exceptions.php">https://www.php.net/manual/es/spl.exceptions.php</a>.</p>
<h2 id="referencies">Referències<a class="headerlink" href="#referencies" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="https://www.php.net/manual/es/index.php">Manual de PHP</a></li>
<li><a href="https://desarrolloweb.com/manuales/manual-php.html#manual68">Manual de OO en PHP - www.desarrolloweb.com</a></li>
</ul>
<h2 id="activitats">Activitats<a class="headerlink" href="#activitats" title="Permanent link">&para;</a></h2>
<ol start="300">
<li>Investiga la diferència entre un paradigma orientat a objectes basat en classes (<em>PHP</em>) respecte a un basat en prototips (JavaScript).</li>
</ol>
<h3 id="objetos">Objetos<a class="headerlink" href="#objetos" title="Permanent link">&para;</a></h3>
<ol start="301">
<li><code>301Empleado.php</code>: Crea una classe <code>Emprat</code> amb el seu nom, cognoms i sou.
     Encapsula les propietats mitjançant <em>getters/setters</em> i afig mètodes per a:<ul>
<li>Obtindre el seu nom complet → <code>getNombreCompleto(): string</code></li>
<li>Que retorne un booleà indicant si deu o no pagar impostos (es paguen quan el sou és superior a 3333€) → <code>debePagarImpuestos(): bool</code></li>
</ul>
</li>
<li><code>302EmpleadoTelefonos.php</code>: Còpia la classe de l'exercici anterior i modifica-la.
     Afig una propietat privada que emmagatzeme un array de nombres de telèfons.
     Afig els següents mètodes:<ul>
<li><code>public function anyadirTelefono(int $telefono) : void</code> → Afig un telèfon al array</li>
<li><code>public function listarTelefonos(): string</code> → Mostra els telèfons separats per comes</li>
<li><code>public function vaciarTelefonos(): void</code> → Elimina tots els telèfons</li>
</ul>
</li>
<li><code>303EmpleadoConstructor.php</code>: Còpia la classe de l'exercici anterior i modifica-la.
     Elimina els setters* de <code>nom</code> i <code>cognoms</code>, de manera que aquestes dades s'assignen mitjançant el constructor (utilitza la sintaxi de PHP7).
     Si el constructor rep un tercer paràmetre, serà el sou del <code>Empleat</code>. Si no, se li assignarà 1000€ com a sou inicial.</li>
</ol>
<p><code>303EmpleadoConstructor8.php</code>: Modifica la classe i utilitza la sintaxi de PHP 8 de promoció de les propietats del constructor.</p>
<ol start="304">
<li><code>304EmpleadoConstante.php</code>: Còpia la classe de l'exercici anterior i modifica-la.
     Afig una constant <code>SOU_TOPALL</code> amb el valor del sou que ha de pagar impostos, i modifica el codi per a utilitzar la constant.</li>
<li><code>305EmpleadoSueldo.php</code>: Còpia la classe de l'exercici anterior i modifica-la.
     Canvia la constant per una variable estàtica <code>sueldoTope</code>, de manera que mitjançant <em>getter/setter</em> pugues modificar el seu valor.306. <code>306EmpleadoStatic.php</code>: Copia la clase del ejercicio anterior y modifícala.</li>
<li>
<p>Completa el següent mètode amb una cadena HTML que mostre les dades d'un empleat dins d'un paràgraf i tots els telèfons mitjançant una llista ordenada (per a això, hauràs de crear un <em>getter</em> per als telèfons):</p>
<ul>
<li><code>public static function toHtml(Empleado $emp): string</code>
 
<figure style="float: right;">
     <img src="imagenes/03/03p307.png">
     <figcaption>Ejercicio 307</figcaption>
 </figure></li>
</ul>
</li>
<li>
<p><code>307Persona.php</code>: Còpia la classe de l'exercici anterior en <code>307Empleado.php</code> i modifica-la.
     Crea una classe <code>Persona</code> que siga pare de <code>Empleat</code>, de manera que <code>Persona</code> continga el nom i els cognoms, i en <code>Empleat</code> quede el salari i els telèfons.</p>
</li>
<li>
<p><code>308PersonaH.php</code>: Còpia les classes de l'exercici anterior i modifica-les. Crea en <code>Persona</code> el mètode estàtic <code>toHtml(Persona $p)</code>, i modifica en <code>Empleat</code> el mateix mètode <code>toHtml(Persona $p)</code>, però canvia la signatura perquè reba una <code>Persona</code> com a paràmetre.
     Per a accedir a les propietats de l'empleat amb la persona que rebem com a paràmetre, comprovarem el seu tipus:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos=" 2 "></span><span class="k">class</span> <span class="nc">Empleado</span> <span class="k">extends</span> <span class="nx">Persona</span> <span class="p">{</span>
<span class="linenos" data-linenos=" 3 "></span>    <span class="c1">/// resto del código</span>
<span class="linenos" data-linenos=" 4 "></span>
<span class="linenos" data-linenos=" 5 "></span>
<span class="linenos" data-linenos=" 6 "></span>    <span class="k">public</span> <span class="k">static</span> <span class="k">function</span> <span class="nf">toHtml</span><span class="p">(</span><span class="nx">Persona</span> <span class="nv">$p</span><span class="p">)</span><span class="o">:</span> <span class="nx">string</span> <span class="p">{</span>
<span class="linenos" data-linenos=" 7 "></span>        <span class="k">if</span> <span class="p">(</span><span class="nv">$p</span> <span class="nx">instanceof</span> <span class="nx">Empleado</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-linenos=" 8 "></span>            <span class="c1">// Aqui ya podemos acceder a las propiedades y métodos de Empleado</span>
<span class="linenos" data-linenos=" 9 "></span>        <span class="p">}</span>
<span class="linenos" data-linenos="10 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="11 "></span><span class="p">}</span>
</code></pre></div>
</li>
<li>
<p><code>309PersonaE.php</code>: Còpia les classes de l'exercici anterior i modifica-les.
     Afig en <code>Persona</code> un atribut <code>edat</code>
     A l'hora de saber si un empleat ha de pagar impostos, el farà sempre que tinga més de 21 anys i depenga del valor del seu sou.
     Modifica tot el codi necessari per a mostrar i/o editar l'edat quan siga necessari.</p>
</li>
<li>
<p><code>310PersonaS.php</code>: Còpia les classes de l'exercici anterior i modifica-les.
     Afig nous mètodes que facen una representació de totes les propietats de les classes <code>Persona</code> i <code>Empleat</code>, de manera similar als realitzats en HTML, però sense que siguen estàtics, de manera que  obtinga les dades mitjançant <code>$this</code>.</p>
<ul>
<li><code>function public __toString(): string</code></li>
</ul>
</li>
</ol>
<div class="admonition tip">
<p class="admonition-title"><em>Magic methods</em></p>
<p>El mètode <code>__toString()</code> és un mètode màgic que s'invoca automàticament quan volem obtindre la representació en cadena d'un objecte.</p>
</div>
<ol start="311">
<li>
<p><code>311PersonaA.php</code>: Còpia les classes de l'exercici anterior i modifica-les.
     Transforma <code>Persona</code> a una classe abstracta on el seu mètode estàtic <code>toHtml(Persona $p)</code> haja de ser redefinit en tots els seus fills.</p>
</li>
<li>
<p><code>312Trabajador.php</code>: Còpia les classes de l'exercici anterior i modifica-les.</p>
<ul>
<li>Canvia l'estructura de classes conforme al gràfic respectant tots els mètodes que ja estan fets.</li>
<li><code>Treballador</code> és una classe abstracta que ara emmagatzema els <code>telefonos</code> i on <code>calcularSueldo</code> és un mètode abstracte de manera que:</li>
<li>El sou d'un <code>Empleat</code> es calcula a partir de les hores treballades i el que cobra per hora.</li>
<li>Per als <code>Gerent</code>s, el seu sou s'incrementa percentualment sobre la base de la seua edat: <code>salari + salariedat/100</code></li>
</ul>
</li>
</ol>
<figure>
   <img src="imagenes/03/03p312.png">
   <figcaption>Ejercicio 312</figcaption>
</figure>
<ol start="313">
<li>
<p><code>313Empresa.php</code>: Utilitzant les classes dels exercicis anteriors:</p>
<ul>
<li>Crea una classe <code>Empresa</code> que a més del nom i la direcció, continga una propietat amb un array de <code>Treballador</code>és, ja siguen <code>Emprat</code>s o <code>Gerent</code>s. </li>
<li>Afig <em>getters/setters</em> per al nom i direcció.</li>
<li>Afig mètodes per a afegir i llistar els treballadors.<ul>
<li><code>public function anyadirTrabajador(Treballador $t)</code></li>
<li><code>public function listarTrabajadoresHtml() : string</code> -&gt; utilitza <code>Treballador::toHtml(Persona $p)</code></li>
</ul>
</li>
<li>Afig un mètode per a obtindre el cost total en nòmines.<ul>
<li><code>public function getCosteNominas(): float</code> -&gt; recorre els treballadors i invoca al mètode <code>calcularSueldo()</code>.</li>
</ul>
</li>
</ul>
</li>
<li>
<p><code>314EmpresaI.php</code>: Còpia les classes de l'exercici anterior i modifica-les.</p>
<ul>
<li>Crea una interfície JSerializable, de manera que oferisca els mètodes:</li>
<li>
<p><code>toJSON(): string</code> → utilitza la funció <a href="https://www.php.net/manual/es/function.json-encode.php"><code>json_encode(mixed)</code></a>. Tingues en compte que com tenim les propietats dels objectes privats, has de recórrer les propietats i col·locar-les en un mapa. Per exemple:        <code>php
           &lt;?php
           public function toJSON(): string {
               foreach ($this as $clave =&gt; $valor) {
                   $mapa-&gt;$clave = $valor;
               }
               return json_encode($mapa);
           }
           ?&gt;</code></p>
</li>
<li>
<p><code>toSerialize(): string</code> → utilizta la funció <a href="https://www.php.net/manual/es/function.serialize.php"><code>serialize(mixed)</code></a></p>
</li>
<li>Modifica totes les classes que no són abstractes perquè implementen la interfície creada.</li>
</ul>
</li>
</ol>
<h3 id="projecte-videoclub">Projecte Videoclub<a class="headerlink" href="#projecte-videoclub" title="Permanent link">&para;</a></h3>
<p>En els següents exercicis simularem un xicotet projecte d'un Videoclub (basat en la proposta que fa el tutorial de desarrolloweb.com), el qual realitzarem mitjançant un desenvolupament incremental i seguint la pràctica de programació en parelles (<em>pair programming</em>).</p>
<p>Abans de res, crea un repositori privat en GitHub i puja el projecte actual de Videoclub*. Una vegada creat, convida al teu company al repositori com a col·laborador.</p>
<ul>
<li>Inicialitza en local el teu repostorio de git, mitjançant <code>git init</code></li>
<li>Afig i puja els canvis al teu repositori, mitjançant <code>git add .</code> i després <code>git commit -m 'Inicialitzant projecte'.</code></li>
<li>Connecta el teu repositori amb GitHub i puja els canvis (mira la instruccions de GitHub: comandos <code>git remalnom</code> i <code>git push</code>).</li>
<li>El teu company haurà de descarregar el projecte amb les seues credencials.</li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Projecte no real</p>
<p>El següent projecte està pensat des d'un punt de vista formatiu. Algunes de les decisions que es prenen no s'han d'usar (com fer <code>tire</code> dins de les classes) o provar el codi comparant el resultat en el navegador.</p>
</div>
<p>Cada classe ha d'anar en un arxiu php separat. Per a facilitar la seua implementació, es mostra l'estructura UML del model i un fragment de codi per a provar les classes:</p>
<figure style="float: right;">
    <img src="imagenes/03/03p320.png" width="150">
    <figcaption>Creamos el Soporte</figcaption>
</figure>

<ol start="320">
<li>
<p>Crea una classe per a emmagatzemar suports (<code>Soporte.php</code>). Aquesta classe serà la classe pare dels diferents suports amb els quals treballe el nostre videoclub (cintes de vídeo, videojocs, etc...):</p>
<ul>
<li>Crea el constructor que inicialitze les seues propietats. Fixa't que la classe no té mètodes setters*.</li>
<li>Definir una constant mitjançant un propietat privada i estàtica denominada `IVA amb un valor del 21%</li>
<li>Crear un arxiu (<code>inici.php</code>) per a usar les classes i còpia el següent fragment:</li>
</ul>
</li>
</ol>
<div class="tabbed-set tabbed-alternate" data-tabs="4:2"><input checked="checked" id="__tabbed_4_1" name="__tabbed_4" type="radio" /><input id="__tabbed_4_2" name="__tabbed_4" type="radio" /><div class="tabbed-labels"><label for="__tabbed_4_1">Código de prueba</label><label for="__tabbed_4_2">Navegador</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos="2 "></span><span class="k">include</span> <span class="s2">&quot;Soporte.php&quot;</span><span class="p">;</span>
<span class="linenos" data-linenos="3 "></span>
<span class="linenos" data-linenos="4 "></span><span class="nv">$soporte1 </span><span class="o">=</span> <span class="k">new</span> <span class="nx">Soporte</span><span class="p">(</span><span class="s2">&quot;Tenet&quot;</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span> 
<span class="linenos" data-linenos="5 "></span><span class="k">echo</span> <span class="s2">&quot;&lt;strong&gt;&quot;</span> <span class="o">.</span> <span class="nv">$soporte1</span><span class="o">-&gt;</span><span class="na">titulo </span><span class="o">.</span> <span class="s2">&quot;&lt;/strong&gt;&quot;</span><span class="p">;</span> 
<span class="linenos" data-linenos="6 "></span><span class="k">echo</span> <span class="s2">&quot;&lt;br&gt;Precio: &quot;</span> <span class="o">.</span> <span class="nv">$soporte1</span><span class="o">-&gt;</span><span class="na">getPrecio</span><span class="p">()</span> <span class="o">.</span> <span class="s2">&quot; euros&quot;</span><span class="p">;</span> 
<span class="linenos" data-linenos="7 "></span><span class="k">echo</span> <span class="s2">&quot;&lt;br&gt;Precio IVA incluido: &quot;</span> <span class="o">.</span> <span class="nv">$soporte1</span><span class="o">-&gt;</span><span class="na">getPrecioConIVA</span><span class="p">()</span> <span class="o">.</span> <span class="s2">&quot; euros&quot;</span><span class="p">;</span>
<span class="linenos" data-linenos="8 "></span><span class="nv">$soporte1</span><span class="o">-&gt;</span><span class="na">muestraResumen</span><span class="p">();</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p><pre>
<strong>Tenet</strong>
Precio: 3 euros
Precio IVA incluido: 3.48 euros
<em>Tenet</em>
3 € (IVA no incluido)
</pre></p>
</div>
</div>
</div>
<figure style="float: right;">
    <img src="imagenes/03/03p321.png" width="150">
    <figcaption>Afegim Cinta de Video</figcaption>
</figure>

<ol start="321">
<li>
<p>Crea la classe <code>CintaVideo</code> la qual hereta de <code>Soporte</code>. Afig l'atribut <code>duracion</code> i sobreescriu tant el contructor com el mètode <code>MuestraResumen</code> (des de <code>CintaVideo</code> hauràs de cridar al mètode <code>MuestraResumen</code> del pare).</p>
<p>Afig a <code>inici.php</code> el codi per a provar la classe:</p>
</li>
</ol>
<div class="tabbed-set tabbed-alternate" data-tabs="5:2"><input checked="checked" id="__tabbed_5_1" name="__tabbed_5" type="radio" /><input id="__tabbed_5_2" name="__tabbed_5" type="radio" /><div class="tabbed-labels"><label for="__tabbed_5_1">Código de prueba</label><label for="__tabbed_5_2">Navegador</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos="2 "></span><span class="k">include</span> <span class="s2">&quot;CintaVideo.php&quot;</span><span class="p">;</span>
<span class="linenos" data-linenos="3 "></span>
<span class="linenos" data-linenos="4 "></span><span class="nv">$miCinta </span><span class="o">=</span> <span class="k">new</span> <span class="nx">CintaVideo</span><span class="p">(</span><span class="s2">&quot;Los cazafantasmas&quot;</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">,</span> <span class="mi">107</span><span class="p">);</span> 
<span class="linenos" data-linenos="5 "></span><span class="k">echo</span> <span class="s2">&quot;&lt;strong&gt;&quot;</span> <span class="o">.</span> <span class="nv">$miCinta</span><span class="o">-&gt;</span><span class="na">titulo </span><span class="o">.</span> <span class="s2">&quot;&lt;/strong&gt;&quot;</span><span class="p">;</span> 
<span class="linenos" data-linenos="6 "></span><span class="k">echo</span> <span class="s2">&quot;&lt;br&gt;Precio: &quot;</span> <span class="o">.</span> <span class="nv">$miCinta</span><span class="o">-&gt;</span><span class="na">getPrecio</span><span class="p">()</span> <span class="o">.</span> <span class="s2">&quot; euros&quot;</span><span class="p">;</span> 
<span class="linenos" data-linenos="7 "></span><span class="k">echo</span> <span class="s2">&quot;&lt;br&gt;Precio IVA incluido: &quot;</span> <span class="o">.</span> <span class="nv">$miCinta</span><span class="o">-&gt;</span><span class="na">getPrecioConIva</span><span class="p">()</span> <span class="o">.</span> <span class="s2">&quot; euros&quot;</span><span class="p">;</span>
<span class="linenos" data-linenos="8 "></span><span class="nv">$miCinta</span><span class="o">-&gt;</span><span class="na">muestraResumen</span><span class="p">();</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p><pre>
<strong>Los cazafantasmas</strong>
Precio: 3.5 euros
Precio IVA incluido: 4.06 euros
Película en VHS:
<em>Los cazafantasmas</em>
3.5 € (IVA no incluido)
Duración: 107 minutos
</pre></p>
</div>
</div>
</div>
<figure style="float: right;">
    <img src="imagenes/03/03p322.png" width="250">
    <figcaption>Afegim Dvd</figcaption>
</figure>

<ol start="322">
<li>
<p>Crea la classe <code>Dvd</code> la qual hereta de <code>Soporte</code>. Afig els atributs <code>idiomas</code> i <code>formatoPantalla</code>. A continuació sobreescriu tant el contructor com el mètode <code>MuestraResumen</code>.</p>
<p>Afig a <code>inici.php</code> el codi per a provar la classe:</p>
</li>
</ol>
<div class="tabbed-set tabbed-alternate" data-tabs="6:2"><input checked="checked" id="__tabbed_6_1" name="__tabbed_6" type="radio" /><input id="__tabbed_6_2" name="__tabbed_6" type="radio" /><div class="tabbed-labels"><label for="__tabbed_6_1">Código de prueba</label><label for="__tabbed_6_2">Navegador</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos="2 "></span><span class="k">include</span> <span class="s2">&quot;Dvd.php&quot;</span><span class="p">;</span>
<span class="linenos" data-linenos="3 "></span>
<span class="linenos" data-linenos="4 "></span><span class="nv">$miDvd </span><span class="o">=</span> <span class="k">new</span> <span class="nx">Dvd</span><span class="p">(</span><span class="s2">&quot;Origen&quot;</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="s2">&quot;es,en,fr&quot;</span><span class="p">,</span> <span class="s2">&quot;16:9&quot;</span><span class="p">);</span> 
<span class="linenos" data-linenos="5 "></span><span class="k">echo</span> <span class="s2">&quot;&lt;strong&gt;&quot;</span> <span class="o">.</span> <span class="nv">$miDvd</span><span class="o">-&gt;</span><span class="na">titulo </span><span class="o">.</span> <span class="s2">&quot;&lt;/strong&gt;&quot;</span><span class="p">;</span> 
<span class="linenos" data-linenos="6 "></span><span class="k">echo</span> <span class="s2">&quot;&lt;br&gt;Precio: &quot;</span> <span class="o">.</span> <span class="nv">$miDvd</span><span class="o">-&gt;</span><span class="na">getPrecio</span><span class="p">()</span> <span class="o">.</span> <span class="s2">&quot; euros&quot;</span><span class="p">;</span> 
<span class="linenos" data-linenos="7 "></span><span class="k">echo</span> <span class="s2">&quot;&lt;br&gt;Precio IVA incluido: &quot;</span> <span class="o">.</span> <span class="nv">$miDvd</span><span class="o">-&gt;</span><span class="na">getPrecioConIva</span><span class="p">()</span> <span class="o">.</span> <span class="s2">&quot; euros&quot;</span><span class="p">;</span>
<span class="linenos" data-linenos="8 "></span><span class="nv">$miDvd</span><span class="o">-&gt;</span><span class="na">muestraResumen</span><span class="p">();</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p><pre>
<strong>Origen</strong>
Precio: 15 euros
Precio IVA incluido: 17.4 euros
Película en DVD:
<em>Origen</em>
15 € (IVA no incluido)
Idiomas:es,en,fr
Formato Pantalla:16:9
</pre></p>
</div>
</div>
</div>
<figure style="float: left;">
    <img src="imagenes/03/03p323.png" width="350">
    <figcaption>Afegim Juego</figcaption>
</figure>

<ol start="323">
<li>
<p>Crea la classe <code>Juego</code> la qual hereta de <code>Soporte</code>. Afig els atributs <code>consola</code>, <code>minNumJugadores</code> i <code>maxNumJugadores</code>. A continuació afig el mètode <code>muestraJugadoresPosibles</code>, el qual ha de mostrar Per a un <em>jugador</em>, Per a X <em>Jugadores</em> o De X a I <em>Jugadores</em> depenent dels valors de les atributs creats. Finalment, sobreescriu tant el contructor com el mètode <code>MuestraResumen</code>.</p>
<p>Afig a <code>inici.php</code> el codi per a provar la classe:</p>
</li>
</ol>
<div class="tabbed-set tabbed-alternate" data-tabs="7:2"><input checked="checked" id="__tabbed_7_1" name="__tabbed_7" type="radio" /><input id="__tabbed_7_2" name="__tabbed_7" type="radio" /><div class="tabbed-labels"><label for="__tabbed_7_1">Código de prueba</label><label for="__tabbed_7_2">Navegador</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos="2 "></span><span class="k">include</span> <span class="s2">&quot;Juego.php&quot;</span><span class="p">;</span>
<span class="linenos" data-linenos="3 "></span>
<span class="linenos" data-linenos="4 "></span><span class="nv">$miJuego</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Juego</span><span class="p">(</span><span class="s2">&quot;The Last of Us Part II&quot;</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="mf">49.99</span><span class="p">,</span> <span class="s2">&quot;PS4&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span> 
<span class="linenos" data-linenos="5 "></span><span class="k">echo</span> <span class="s2">&quot;&lt;strong&gt;&quot;</span> <span class="o">.</span> <span class="nv">$miJuego</span><span class="o">-&gt;</span><span class="na">titulo</span> <span class="o">.</span> <span class="s2">&quot;&lt;/strong&gt;&quot;</span><span class="p">;</span> 
<span class="linenos" data-linenos="6 "></span><span class="k">echo</span> <span class="s2">&quot;&lt;br&gt;Precio: &quot;</span> <span class="o">.</span> <span class="nv">$miJuego</span><span class="o">-&gt;</span><span class="na">getPrecio</span><span class="p">()</span> <span class="o">.</span> <span class="s2">&quot; euros&quot;</span><span class="p">;</span> 
<span class="linenos" data-linenos="7 "></span><span class="k">echo</span> <span class="s2">&quot;&lt;br&gt;Precio IVA incluido: &quot;</span> <span class="o">.</span> <span class="nv">$miJuego</span><span class="o">-&gt;</span><span class="na">getPrecioConIva</span><span class="p">()</span> <span class="o">.</span> <span class="s2">&quot; euros&quot;</span><span class="p">;</span>
<span class="linenos" data-linenos="8 "></span><span class="nv">$miJuego</span><span class="o">-&gt;</span><span class="na">muestraResumen</span><span class="p">();</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p><pre>
<strong>The Last of Us Part II</strong>
Precio: 49.99 euros
Precio IVA incluido: 57.9884 euros
Juego para: PS4
<em>The Last of Us Part II</em>
49.99 € (IVA no incluido)
Para un jugador
</pre></p>
</div>
</div>
</div>
<p>Arribats a aquest punt, el nostre model és similar al següent diagrama:</p>
<figure>
    <img src="imagenes/03/03videoclub1.png" width="600">
    <figcaption>Model inicial de Videoclub</figcaption>
</figure>

<figure style="float: right;">
    <img src="imagenes/03/03p324.png" width="275">
    <figcaption>Afegim Cliente</figcaption>
</figure>

<ol start="324">
<li>
<p>Crear la classe <code>Cliente</code>. El constructor rebrà el <code>nom</code>, <code>numere</code> i <code>maxLloguerConcurrent</code>, aquest últim podent ser opcional i prenent com a valor per defecte 3. Després d'això, afig <em>getter/setter</em> únicament a <code>numere</code>, i un <em>getter</em> a <code>numSoportsalquilados</code> (aquest camp emmagatzemarà un comptador del total de lloguers que ha realitzat). El array de suports alquilados contedrá classes que hereten de <code>Soporte</code>. Finalment, afig el mètode <code>MuestraResumen</code> que mostre el nom i la quantitat de lloguers (grandària del array <code>soportsalquilados</code>).</p>
</li>
<li>
<p>Dins de <code>Cliente</code>, afig les següent operacions:</p>
<ul>
<li><code>tieneAlquilado(Soporte $s): bool</code> → Recorre el array de suports i comprova si està el suport</li>
<li><code>alquilar(Soporte $s): bool</code> -→ Ha de comprovar si el suport està alquilado i si no ha superat el contingent de lloguers. En llogar, incrementarà el <code>numSoportsalquilados</code> i emmagatzemarà el suport en el array. Per a cada cas ha de mostrar un missatge informant de l'ocorregut.</li>
</ul>
</li>
<li>
<p>Seguim amb <code>Cliente</code> per a afegir les operacions:</p>
<ul>
<li><code>retornar(int $numSoporte): bool</code> → Ha de comprovar que el suport estava llogat i actualitzar la quantitat de suports llogats. Per a cada cas ha de mostrar un missatge informant de l'ocorregut</li>
<li><code>llistarLloguers(): void</code> → Informa de quants lloguers té el client i els mostra.</li>
</ul>
</li>
</ol>
<p>Crea l'arxiu <code>inicio2.php</code> amb el següent codi font per a provar la classe:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="8:2"><input checked="checked" id="__tabbed_8_1" name="__tabbed_8" type="radio" /><input id="__tabbed_8_2" name="__tabbed_8" type="radio" /><div class="tabbed-labels"><label for="__tabbed_8_1">Codi de prova</label><label for="__tabbed_8_2">Navegador</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos=" 2 "></span><span class="k">include_once</span> <span class="s2">&quot;CintaVideo.php&quot;</span><span class="p">;</span>
<span class="linenos" data-linenos=" 3 "></span><span class="k">include_once</span> <span class="s2">&quot;Dvd.php&quot;</span><span class="p">;</span>
<span class="linenos" data-linenos=" 4 "></span><span class="k">include_once</span> <span class="s2">&quot;Juego.php&quot;</span><span class="p">;</span>
<span class="linenos" data-linenos=" 5 "></span><span class="k">include_once</span> <span class="s2">&quot;Cliente.php&quot;</span><span class="p">;</span>
<span class="linenos" data-linenos=" 6 "></span>
<span class="linenos" data-linenos=" 7 "></span><span class="c1">//instanciamos un par de objetos Clientee</span>
<span class="linenos" data-linenos=" 8 "></span><span class="nv">$cliente1</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Cliente</span><span class="p">(</span><span class="s2">&quot;Bruce Wayne&quot;</span><span class="p">,</span> <span class="mi">23</span><span class="p">);</span>
<span class="linenos" data-linenos=" 9 "></span><span class="nv">$cliente2</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Cliente</span><span class="p">(</span><span class="s2">&quot;Clark Kent&quot;</span><span class="p">,</span> <span class="mi">33</span><span class="p">);</span>
<span class="linenos" data-linenos="10 "></span>
<span class="linenos" data-linenos="11 "></span><span class="c1">//mostramos el número de cada cliente creado </span>
<span class="linenos" data-linenos="12 "></span><span class="k">echo</span> <span class="s2">&quot;&lt;br&gt;El identificador del cliente 1 es: &quot;</span> <span class="o">.</span> <span class="nv">$cliente1</span><span class="o">-&gt;</span><span class="na">getNumero</span><span class="p">();</span>
<span class="linenos" data-linenos="13 "></span><span class="k">echo</span> <span class="s2">&quot;&lt;br&gt;El identificador del cliente 2 es: &quot;</span> <span class="o">.</span> <span class="nv">$cliente2</span><span class="o">-&gt;</span><span class="na">getNumero</span><span class="p">();</span>
<span class="linenos" data-linenos="14 "></span>
<span class="linenos" data-linenos="15 "></span><span class="c1">//instancio algunos soportes </span>
<span class="linenos" data-linenos="16 "></span><span class="nv">$soporte1</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">CintaVideo</span><span class="p">(</span><span class="s2">&quot;Los cazafantasmas&quot;</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">,</span> <span class="mi">107</span><span class="p">);</span>
<span class="linenos" data-linenos="17 "></span><span class="nv">$soporte2</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Juego</span><span class="p">(</span><span class="s2">&quot;The Last of Us Part II&quot;</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="mf">49.99</span><span class="p">,</span> <span class="s2">&quot;PS4&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>  
<span class="linenos" data-linenos="18 "></span><span class="nv">$soporte3</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Dvd</span><span class="p">(</span><span class="s2">&quot;Origen&quot;</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="s2">&quot;es,en,fr&quot;</span><span class="p">,</span> <span class="s2">&quot;16:9&quot;</span><span class="p">);</span>
<span class="linenos" data-linenos="19 "></span><span class="nv">$soporte4</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Dvd</span><span class="p">(</span><span class="s2">&quot;El Imperio Contraataca&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;es,en&quot;</span><span class="p">,</span><span class="s2">&quot;16:9&quot;</span><span class="p">);</span>
<span class="linenos" data-linenos="20 "></span>
<span class="linenos" data-linenos="21 "></span><span class="c1">//alquilo algunos soportes</span>
<span class="linenos" data-linenos="22 "></span><span class="nv">$cliente1</span><span class="o">-&gt;</span><span class="na">alquilar</span><span class="p">(</span><span class="nv">$soporte1</span><span class="p">);</span>
<span class="linenos" data-linenos="23 "></span><span class="nv">$cliente1</span><span class="o">-&gt;</span><span class="na">alquilar</span><span class="p">(</span><span class="nv">$soporte2</span><span class="p">);</span>
<span class="linenos" data-linenos="24 "></span><span class="nv">$cliente1</span><span class="o">-&gt;</span><span class="na">alquilar</span><span class="p">(</span><span class="nv">$soporte3</span><span class="p">);</span>
<span class="linenos" data-linenos="25 "></span>
<span class="linenos" data-linenos="26 "></span><span class="c1">//voy a intentar alquilar de nuevo un soporte que ya tiene alquilado</span>
<span class="linenos" data-linenos="27 "></span><span class="nv">$cliente1</span><span class="o">-&gt;</span><span class="na">alquilar</span><span class="p">(</span><span class="nv">$soporte1</span><span class="p">);</span>
<span class="linenos" data-linenos="28 "></span><span class="c1">//el cliente tiene 3 soportes en alquiler como máximo</span>
<span class="linenos" data-linenos="29 "></span><span class="c1">//este soporte no lo va a poder alquilar</span>
<span class="linenos" data-linenos="30 "></span><span class="nv">$cliente1</span><span class="o">-&gt;</span><span class="na">alquilar</span><span class="p">(</span><span class="nv">$soporte4</span><span class="p">);</span>
<span class="linenos" data-linenos="31 "></span><span class="c1">//este soporte no lo tiene alquilado</span>
<span class="linenos" data-linenos="32 "></span><span class="nv">$cliente1</span><span class="o">-&gt;</span><span class="na">tornar</span><span class="p">(</span><span class="mi">4</span><span class="p">);</span>
<span class="linenos" data-linenos="33 "></span><span class="c1">//devuelvo un soporte que sí que tiene alquilado</span>
<span class="linenos" data-linenos="34 "></span><span class="nv">$cliente1</span><span class="o">-&gt;</span><span class="na">tornar</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
<span class="linenos" data-linenos="35 "></span><span class="c1">//alquilo otro soporte</span>
<span class="linenos" data-linenos="36 "></span><span class="nv">$cliente1</span><span class="o">-&gt;</span><span class="na">Alquilar</span><span class="p">(</span><span class="nv">$soporte4</span><span class="p">);</span>
<span class="linenos" data-linenos="37 "></span><span class="c1">//listo los elementos alquilados</span>
<span class="linenos" data-linenos="38 "></span><span class="nv">$cliente1</span><span class="o">-&gt;</span><span class="na">llistaLloguers</span><span class="p">();</span>
<span class="linenos" data-linenos="39 "></span><span class="c1">//este cliente no tiene alquileres</span>
<span class="linenos" data-linenos="40 "></span><span class="nv">$cliente2</span><span class="o">-&gt;</span><span class="na">tornar</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p><pre>
El identificador del cliente 1 es: 23
El identificador del cliente 2 es: 33
<strong>Alquilado soporte a</strong>: Bruce Wayne</p>
<p>Película en VHS:
<em>Los cazafantasmas</em>
3.5 € (IVA no incluido)
Duración: 107 minutos</p>
<p><strong>Alquilado soporte a</strong>: Bruce Wayne</p>
<p>Juego para: PS4
<em>The Last of Us Part II</em>
49.99 € (IVA no incluido)
Para un jugador</p>
<p><strong>Alquilado soporte a</strong>: Bruce Wayne</p>
<p>Película en DVD:
<em>Origen</em>
15 € (IVA no incluido)
Idiomas:es,en,fr
Formato Pantalla:16:9</p>
<p>El cliente ya tiene alquilado el soporte <strong>Los cazafantasmas</strong></p>
<p>Este cliente tiene 3 elementos alquilados. No puede alquilar más en este videoclub hasta que no devuelva algo</p>
<p>No se ha podido encontrar el soporte en los alquileres de este cliente</p>
<p>No se ha podido encontrar el soporte en los alquileres de este cliente</p>
<p>Este cliente tiene 3 elementos alquilados. No puede alquilar más en este videoclub hasta que no devuelva algo</p>
<p><strong>El cliente tiene 3 soportes alquilados</strong></p>
<p>Película en VHS:
<em>Los cazafantasmas</em>
3.5 € (IVA no incluido)
Duración: 107 minutos</p>
<p>Juego para: PS4
<em>The Last of Us Part II</em>
49.99 € (IVA no incluido)
Para un jugador</p>
<p>Película en DVD:
<em>Origen</em>
15 € (IVA no incluido)
Idiomas:es,en,fr
Formato Pantalla:16:9</p>
<p>Este cliente no tiene alquilado ningún elemento
</pre></p>
</div>
</div>
</div>
<ol start="327">
<li>Arribat a aquest punt, relacionarem els clients i els suports mitjançant la classe <code>Videoclub</code>. Així doncs crea la classe que representa el gràfic, tenint en compte que:<ul>
<li><code>productes</code> és un array de <code>Soporte</code></li>
<li><code>socis</code> és una array de <code>Cliente</code></li>
<li>Els mètodes públics d'incloure algun suport, crearan la classe i cridaran al mètode privat de <code>incluirProducto</code>, el qual és l'encarregat d'introduir-lo dins del array.</li>
</ul>
</li>
</ol>
<p>El model complet quedarà de la següent manera:</p>
<figure>
    <img src="imagenes/03/03videoclub2.png" width="800">
    <figcaption>Model complet de Videoclub</figcaption>
</figure>

<p>I per a provar el projecte, dins <code>inicio3.php</code> col·locarem:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="9:2"><input checked="checked" id="__tabbed_9_1" name="__tabbed_9" type="radio" /><input id="__tabbed_9_2" name="__tabbed_9" type="radio" /><div class="tabbed-labels"><label for="__tabbed_9_1">Codi de prova</label><label for="__tabbed_9_2">Navegador</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos=" 2 "></span><span class="k">include_once</span> <span class="s2">&quot;Videoclub.php&quot;</span><span class="p">;</span> <span class="c1">// No incluimos nada más</span>
<span class="linenos" data-linenos=" 3 "></span>
<span class="linenos" data-linenos=" 4 "></span><span class="nv">$vc</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Videoclub</span><span class="p">(</span><span class="s2">&quot;Severo 8A&quot;</span><span class="p">);</span> 
<span class="linenos" data-linenos=" 5 "></span>
<span class="linenos" data-linenos=" 6 "></span><span class="c1">//voy a incluir unos cuantos soportes de prueba </span>
<span class="linenos" data-linenos=" 7 "></span><span class="nv">$vc</span><span class="o">-&gt;</span><span class="na">incluirJuego</span><span class="p">(</span><span class="s2">&quot;God of War&quot;</span><span class="p">,</span> <span class="mf">19.99</span><span class="p">,</span> <span class="s2">&quot;PS4&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span> 
<span class="linenos" data-linenos=" 8 "></span><span class="nv">$vc</span><span class="o">-&gt;</span><span class="na">incluirJuego</span><span class="p">(</span><span class="s2">&quot;The Last of Us Part II&quot;</span><span class="p">,</span> <span class="mf">49.99</span><span class="p">,</span> <span class="s2">&quot;PS4&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="linenos" data-linenos=" 9 "></span><span class="nv">$vc</span><span class="o">-&gt;</span><span class="na">incluirDvd</span><span class="p">(</span><span class="s2">&quot;Torrente&quot;</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">,</span> <span class="s2">&quot;es&quot;</span><span class="p">,</span><span class="s2">&quot;16:9&quot;</span><span class="p">);</span> 
<span class="linenos" data-linenos="10 "></span><span class="nv">$vc</span><span class="o">-&gt;</span><span class="na">incluirDvd</span><span class="p">(</span><span class="s2">&quot;Origen&quot;</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">,</span> <span class="s2">&quot;es,en,fr&quot;</span><span class="p">,</span> <span class="s2">&quot;16:9&quot;</span><span class="p">);</span> 
<span class="linenos" data-linenos="11 "></span><span class="nv">$vc</span><span class="o">-&gt;</span><span class="na">incluirDvd</span><span class="p">(</span><span class="s2">&quot;El Imperio Contraataca&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;es,en&quot;</span><span class="p">,</span><span class="s2">&quot;16:9&quot;</span><span class="p">);</span> 
<span class="linenos" data-linenos="12 "></span><span class="nv">$vc</span><span class="o">-&gt;</span><span class="na">incluirCintaVideo</span><span class="p">(</span><span class="s2">&quot;Los cazafantasmas&quot;</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">,</span> <span class="mi">107</span><span class="p">);</span> 
<span class="linenos" data-linenos="13 "></span><span class="nv">$vc</span><span class="o">-&gt;</span><span class="na">incluirCintaVideo</span><span class="p">(</span><span class="s2">&quot;El nombre de la Rosa&quot;</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mi">140</span><span class="p">);</span> 
<span class="linenos" data-linenos="14 "></span>
<span class="linenos" data-linenos="15 "></span><span class="c1">//listo los productos </span>
<span class="linenos" data-linenos="16 "></span><span class="nv">$vc</span><span class="o">-&gt;</span><span class="na">listarProductos</span><span class="p">();</span> 
<span class="linenos" data-linenos="17 "></span>
<span class="linenos" data-linenos="18 "></span><span class="c1">//voy a crear algunos socios </span>
<span class="linenos" data-linenos="19 "></span><span class="nv">$vc</span><span class="o">-&gt;</span><span class="na">incluirSocio</span><span class="p">(</span><span class="s2">&quot;Amancio Ortega&quot;</span><span class="p">);</span> 
<span class="linenos" data-linenos="20 "></span><span class="nv">$vc</span><span class="o">-&gt;</span><span class="na">incluirSocio</span><span class="p">(</span><span class="s2">&quot;Pablo Picasso&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span> 
<span class="linenos" data-linenos="21 "></span>
<span class="linenos" data-linenos="22 "></span><span class="nv">$vc</span><span class="o">-&gt;</span><span class="na">alquilaSocioProducto</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span> 
<span class="linenos" data-linenos="23 "></span><span class="nv">$vc</span><span class="o">-&gt;</span><span class="na">alquilaSocioProducto</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">);</span> 
<span class="linenos" data-linenos="24 "></span><span class="c1">//alquilo otra vez el soporte 2 al socio 1. </span>
<span class="linenos" data-linenos="25 "></span><span class="c1">// no debe dejarme porque ya lo tiene alquilado </span>
<span class="linenos" data-linenos="26 "></span><span class="nv">$vc</span><span class="o">-&gt;</span><span class="na">alquilaSocioProducto</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span> 
<span class="linenos" data-linenos="27 "></span><span class="c1">//alquilo el soporte 6 al socio 1. </span>
<span class="linenos" data-linenos="28 "></span><span class="c1">//no se puede porque el socio 1 tiene 2 alquileres como máximo </span>
<span class="linenos" data-linenos="29 "></span><span class="nv">$vc</span><span class="o">-&gt;</span><span class="na">alquilaSocioProducto</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">);</span> 
<span class="linenos" data-linenos="30 "></span>
<span class="linenos" data-linenos="31 "></span><span class="c1">//listo los socios </span>
<span class="linenos" data-linenos="32 "></span><span class="nv">$vc</span><span class="o">-&gt;</span><span class="na">listarSocios</span><span class="p">();</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p><pre>
Incluido soporte 0
Incluido soporte 1
Incluido soporte 2
Incluido soporte 3
Incluido soporte 4
Incluido soporte 5
Incluido soporte 6</p>
<p>Listado de los 7 productos disponibles:
1.- Juego para: PS4
<em>God of War</em>
19.99 € (IVA no incluido)
Para un jugador
2.- Juego para: PS4
<em>The Last of Us Part II</em>
49.99 € (IVA no incluido)
Para un jugador
3.- Película en DVD:
<em>Torrente</em>
4.5 € (IVA no incluido)
Idiomas:es
Formato Pantalla:16:9
4.- Película en DVD:
<em>Origen</em>
4.5 € (IVA no incluido)
Idiomas:es,en,fr
Formato Pantalla:16:9
5.- Película en DVD:
<em>El Imperio Contraataca</em>
3 € (IVA no incluido)
Idiomas:es,en
Formato Pantalla:16:9
6.- Película en VHS:
<em>Los cazafantasmas</em>
3.5 € (IVA no incluido)
Duración: 107 minutos
7.- Película en VHS:
<em>El nombre de la Rosa</em>
1.5 € (IVA no incluido)
Duración: 140 minutos</p>
<p>Incluido socio 0
Incluido socio 1</p>
<p><strong>Alquilado soporte a</strong>: Pablo Picasso</p>
<p>Película en DVD:
<em>Torrente</em>
4.5 € (IVA no incluido)
Idiomas:es
Formato Pantalla:16:9</p>
<p><strong> Alquilado soporte a</strong>: Pablo Picasso</p>
<p>Película en DVD:
<em>Origen</em>
4.5 € (IVA no incluido)
Idiomas:es,en,fr
Formato Pantalla:16:9</p>
<p>El cliente ya tiene alquilado el soporte Torrente</p>
<p>Este cliente tiene 2 elementos alquilados. No puede alquilar más en este videoclub hasta que no devuelva algo</p>
<p>Listado de 2 socios del videoclub:
1.- <strong>Cliente 0</strong>: Amancio Ortega
Alquileres actuales: 0
2.- <strong>Cliente 1</strong>: Pablo Picasso
Alquileres actuales: 2
</pre></p>
</div>
</div>
</div>
<ol start="328">
<li>
<p>Transforma <code>Soporte</code> a una classe abstracta i comprova que tot continua funcionant. Què aconseguim en fer-la abstracta?</p>
</li>
<li>
<p>Crea una interfície <code>Resumible</code>, de manera que les classes que l'implementen han d'oferir el mètode <code>muestraResumen()</code>. Modifica la classe <code>Soporte</code> i feix que implemente la interfície. Fa falta que també l'implementen els fills?</p>
</li>
</ol>
<h3 id="projecte-videoclub-20">Projecte Videoclub 2.0<a class="headerlink" href="#projecte-videoclub-20" title="Permanent link">&para;</a></h3>
<p>Antes de comenzar con la segunda parte del videoclub, crea una etiqueta mediante <code>git tag</code> con el nombre <code>v0.329</code> y sube los cambios a GitHub.</p>
<ol start="330">
<li>Modifica els operacions de llogar, tant en <code>Client</code> com en <code>Videoclub</code>, per a donar suport a l'encadenament de mètodes.
     Posteriorment, modifica el codi de prova per a utilitzar aquesta tècnica.</li>
<li>Fent ús de <em>namespaces</em>:<ul>
<li>Col·boja totes els classes/interfícies en <code>Dwes\ProyectoVideoclub</code></li>
<li>Cada classe ha de fer <code>include_once</code> dels recursos que empra</li>
<li>Col·boja el/els arxivaments de prova en l'arrel (sense espai de noms)</li>
<li>Dones de l'arxiu de proves, utilitza <code>use</code> per a poder realitzar accessos sense qualificar</li>
<li>Etiqueta els canvis com <code>v0.331</code>.</li>
</ul>
</li>
<li>Reorganitza els carpeta tal com hem vist en els anotacions: <code>app</code>, <code>test</code> i <code>vendor</code>.<ul>
<li>Crea un fitxer <code>autolloeu.php</code> per a registrar la ruta on trobar els classes</li>
<li>Modifica tot el codi necessari, incloent <code>autolloeu.php</code> on seguisca necessari i esborrant els <em>includes</em> previs.</li>
</ul>
</li>
<li>A continuació crearem un conjunt d'excepcions d'aplicació. Aquestes excepcions són simples, no necessiten sobreescriure cap mètode. Així doncs, crea l'excepció d'aplicació <code>VideoclubException</code> en el <em>namespace</em> <code>Dwes\ProyectoVideoclub\Util</code>.
     Posteriorment crea els següents fills (han d'heretar de <code>VideoclubException</code>), cadascun en el seu propi arxiu:    * <code>SoporteYaAlquiladoException</code><ul>
<li><code>CupoSuperadoException</code></li>
<li><code>SoporteNoEncontradoException</code></li>
<li><code>ClienteNoEncontradoException</code></li>
</ul>
</li>
<li>En <code>Cliente</code>, modifica els mètodes <code>alquilar</code> i <code>retornar</code>, perquè facen ús de les noves excepcions (llançant-les quan siga necessari) i funcionen com a mètodes encadenats. Destacar que aquests mètodes, no es capturar estàs excepcions, només es llancen.
     En <code>Videoclub</code>, modifica <code>alquilarSocioPelicula</code> per a capturar totes les excepcions que ara llança <code>Cliente</code> i informar l'usuari en conseqüència.</li>
<li>Modificarem el projecte perquè el videoclub sàpia quins productes estan o no llogats:<ul>
<li>En <code>Soporte</code>, crea una propietat pública el nom de la qual siga <code>alquilado</code> que inicialment estarà a <code>false</code>. Quan es llogue, es posarà a <code>true</code>. En retornar, la tornarem a posar a <code>false</code>.</li>
<li>En <code>Videoclub</code>, crea dues noves propietats i les seues getters:
         * <code>numProductosAlquilados</code>
         * <code>numTotalAlquileres</code></li>
</ul>
</li>
<li>Crea un nou mètode en <code>Videoclub</code> anomenat <code>alquilarSocioProductos(int numSocio, array numerosProductos)</code>, el qual ha de rebre un array amb els productes a llogar.
     Abans de llogar-los, ha de comprovar que tots els suports estiguen disponibles, de manera que si un no ho està, no se li llogue cap.</li>
<li>
<p>Crea dos nous mètodes en <code>Videoclub</code>, i mitjançant la definició, dedueix què han de realitzar:</p>
<ul>
<li><code>devolverSocioProducto(int numSocio, int numeroProducto)</code></li>
<li><code>devolverSocioProductos(int numSocio, array numerosProductos)</code></li>
</ul>
<p>Han de suportar l'encadenament de mètodes.
Recorda actualitzar la propietat <code>alquilado</code> dels diferents suports.</p>
</li>
</ol>
<p>Quan hages realitzat tots els exercicis, crea una etiqueta mitjançant <code>git tag</code> amb el nom <code>v0.337</code> i puja els canvis a GitHub.</p>

              
            </article>
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="02php.html" class="md-footer__link md-footer__link--prev" aria-label="Anterior: 2.- El llenguatge PHP" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Anterior
              </span>
              2.- El llenguatge PHP
            </div>
          </div>
        </a>
      
      
        
        <a href="04web.html" class="md-footer__link md-footer__link--next" aria-label="Següent: 4.- Programació Web" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Següent
              </span>
              4.- Programació Web
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      2021-2022 Aitor Medrano, Luis Alemañ - Licencia CC BY-NC-SA
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
      
      
    
    <a href="https://twitter.com/aitormedrano" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M22.46 6c-.77.35-1.6.58-2.46.69.88-.53 1.56-1.37 1.88-2.38-.83.5-1.75.85-2.72 1.05C18.37 4.5 17.26 4 16 4c-2.35 0-4.27 1.92-4.27 4.29 0 .34.04.67.11.98C8.28 9.09 5.11 7.38 3 4.79c-.37.63-.58 1.37-.58 2.15 0 1.49.75 2.81 1.91 3.56-.71 0-1.37-.2-1.95-.5v.03c0 2.08 1.48 3.82 3.44 4.21a4.22 4.22 0 0 1-1.93.07 4.28 4.28 0 0 0 4 2.98 8.521 8.521 0 0 1-5.33 1.84c-.34 0-.68-.02-1.02-.06C3.44 20.29 5.7 21 8.12 21 16 21 20.33 14.46 20.33 8.79c0-.19 0-.37-.01-.56.84-.6 1.56-1.36 2.14-2.23z"/></svg>
    </a>
  
    
    
    <a href="mailto:<a.medrano@edu.gva.es>" target="_blank" rel="noopener" title="" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 12.13c-.15.01-.29.06-.39.17l-1 1 2.05 2 1-1c.22-.21.22-.56 0-.77l-1.24-1.23a.557.557 0 0 0-.38-.17m-2 1.75L13 19.94V22h2.06l6.06-6.07M20 4H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h7v-.89l8.24-8.22c.47-.49 1.12-.76 1.8-.76.34 0 .68.06 1 .19V6c0-1.12-.92-2-2.04-2m0 4-8 5-8-5V6l8 5 8-5"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": ".", "features": ["header.autohide", "toc.integrate", "content.tabs.link"], "translations": {"clipboard.copy": "C\u00f2pia al porta-retalls", "clipboard.copied": "Copiat al porta-retalls", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Cerca", "search.result.placeholder": "Escriu per a comen\u00e7ar a cercar", "search.result.none": "Cap document coincideix", "search.result.one": "1 document coincident", "search.result.other": "# documents coincidents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "assets/javascripts/workers/search.bd0b6b67.min.js"}</script>
    
    
      <script src="assets/javascripts/bundle.467223ff.min.js"></script>
      
    
  </body>
</html>