
<!doctype html>
<html lang="es" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="canonical" href="https://aitor-medrano.github.io/dwes2122/05herramientas.html">
      
      <link rel="icon" href="imagenes/favicon.png">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-7.3.6">
    
    
      
        <title>5.- Herramientas Web - Desarrollo Web en Entorno Servidor</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.a57b2b03.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.3f5d1f46.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
    
      

  


  

  


  <script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-X6D0LR7TC8"),document.addEventListener("DOMContentLoaded",function(){"undefined"!=typeof location$&&location$.subscribe(function(t){gtag("config","G-X6D0LR7TC8",{page_path:t.pathname})})})</script>
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-X6D0LR7TC8"></script>


    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="light-blue" data-md-color-accent="teal">
  
    
    <script>function __prefix(e){return new URL(".",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
      <script>var palette=__get("__palette");if(null!==palette&&"object"==typeof palette.color)for(var key in palette.color)document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#herramientas" class="md-skip">
          Saltar a contenido
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Cabecera">
    <a href="index.html" title="Desarrollo Web en Entorno Servidor" class="md-header__button md-logo" aria-label="Desarrollo Web en Entorno Servidor" data-md-component="logo">
      
  <img src="imagenes/logofp.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Desarrollo Web en Entorno Servidor
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              5.- Herramientas Web
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="light-blue" data-md-color-accent="teal"  aria-label="Cambiar a modo noche"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Cambiar a modo noche" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
            </label>
          
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="light-blue" data-md-color-accent="teal"  aria-label="Cambiar a modo día"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Cambiar a modo día" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Búsqueda" placeholder="Búsqueda" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Limpiar" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Inicializando búsqueda
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navegación" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="index.html" title="Desarrollo Web en Entorno Servidor" class="md-nav__button md-logo" aria-label="Desarrollo Web en Entorno Servidor" data-md-component="logo">
      
  <img src="imagenes/logofp.png" alt="logo">

    </a>
    Desarrollo Web en Entorno Servidor
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="index.html" class="md-nav__link">
        Inicio
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="01arquitecturas.html" class="md-nav__link">
        1.- Arquitecturas Web
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="02php.html" class="md-nav__link">
        2.- El lenguaje PHP
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="03phpoo.html" class="md-nav__link">
        3.- PHP Orientado a Objetos
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="04web.html" class="md-nav__link">
        4.- Programación Web
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          5.- Herramientas Web
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="05herramientas.html" class="md-nav__link md-nav__link--active">
        5.- Herramientas Web
      </a>
      
        


<nav class="md-nav md-nav--secondary" aria-label="Tabla de contenidos">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Tabla de contenidos
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#composer" class="md-nav__link">
    Composer
  </a>
  
    <nav class="md-nav" aria-label="Composer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#instalacion" class="md-nav__link">
    Instalación
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#primeros-pasos" class="md-nav__link">
    Primeros pasos
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#actualizar-librerias" class="md-nav__link">
    Actualizar librerías
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#autoloadphp" class="md-nav__link">
    autoload.php
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#monolog" class="md-nav__link">
    Monolog
  </a>
  
    <nav class="md-nav" aria-label="Monolog">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#niveles" class="md-nav__link">
    Niveles
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hola-monolog" class="md-nav__link">
    Hola Monolog
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#funcionamiento" class="md-nav__link">
    Funcionamiento
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#manejadores" class="md-nav__link">
    Manejadores
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#canales" class="md-nav__link">
    Canales
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procesadores" class="md-nav__link">
    Procesadores
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formateadores" class="md-nav__link">
    Formateadores
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#uso-de-factorias" class="md-nav__link">
    Uso de Factorías
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#documentacion-con-phpdocumentor" class="md-nav__link">
    Documentación con phpDocumentor
  </a>
  
    <nav class="md-nav" aria-label="Documentación con phpDocumentor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#instalacion-como-binario" class="md-nav__link">
    Instalación como binario
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#uso-en-docker" class="md-nav__link">
    Uso en Docker
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#docblock" class="md-nav__link">
    DocBlock
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#documentando-el-codigo" class="md-nav__link">
    Documentando el código
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#web-scraping" class="md-nav__link">
    Web Scraping
  </a>
  
    <nav class="md-nav" aria-label="Web Scraping">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#goutte" class="md-nav__link">
    Goutte
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#goutte-con-selectores-css" class="md-nav__link">
    Goutte con selectores CSS
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crawler" class="md-nav__link">
    Crawler
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pruebas-con-phpunit" class="md-nav__link">
    Pruebas con PHPUnit
  </a>
  
    <nav class="md-nav" aria-label="Pruebas con PHPUnit">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#puesta-en-marcha" class="md-nav__link">
    Puesta en marcha
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#disenando-pruebas" class="md-nav__link">
    Diseñando pruebas
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aserciones" class="md-nav__link">
    Aserciones
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#comparando-la-salida" class="md-nav__link">
    Comparando la salida
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#proveedores-de-datos" class="md-nav__link">
    Proveedores de datos
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#probando-excepciones" class="md-nav__link">
    Probando excepciones
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobertura-de-codigo" class="md-nav__link">
    Cobertura de código
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#referencias" class="md-nav__link">
    Referencias
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#actividades" class="md-nav__link">
    Actividades
  </a>
  
    <nav class="md-nav" aria-label="Actividades">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#monolog_1" class="md-nav__link">
    Monolog
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#proyecto-videoclub-iv" class="md-nav__link">
    Proyecto Videoclub IV
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#phpdocumentor" class="md-nav__link">
    phpDocumentor
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#web-scraping_1" class="md-nav__link">
    Web Scraping
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#phpunit" class="md-nav__link">
    phpUnit
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#proyecto-videoclub-v" class="md-nav__link">
    Proyecto Videoclub V
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ampliacion" class="md-nav__link">
    Ampliación
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="06accesoDatos.html" class="md-nav__link">
        6.- Acceso a Datos
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="07frameworks.html" class="md-nav__link">
        7.- Frameworks PHP - Laravel
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="09rest.html" class="md-nav__link">
        8.- Servicios REST
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="herramientas">Herramientas<a class="headerlink" href="#herramientas" title="Permanent link">&para;</a></h1>
<details class="abstract"><summary>Duración y criterios de evaluación</summary><p>Duración estimada: 16 sesiones</p>
<hr />
<table>
<thead>
<tr>
<th>Resultado de aprendizaje</th>
<th>Criterios de evaluación</th>
</tr>
</thead>
<tbody>
<tr>
<td>4.- Desarrolla aplicaciones Web embebidas en lenguajes de marcas analizando e incorporando funcionalidades según especificaciones.</td>
<td>g) Se han utilizado herramientas y entornos para facilitar la programación, prueba y depuración del código.</td>
</tr>
</tbody>
</table>
</details>
<p>En esta unidad vamos a estudiar algunas de las herramientas más utilizadas en PHP.</p>
<h2 id="composer">Composer<a class="headerlink" href="#composer" title="Permanent link">&para;</a></h2>
<figure style="float: right;">
    <img src="imagenes/05/logo-composer.png" width="200">
    <figcaption>Logo Composer</figcaption>
</figure>

<p>Herramienta por excelencia en PHP para la gestión de librerías y dependencias, de manera que instala y las actualiza asegurando que todo el equipo de desarrollo tiene el mismo entorno y versiones. Además, ofrece <em>autoloading</em> de nuestro código, de manera que no tengamos que hacerlo nosotros "a mano".</p>
<p>Está escrito en PHP, y podéis consultar toda su documentación en <a href="https://getcomposer.org/">https://getcomposer.org/</a>.</p>
<p>Utiliza <a href="https://packagist.org/"><em>Packagist</em></a> como repositorio de librerías.</p>
<p>Funcionalmente, es similar a Maven (Java) / npm (JS).</p>
<h3 id="instalacion">Instalación<a class="headerlink" href="#instalacion" title="Permanent link">&para;</a></h3>
<p>Si estamos usando XAMPP, hemos de instalar <em>Composer</em> en el propio sistema operativo. Se recomienda seguir las <a href="https://getcomposer.org/doc/00-intro.md">instrucciones oficiales</a> según el sistema operativo a emplear.</p>
<p>En cambio, si usamos <em>Docker</em>, necesitamos modificar la configuración de nuestro contenedor. En nuestro caso, hemos decidido modificar el archivo <code>Dockerfile</code> y añadir el siguiente comando:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">COPY</span> --from<span class="o">=</span>composer:2.0 /usr/bin/composer /usr/local/bin/composer
</code></pre></div>
<p>Para facilitar el trabajo, hemos creado una <a href="recursos/plantilla-APC.zip">plantilla ya preparada</a>.</p>
<p>Es importante que dentro del contenedor comprobemos que tenemos la v2:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>composer -V
</code></pre></div>
<h3 id="primeros-pasos">Primeros pasos<a class="headerlink" href="#primeros-pasos" title="Permanent link">&para;</a></h3>
<p>Cuando creemos un proyecto por primera vez, hemos de inicializar el repositorio. Para ello, ejecutaremos el comando <code>composer init</code> donde:</p>
<ul>
<li>Configuramos el nombre del paquete, descripción, autor (nombre <email>), tipo de paquete (project), etc...</li>
<li>Definimos las dependencias del proyecto (<code>require</code>) y las de desarrollo (<code>require-dev</code>) de manera interactiva.<ul>
<li>En las de desarrollo se indica aquellas que no se instalarán en el entorno de producción, por ejemplo, las librerías de pruebas.</li>
</ul>
</li>
</ul>
<p>Tras su configuración, se creará automáticamente el archivo <code>composer.json</code> con los datos introducidos y descarga las librerías en la carpeta <code>vendor</code>. La instalación de las librerías siempre se realiza de manera local para cada proyecto.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="p">{</span>
<span class="linenos" data-linenos=" 2 "></span>    <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;dwes/log&quot;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 3 "></span>    <span class="nt">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Pruebas con Monolog&quot;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 4 "></span>    <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;project&quot;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 5 "></span>    <span class="nt">&quot;require&quot;</span><span class="p">:</span> <span class="p">{</span>
<span class="linenos" data-linenos=" 6 "></span>        <span class="nt">&quot;monolog/monolog&quot;</span><span class="p">:</span> <span class="s2">&quot;^2.1&quot;</span>
<span class="linenos" data-linenos=" 7 "></span>    <span class="p">},</span>
<span class="linenos" data-linenos=" 8 "></span>    <span class="nt">&quot;license&quot;</span><span class="p">:</span> <span class="s2">&quot;MIT&quot;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 9 "></span>    <span class="nt">&quot;authors&quot;</span><span class="p">:</span> <span class="p">[</span>
<span class="linenos" data-linenos="10 "></span>        <span class="p">{</span>
<span class="linenos" data-linenos="11 "></span>            <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Aitor Medrano&quot;</span><span class="p">,</span>
<span class="linenos" data-linenos="12 "></span>            <span class="nt">&quot;email&quot;</span><span class="p">:</span> <span class="s2">&quot;a.medrano@edu.gva.es&quot;</span>
<span class="linenos" data-linenos="13 "></span>        <span class="p">}</span>
<span class="linenos" data-linenos="14 "></span>    <span class="p">]</span>
<span class="linenos" data-linenos="15 "></span><span class="p">}</span>
</code></pre></div>
<p>A la hora de indicar cada librería introduciremos:</p>
<ul>
<li>el nombre de la librería, compuesta tanto por el creador o "vendor", como por el nombre del proyecto. Ejemplos: <code>monolog/monolog</code> o <code>laravel/installer</code>.</li>
<li>
<p>la versión de cada librería. Tenemos diversas opciones para indicarla:</p>
<ul>
<li>Directamente: 1.4.2</li>
<li>Con comodines: 1.*</li>
<li>A partir de: &gt;= 2.0.3</li>
<li>Sin rotura de cambios: ^1.3.2 // &gt;=1.3.2 &lt;2.0.0</li>
</ul>
</li>
</ul>
<h3 id="actualizar-librerias">Actualizar librerías<a class="headerlink" href="#actualizar-librerias" title="Permanent link">&para;</a></h3>
<p>Podemos definir las dependencias via el archivo <code>composer.json</code> o mediante comandos con el formato <code>composer require vendor/package:version</code>. Por ejemplo, si queremos añadir phpUnit como librería de desarrollo, haremos:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>composer require phpunit/phpunit –dev
</code></pre></div>
<p>Tras añadir nuevas librerías, hemos de actualizar nuestro proyecto:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>composer update
</code></pre></div>
<p>Si creamos el archivo <code>composer.json</code> nosotros directamente sin inicializar el repositorio, hemos de instalar las dependencias:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>composer install
</code></pre></div>
<p>Al hacer este paso (tanto instalar como actualizar), como ya hemos comentado, se descargan las librerías en dentro de la carpeta <code>vendor</code>. Es muy importante añadir esta carpeta al archivo <code>.gitignore</code> para no subirlas a GitHub.</p>
<p>Además se crea el archivo <code>composer.lock</code>, que almacena la versión exacta que se ha instalado de cada librería (este archivo no se toca).</p>
<h3 id="autoloadphp"><code>autoload.php</code><a class="headerlink" href="#autoloadphp" title="Permanent link">&para;</a></h3>
<p><em>Composer</em> crea de forma automática en <code>vendor/autoload.php</code> el código para incluir de forma automática todas las librerías que tengamos configuradas en <code>composer.json</code>.</p>
<p>Para utilizarlo, en la cabecera de nuestro archivos pondremos:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos="2 "></span><span class="k">require</span> <span class="s1">&#39;vendor/autoload.php&#39;</span><span class="p">;</span>
</code></pre></div>
<p>En nuestro caso, de momento sólo lo podremos en los archivos donde probamos las clases</p>
<p>Si queremos que Composer también se encargue de cargar de forma automática nuestras clases de dominio, dentro del archivo <code>composer.json</code>, definiremos la propiedad <code>autoload</code>:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="nt">&quot;autoload&quot;</span><span class="p">:</span> <span class="p">{</span>
<span class="linenos" data-linenos="2 "></span>    <span class="nt">&quot;psr-4&quot;</span><span class="p">:</span> <span class="p">{</span><span class="nt">&quot;Dwes\\&quot;</span><span class="p">:</span> <span class="s2">&quot;app/Dwes&quot;</span><span class="p">}</span>
<span class="linenos" data-linenos="3 "></span><span class="p">},</span>
</code></pre></div>
<p>Posteriormente, hemos de volver a generar el <em>autoload</em> de <em>Composer</em> mediante la opción <code>dump-autoload</code> (o <code>du</code>):</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>composer dump-autoload
</code></pre></div>
<h2 id="monolog">Monolog<a class="headerlink" href="#monolog" title="Permanent link">&para;</a></h2>
<p>Vamos a probar <em>Composer</em> añadiendo la librería de <a href="https://github.com/Seldaek/monolog"><em>Monolog</em></a> a nuestro proyecto. Se trata de un librería para la gestión de logs de nuestras aplicaciones, soportando diferentes niveles (info, warning, etc...), salidas (ficheros, sockets, BBDD, Web Services, email, etc) y formatos (texto plano, HTML, JSON, etc...).</p>
<p>Para ello, incluiremos la librería en nuestro proyecto con:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>composer require monolog/monolog
</code></pre></div>
<p>Monolog 2 requiere al menos PHP 7.2, cumple con el estandar de logging PSR-3, y es la librería empleada por <em>Laravel</em> y <em>Symfony</em> para la gestión de logs.</p>
<div class="admonition info">
<p class="admonition-title">Cuando usar un log</p>
<ul>
<li>Seguir las acciones/movimientos de los usuarios</li>
<li>Registrar las transacciones</li>
<li>Rastrear los errores de usuario</li>
<li>Fallos/avisos a nivel de sistema</li>
<li>Interpretar y coleccionar datos para posterior investigación de patrones</li>
</ul>
</div>
<h3 id="niveles">Niveles<a class="headerlink" href="#niveles" title="Permanent link">&para;</a></h3>
<p>A continuación mostramos los diferentes niveles de menos a más restrictivo:</p>
<ul>
<li><em>debug -100</em>: Información detallada con propósitos de debug. No usar en entornos de producción.</li>
<li><em>info - 200</em>: Eventos interesantes como el inicio de sesión de usuarios.</li>
<li><em>notice - 250</em>: Eventos normales pero significativos.</li>
<li><em>warning - 300</em>: Ocurrencias excepcionales que no llegan a ser error.</li>
<li><em>error - 400</em>: Errores de ejecución que permiten continuar con la ejecución de la aplicación pero que deben ser monitorizados.</li>
<li><em>critical - 500</em>: Situaciones importantes donde se generan excepciones no esperadas o no hay disponible un componente.</li>
<li><em>alert - 550</em>: Se deben tomar medidas inmediatamente.
Caída completa de la web, base de datos no disponible, etc... Además, se suelen enviar mensajes por email.</li>
<li><em>emergency - 600</em>: Es el error más grave e indica que todo el sistema está inutilizable.</li>
</ul>
<h3 id="hola-monolog">Hola Monolog<a class="headerlink" href="#hola-monolog" title="Permanent link">&para;</a></h3>
<p>Por ejemplo, en el archivo <code>pruebaLog.php</code> que colocaríamos en el raíz, primero incluimos el <em>autoload</em>, importamos las clases a utilizar para finalmente usar los métodos de <em>Monolog</em>:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos=" 2 "></span><span class="k">include</span> <span class="no">__DIR__</span> <span class="o">.</span><span class="s2">&quot;/vendor/autoload.php&quot;</span><span class="p">;</span>
<span class="linenos" data-linenos=" 3 "></span>
<span class="linenos" data-linenos=" 4 "></span><span class="k">use</span> <span class="nx">Monolog\Logger</span><span class="p">;</span>
<span class="linenos" data-linenos=" 5 "></span><span class="k">use</span> <span class="nx">Monolog\Handler\StreamHandler</span><span class="p">;</span>
<span class="linenos" data-linenos=" 6 "></span>
<span class="linenos" data-linenos=" 7 "></span><span class="nv">$log</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Logger</span><span class="p">(</span><span class="s2">&quot;MiLogger&quot;</span><span class="p">);</span>
<span class="linenos" data-linenos=" 8 "></span><span class="nv">$log</span><span class="o">-&gt;</span><span class="na">pushHandler</span><span class="p">(</span><span class="k">new</span> <span class="nx">StreamHandler</span><span class="p">(</span><span class="s2">&quot;logs/milog.log&quot;</span><span class="p">,</span> <span class="nx">Logger</span><span class="o">::</span><span class="na">DEBUG</span><span class="p">));</span>
<span class="linenos" data-linenos=" 9 "></span>
<span class="linenos" data-linenos="10 "></span><span class="nv">$log</span><span class="o">-&gt;</span><span class="na">debug</span><span class="p">(</span><span class="s2">&quot;Esto es un mensaje de DEBUG&quot;</span><span class="p">);</span>
<span class="linenos" data-linenos="11 "></span><span class="nv">$log</span><span class="o">-&gt;</span><span class="na">info</span><span class="p">(</span><span class="s2">&quot;Esto es un mensaje de INFO&quot;</span><span class="p">);</span>
<span class="linenos" data-linenos="12 "></span><span class="nv">$log</span><span class="o">-&gt;</span><span class="na">warning</span><span class="p">(</span><span class="s2">&quot;Esto es un mensaje de WARNING&quot;</span><span class="p">);</span>
<span class="linenos" data-linenos="13 "></span><span class="nv">$log</span><span class="o">-&gt;</span><span class="na">error</span><span class="p">(</span><span class="s2">&quot;Esto es un mensaje de ERROR&quot;</span><span class="p">);</span>
<span class="linenos" data-linenos="14 "></span><span class="nv">$log</span><span class="o">-&gt;</span><span class="na">critical</span><span class="p">(</span><span class="s2">&quot;Esto es un mensaje de CRITICAL&quot;</span><span class="p">);</span>
<span class="linenos" data-linenos="15 "></span><span class="nv">$log</span><span class="o">-&gt;</span><span class="na">alert</span><span class="p">(</span><span class="s2">&quot;Esto es un mensaje de ALERT&quot;</span><span class="p">);</span>
</code></pre></div>
<p>En todos los métodos de registro de mensajes (<code>debug</code>, <code>info</code>, ...), además del propio mensaje, le podemos pasar información como el contenido de alguna variable, usuario de la aplicación, etc.. como segundo parámetro dentro de un array, el cual se conoce como <strong>array de contexto</strong>. Es conveniente hacerlo mediante un array asociativo para facilitar la lectura del log.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos="2 "></span><span class="nv">$log</span><span class="o">-&gt;</span><span class="na">warning</span><span class="p">(</span><span class="s2">&quot;Producto no encontrado&quot;</span><span class="p">,</span> <span class="p">[</span><span class="nv">$producto</span><span class="p">]);</span>
<span class="linenos" data-linenos="3 "></span><span class="nv">$log</span><span class="o">-&gt;</span><span class="na">warning</span><span class="p">(</span><span class="s2">&quot;Producto no encontrado&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;datos&quot;</span> <span class="o">=&gt;</span> <span class="nv">$producto</span><span class="p">]);</span>
</code></pre></div>
<h3 id="funcionamiento">Funcionamiento<a class="headerlink" href="#funcionamiento" title="Permanent link">&para;</a></h3>
<p>Cada instancia <code>Logger</code> tiene un nombre de canal y una pila de manejadores (<em>handler</em>).
Cada mensaje que mandamos al log atraviesa la pila de manejadores, y cada uno decide si debe registrar la información, y si se da el caso, finalizar la propagación.
Por ejemplo, un <code>StreamHandler</code> en el fondo de la pila que lo escriba todo en disco, y en el tope añade un <code>MailHandler</code> que envíe un mail sólo cuando haya un error.</p>
<h3 id="manejadores">Manejadores<a class="headerlink" href="#manejadores" title="Permanent link">&para;</a></h3>
<p>Cada manejador tambien tiene un formateador (<code>Formatter</code>). Si no se indica ninguno, se le asigna uno por defecto. El último manejador insertado será el primero en ejecutarse.
Luego se <em>van ejecutando</em> conforme a la pila.</p>
<p>Los manejadores más utilizados son:</p>
<ul>
<li><code>StreamHandler(ruta, nivel)</code></li>
<li><code>RotatingFileHandler(ruta, maxFiles, nivel)</code></li>
<li><code>NativeMailerHandler(para, asunto, desde, nivel)</code></li>
<li><code>FirePHPHandler(nivel)</code></li>
</ul>
<p>Si queremos que los mensajes de la aplicación salgan por el log del servidor, 
en nuestro caso el archivo <code>error.log</code> de <em>Apache</em> utilizaremos como ruta la salida de error:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos="2 "></span><span class="c1">// error.log</span>
<span class="linenos" data-linenos="3 "></span><span class="nv">$log</span><span class="o">-&gt;</span><span class="na">pushHandler</span><span class="p">(</span><span class="k">new</span> <span class="nx">StreamHandler</span><span class="p">(</span><span class="s2">&quot;php://stderr&quot;</span><span class="p">,</span> <span class="nx">Logger</span><span class="o">::</span><span class="na">DEBUG</span><span class="p">));</span>
</code></pre></div>
<div class="admonition tip">
<p class="admonition-title">FirePHP</p>
<p>Por ejemplo, mediante <code>FirePHPHandler</code>, podemos utilizar <code>FirePHP</code>, la cual es una herramienta para hacer debug en la consola de <em>Firefox</em>.
Tras instalar la extensión en Firefox, habilitar las opciones y configurar el <em>Handler</em>, podemos ver los mensajes coloreados con sus datos:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos="2 "></span><span class="nv">$log</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Logger</span><span class="p">(</span><span class="s2">&quot;MiFirePHPLogger&quot;</span><span class="p">);</span>
<span class="linenos" data-linenos="3 "></span><span class="nv">$log</span><span class="o">-&gt;</span><span class="na">pushHandler</span><span class="p">(</span><span class="k">new</span> <span class="nx">FirePHPHandler</span><span class="p">(</span><span class="nx">Logger</span><span class="o">::</span><span class="na">INFO</span><span class="p">));</span>
<span class="linenos" data-linenos="4 "></span>
<span class="linenos" data-linenos="5 "></span><span class="nv">$datos</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;real&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;Bruce Wayne&quot;</span><span class="p">,</span> <span class="s2">&quot;personaje&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;Batman&quot;</span><span class="p">];</span>
<span class="linenos" data-linenos="6 "></span><span class="nv">$log</span><span class="o">-&gt;</span><span class="na">debug</span><span class="p">(</span><span class="s2">&quot;Esto es un mensaje de DEBUG&quot;</span><span class="p">,</span> <span class="nv">$datos</span><span class="p">);</span>
<span class="linenos" data-linenos="7 "></span><span class="nv">$log</span><span class="o">-&gt;</span><span class="na">info</span><span class="p">(</span><span class="s2">&quot;Esto es un mensaje de INFO&quot;</span><span class="p">,</span> <span class="nv">$datos</span><span class="p">);</span>
<span class="linenos" data-linenos="8 "></span><span class="nv">$log</span><span class="o">-&gt;</span><span class="na">warning</span><span class="p">(</span><span class="s2">&quot;Esto es un mensaje de WARNING&quot;</span><span class="p">,</span> <span class="nv">$datos</span><span class="p">);</span>
<span class="linenos" data-linenos="9 "></span><span class="c1">// ...</span>
</code></pre></div>
<p><figure style="align: center;">
    <img src="imagenes/05/firePhp.png">
    <figcaption>Ejemplo de uso de FirePHP</figcaption>
</figure></p>
</div>
<h3 id="canales">Canales<a class="headerlink" href="#canales" title="Permanent link">&para;</a></h3>
<p>Se les asigna al crear el <code>Logger</code>. En grandes aplicaciones, se crea un canal por cada subsistema: ventas, contabilidad, almacén.
No es una buena práctica usar el nombre de la clase como canal, esto se hace con un <em>procesador</em>.</p>
<p>Para su uso, es recomiendo asignar el log a una propiedad privada a Logger, y posteriormente, en el constructor de la clase, asignar el canal, manejadores y formato.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos="2 "></span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">log</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Logger</span><span class="p">(</span><span class="s2">&quot;MiApp&quot;</span><span class="p">);</span>
<span class="linenos" data-linenos="3 "></span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">log</span><span class="o">-&gt;</span><span class="na">pushHandler</span><span class="p">(</span><span class="k">new</span> <span class="nx">StreamHandler</span><span class="p">(</span><span class="s2">&quot;logs/milog.log&quot;</span><span class="p">,</span> <span class="nx">Logger</span><span class="o">::</span><span class="na">DEBUG</span><span class="p">));</span>
<span class="linenos" data-linenos="4 "></span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">log</span><span class="o">-&gt;</span><span class="na">pushHandler</span><span class="p">(</span><span class="k">new</span> <span class="nx">FirePHPHandler</span><span class="p">(</span><span class="nx">Logger</span><span class="o">::</span><span class="na">DEBUG</span><span class="p">));</span>
</code></pre></div>
<p>Y dentro de los métodos para escribir en el log:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos="2 "></span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">log</span><span class="o">-&gt;</span><span class="na">warning</span><span class="p">(</span><span class="s2">&quot;Producto no encontrado&quot;</span><span class="p">,</span> <span class="p">[</span><span class="nv">$producto</span><span class="p">]);</span>
</code></pre></div>
<h3 id="procesadores">Procesadores<a class="headerlink" href="#procesadores" title="Permanent link">&para;</a></h3>
<p>Los procesadores permiten añadir información a los mensajes. Para ello, se apilan después de cada manejador mediante el método <code>pushProcessor($procesador)</code>.</p>
<p>Algunos procesadores conocidos son <code>IntrospectionProcessor</code> (muestran la linea, fichero, clase y metodo desde el que se invoca el log), <code>WebProcessor</code> (añade la URI, método e IP) o <code>GitProcessor</code> (añade la rama y el commit).</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1">PHP</label><label for="__tabbed_1_2">Consola en formato texto</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos="2 "></span><span class="nv">$log</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Logger</span><span class="p">(</span><span class="s2">&quot;MiLogger&quot;</span><span class="p">);</span>
<span class="linenos" data-linenos="3 "></span><span class="nv">$log</span><span class="o">-&gt;</span><span class="na">pushHandler</span><span class="p">(</span><span class="k">new</span> <span class="nx">RotatingFileHandler</span><span class="p">(</span><span class="s2">&quot;logs/milog.log&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">Logger</span><span class="o">::</span><span class="na">DEBUG</span><span class="p">));</span>
<span class="linenos" data-linenos="4 "></span><span class="nv">$log</span><span class="o">-&gt;</span><span class="na">pushProcessor</span><span class="p">(</span><span class="k">new</span> <span class="nx">IntrospectionProcessor</span><span class="p">());</span>
<span class="linenos" data-linenos="5 "></span><span class="nv">$log</span><span class="o">-&gt;</span><span class="na">pushHandler</span><span class="p">(</span><span class="k">new</span> <span class="nx">StreamHandler</span><span class="p">(</span><span class="s2">&quot;php://stderr&quot;</span><span class="p">,</span> <span class="nx">Logger</span><span class="o">::</span><span class="na">WARNING</span><span class="p">));</span>
<span class="linenos" data-linenos="6 "></span><span class="c1">// no usa Introspection pq lo hemos apilado después, le asigno otro</span>
<span class="linenos" data-linenos="7 "></span><span class="nv">$log</span><span class="o">-&gt;</span><span class="na">pushProcessor</span><span class="p">(</span><span class="k">new</span> <span class="nx">WebProcessor</span><span class="p">());</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>[2020-11-26T13:35:31.076138+01:00] MiLogger.DEBUG: Esto es un mensaje de DEBUG [] {&quot;file&quot;:&quot;C:\\xampp\\htdocs\\log\\procesador.php&quot;,&quot;line&quot;:12,&quot;class&quot;:null,&quot;function&quot;:null}
<span class="linenos" data-linenos="2 "></span>[2020-11-26T13:35:31.078344+01:00] MiLogger.INFO: Esto es un mensaje de INFO [] {&quot;file&quot;:&quot;C:\\xampp\\htdocs\\log\\procesador.php&quot;,&quot;line&quot;:13,&quot;class&quot;:null,&quot;function&quot;:null}
</code></pre></div>
</div>
</div>
</div>
<h3 id="formateadores">Formateadores<a class="headerlink" href="#formateadores" title="Permanent link">&para;</a></h3>
<p>Se asocian a los manejadores con <code>setFormatter</code>. Los formateadores más utilizados son <code>LineFormatter</code>, <code>HtmlFormatter</code> o <code>JsonFormatter</code>.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="2:2"><input checked="checked" id="__tabbed_2_1" name="__tabbed_2" type="radio" /><input id="__tabbed_2_2" name="__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="__tabbed_2_1">PHP</label><label for="__tabbed_2_2">Consola en JSON</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos="2 "></span><span class="nv">$log</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Logger</span><span class="p">(</span><span class="s2">&quot;MiLogger&quot;</span><span class="p">);</span>
<span class="linenos" data-linenos="3 "></span><span class="nv">$rfh</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">RotatingFileHandler</span><span class="p">(</span><span class="s2">&quot;logs/milog.log&quot;</span><span class="p">,</span> <span class="nx">Logger</span><span class="o">::</span><span class="na">DEBUG</span><span class="p">);</span>
<span class="linenos" data-linenos="4 "></span><span class="nv">$rfh</span><span class="o">-&gt;</span><span class="na">setFormatter</span><span class="p">(</span><span class="k">new</span> <span class="nx">JsonFormatter</span><span class="p">());</span>
<span class="linenos" data-linenos="5 "></span><span class="nv">$log</span><span class="o">-&gt;</span><span class="na">pushHandler</span><span class="p">(</span><span class="nv">$rfh</span><span class="p">);</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="p">{</span><span class="nt">&quot;message&quot;</span><span class="p">:</span><span class="s2">&quot;Esto es un mensaje de DEBUG&quot;</span><span class="p">,</span><span class="nt">&quot;context&quot;</span><span class="p">:{},</span><span class="nt">&quot;level&quot;</span><span class="p">:</span><span class="mi">100</span><span class="p">,</span><span class="nt">&quot;level_name&quot;</span><span class="p">:</span><span class="s2">&quot;DEBUG&quot;</span><span class="p">,</span><span class="nt">&quot;channel&quot;</span><span class="p">:</span><span class="s2">&quot;MiLogger&quot;</span><span class="p">,</span><span class="nt">&quot;datetime&quot;</span><span class="p">:</span><span class="s2">&quot;2020-11-27T15:36:52.747211+01:00&quot;</span><span class="p">,</span><span class="nt">&quot;extra&quot;</span><span class="p">:{}}</span>
<span class="linenos" data-linenos="2 "></span><span class="p">{</span><span class="nt">&quot;message&quot;</span><span class="p">:</span><span class="s2">&quot;Esto es un mensaje de INFO&quot;</span><span class="p">,</span><span class="nt">&quot;context&quot;</span><span class="p">:{},</span><span class="nt">&quot;level&quot;</span><span class="p">:</span><span class="mi">200</span><span class="p">,</span><span class="nt">&quot;level_name&quot;</span><span class="p">:</span><span class="s2">&quot;INFO&quot;</span><span class="p">,</span><span class="nt">&quot;channel&quot;</span><span class="p">:</span><span class="s2">&quot;MiLogger&quot;</span><span class="p">,</span><span class="nt">&quot;datetime&quot;</span><span class="p">:</span><span class="s2">&quot;2020-11-27T15:36:52.747538+01:00&quot;</span><span class="p">,</span><span class="nt">&quot;extra&quot;</span><span class="p">:{}}</span>
</code></pre></div>
</div>
</div>
</div>
<div class="admonition tip">
<p class="admonition-title">Más información</p>
<p>Más información sobre manejadores, formateadores y procesadores en <a href="https://github.com/Seldaek/monolog/blob/master/doc/02-handlers-formatters-processors.md">https://github.com/Seldaek/monolog/blob/master/doc/02-handlers-formatters-processors.md</a></p>
</div>
<h3 id="uso-de-factorias">Uso de Factorías<a class="headerlink" href="#uso-de-factorias" title="Permanent link">&para;</a></h3>
<p>En vez de instanciar un log en cada clase, es conveniente crear una factoría (por ejemplo, siguiendo la idea del patrón de diseño <a href="https://refactoring.guru/es/design-patterns/factory-method"><em>Factory Method</em></a>).</p>
<p>Para el siguiente ejemplo, vamos a suponer que creamos la factoría en el <em>namespace</em> <code>Dwes\Ejemplos\Util</code>.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos=" 2 "></span><span class="k">namespace</span> <span class="nx">Dwes\Ejemplos\Util</span>
<span class="linenos" data-linenos=" 3 "></span>
<span class="linenos" data-linenos=" 4 "></span><span class="k">use</span> <span class="nx">Monolog\Logger</span><span class="p">;</span>
<span class="linenos" data-linenos=" 5 "></span><span class="k">use</span> <span class="nx">Monolog\Handler\StreamHandler</span><span class="p">;</span>
<span class="linenos" data-linenos=" 6 "></span>
<span class="linenos" data-linenos=" 7 "></span><span class="k">class</span> <span class="nc">LogFactory</span> <span class="p">{</span>
<span class="linenos" data-linenos=" 8 "></span>
<span class="linenos" data-linenos=" 9 "></span>    <span class="k">public</span> <span class="k">static</span> <span class="k">function</span> <span class="nf">getLogger</span><span class="p">(</span><span class="nx">string</span> <span class="nv">$canal</span> <span class="o">=</span> <span class="s2">&quot;miApp&quot;</span><span class="p">)</span> <span class="o">:</span> <span class="nx">Logger</span> <span class="p">{</span>
<span class="linenos" data-linenos="10 "></span>        <span class="nv">$log</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Logger</span><span class="p">(</span><span class="nv">$canal</span><span class="p">);</span>
<span class="linenos" data-linenos="11 "></span>        <span class="nv">$log</span><span class="o">-&gt;</span><span class="na">pushHandler</span><span class="p">(</span><span class="k">new</span> <span class="nx">StreamHandler</span><span class="p">(</span><span class="s2">&quot;logs/miApp.log&quot;</span><span class="p">,</span> <span class="nx">Logger</span><span class="o">::</span><span class="na">DEBUG</span><span class="p">));</span>
<span class="linenos" data-linenos="12 "></span>
<span class="linenos" data-linenos="13 "></span>        <span class="k">return</span> <span class="nv">$log</span><span class="p">;</span>
<span class="linenos" data-linenos="14 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="15 "></span><span class="p">}</span>
</code></pre></div>
<p>Si en vez de devolver un <code>Monolog\Logger</code> utilizamos el interfaz de PSR, si en el futuro cambiamos la implementación del log, no tendremos que modificar nuestro codigo. Así pues, la factoría ahora devolverá <code>Psr\Log\LoggerInterface</code>:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos=" 2 "></span><span class="k">namespace</span> <span class="nx">Dwes\Ejemplos\Util</span>
<span class="linenos" data-linenos=" 3 "></span>
<span class="linenos" data-linenos=" 4 "></span><span class="k">use</span> <span class="nx">Monolog\Handler\StreamHandler</span><span class="p">;</span>
<span class="linenos" data-linenos=" 5 "></span><span class="k">use</span> <span class="nx">Monolog\Logger</span><span class="p">;</span>
<span class="linenos" data-linenos=" 6 "></span><span class="k">use</span> <span class="nx">Psr\Log\LoggerInterface</span><span class="p">;</span>
<span class="linenos" data-linenos=" 7 "></span>
<span class="linenos" data-linenos=" 8 "></span><span class="k">class</span> <span class="nc">LogFactory</span> <span class="p">{</span>
<span class="linenos" data-linenos=" 9 "></span>
<span class="linenos" data-linenos="10 "></span>    <span class="k">public</span> <span class="k">static</span> <span class="k">function</span> <span class="nf">getLogger</span><span class="p">(</span><span class="nx">string</span> <span class="nv">$canal</span> <span class="o">=</span> <span class="s2">&quot;miApp&quot;</span><span class="p">)</span> <span class="o">:</span> <span class="nx">LoggerInterface</span> <span class="p">{</span>
<span class="linenos" data-linenos="11 "></span>        <span class="nv">$log</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Logger</span><span class="p">(</span><span class="nv">$canal</span><span class="p">);</span>
<span class="linenos" data-linenos="12 "></span>        <span class="nv">$log</span><span class="o">-&gt;</span><span class="na">pushHandler</span><span class="p">(</span><span class="k">new</span> <span class="nx">StreamHandler</span><span class="p">(</span><span class="s2">&quot;log/miApp.log&quot;</span><span class="p">,</span> <span class="nx">Logger</span><span class="o">::</span><span class="na">DEBUG</span><span class="p">));</span>
<span class="linenos" data-linenos="13 "></span>
<span class="linenos" data-linenos="14 "></span>        <span class="k">return</span> <span class="nv">$log</span><span class="p">;</span>
<span class="linenos" data-linenos="15 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="16 "></span><span class="p">}</span>
</code></pre></div>
<p>Finalmente, para utilizar la factoría, sólo cambiamos el código que teníamos en el constructor de las clases que usan el log, quedando algo asi:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos=" 2 "></span>
<span class="linenos" data-linenos=" 3 "></span><span class="k">namespace</span> <span class="nx">Dwes\Ejemplos\Model</span><span class="p">;</span>
<span class="linenos" data-linenos=" 4 "></span>
<span class="linenos" data-linenos=" 5 "></span><span class="k">use</span> <span class="nx">Dwes\Ejemplos\Util\LogFactory</span><span class="p">;</span>
<span class="linenos" data-linenos=" 6 "></span><span class="k">use</span> <span class="nx">Monolog\Logger</span><span class="p">;</span>
<span class="linenos" data-linenos=" 7 "></span>
<span class="linenos" data-linenos=" 8 "></span><span class="k">class</span> <span class="nc">Cliente</span> <span class="p">{</span>
<span class="linenos" data-linenos=" 9 "></span>
<span class="linenos" data-linenos="10 "></span>    <span class="k">private</span> <span class="nv">$codigo</span><span class="p">;</span> 
<span class="linenos" data-linenos="11 "></span>
<span class="linenos" data-linenos="12 "></span>    <span class="k">private</span> <span class="nx">Logger</span> <span class="nv">$log</span><span class="p">;</span>
<span class="linenos" data-linenos="13 "></span>
<span class="linenos" data-linenos="14 "></span>    <span class="k">function</span> <span class="fm">__construct</span><span class="p">(</span><span class="nv">$codigo</span><span class="p">){</span> 
<span class="linenos" data-linenos="15 "></span>        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">codigo</span><span class="o">=</span><span class="nv">$codigo</span><span class="p">;</span> 
<span class="linenos" data-linenos="16 "></span>
<span class="linenos" data-linenos="17 "></span>        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">log</span> <span class="o">=</span> <span class="nx">LogFactory</span><span class="o">::</span><span class="na">getLogger</span><span class="p">();</span>
<span class="linenos" data-linenos="18 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="19 "></span>
<span class="linenos" data-linenos="20 "></span>    <span class="c1">/// ... resto del código</span>
<span class="linenos" data-linenos="21 "></span><span class="p">}</span>
</code></pre></div>
<h2 id="documentacion-con-phpdocumentor">Documentación con <em>phpDocumentor</em><a class="headerlink" href="#documentacion-con-phpdocumentor" title="Permanent link">&para;</a></h2>
<p><a href="https://www.phpdoc.org/">phpDocumentor</a> es la herramienta <em>de facto</em> para documentar el código PHP. Es similar en propósito y funcionamiento a <em>Javadoc</em>.</p>
<p>Así pues, es un herramienta que facilita la documentación del código PHP, creando un sitio web con el API de la aplicación.</p>
<p>Se basa en el uso de anotaciones sobre los docblocks. Para ponerlo en marcha, en nuestro caso nos decantaremos por utilizar la imagen que ya existe de Docker.</p>
<h3 id="instalacion-como-binario">Instalación como binario<a class="headerlink" href="#instalacion-como-binario" title="Permanent link">&para;</a></h3>
<p>Otra opción es seguir los pasos que recomienda la <a href="https://www.phpdoc.org">documentación oficial</a> para instalarlo como un ejecutable, que son descargar el archivo <code>phpDocumentor.phar</code> y darles permisos de ejecución:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>wget https://phpdoc.org/phpDocumentor.phar
<span class="linenos" data-linenos="2 "></span>chmod +x phpDocumentor.phar
<span class="linenos" data-linenos="3 "></span>mv phpDocumentor.phar /usr/local/bin/phpdoc
<span class="linenos" data-linenos="4 "></span>phpdoc --version
</code></pre></div>
<p>Una vez instalado, desde el raíz del proyecto, suponiendo que tenemos nuestro código dentro de <code>app</code> y que queremos la documentación dentro de <code>docs/api</code> ejecutamos:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>phpdoc -d ./app -t docs/api
</code></pre></div>
<h3 id="uso-en-docker">Uso en Docker<a class="headerlink" href="#uso-en-docker" title="Permanent link">&para;</a></h3>
<p>En el caso de usar <em>Docker</em>, usaremos el siguiente comando para ejecutarlo (crea el contenedor, ejecuta el comando que le pidamos, y automáticamente lo borra):</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>docker run --rm -v <span class="s2">&quot;</span><span class="k">$(</span><span class="nb">pwd</span><span class="k">)</span><span class="s2">&quot;</span>:/data phpdoc/phpdoc:3
</code></pre></div>
<p>A dicho comando, le adjuntaremos los diferentes parámetros que admite phpDocumentor, por ejemplo:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="c1"># Muestra la versión</span>
<span class="linenos" data-linenos="2 "></span>docker run --rm -v <span class="s2">&quot;</span><span class="k">$(</span><span class="nb">pwd</span><span class="k">)</span><span class="s2">&quot;</span>:/data phpdoc/phpdoc:3 --version
<span class="linenos" data-linenos="3 "></span><span class="c1"># Mediante -d se indica el origen a parsear</span>
<span class="linenos" data-linenos="4 "></span><span class="c1"># Mediante -t se indica el destino donde generar la documentación</span>
<span class="linenos" data-linenos="5 "></span>docker run --rm -v <span class="s2">&quot;</span><span class="k">$(</span><span class="nb">pwd</span><span class="k">)</span><span class="s2">&quot;</span>:/data phpdoc/phpdoc:3 -d ./src/app -t ./docs/api
</code></pre></div>
<h3 id="docblock">DocBlock<a class="headerlink" href="#docblock" title="Permanent link">&para;</a></h3>
<p>Un <em>docblock</em> es el bloque de código que se coloca encima de un recurso. Su formato es:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos=" 2 "></span><span class="sd">/**</span>
<span class="linenos" data-linenos=" 3 "></span><span class="sd">* *Sumario*, una sola línea</span>
<span class="linenos" data-linenos=" 4 "></span><span class="sd">*</span>
<span class="linenos" data-linenos=" 5 "></span><span class="sd">* *Descripción* que puede utilizar varias líneas</span>
<span class="linenos" data-linenos=" 6 "></span><span class="sd">* y que ofrece detalles del elemento o referencias</span>
<span class="linenos" data-linenos=" 7 "></span><span class="sd">* para ampliar la información</span>
<span class="linenos" data-linenos=" 8 "></span><span class="sd">*</span>
<span class="linenos" data-linenos=" 9 "></span><span class="sd">* @param string $miArgumento con una *descripción* del argumento</span>
<span class="linenos" data-linenos="10 "></span><span class="sd">* que puede usar varias líneas.</span>
<span class="linenos" data-linenos="11 "></span><span class="sd">*</span>
<span class="linenos" data-linenos="12 "></span><span class="sd">* @return void</span>
<span class="linenos" data-linenos="13 "></span><span class="sd">*/</span>
<span class="linenos" data-linenos="14 "></span><span class="k">function</span> <span class="nf">miFuncion</span><span class="p">(</span><span class="nx">tipo</span> <span class="nv">$miArgumento</span><span class="p">)</span>
<span class="linenos" data-linenos="15 "></span><span class="p">{</span>
<span class="linenos" data-linenos="16 "></span><span class="p">}</span>
</code></pre></div>
<h3 id="documentando-el-codigo">Documentando el código<a class="headerlink" href="#documentando-el-codigo" title="Permanent link">&para;</a></h3>
<p>En todos los elementos, ademas del sumario y/o descripción, pondremos:</p>
<ul>
<li>En las clases:<ul>
<li><code>@author</code> nombre <email></li>
<li><code>@package</code> ruta del namespace</li>
</ul>
</li>
<li>En las propiedades:<ul>
<li><code>@var</code> tipo descripción</li>
</ul>
</li>
<li>En los métodos:<ul>
<li><code>@param</code> tipo $nombre descripción</li>
<li><code>@throws</code> ClaseException descripción</li>
<li><code>@return</code> tipo descripción</li>
</ul>
</li>
</ul>
<p>Veámoslo con un ejemplo. Supongamos que tenemos una clase que representa un cliente:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos=" 2 "></span><span class="sd">/**</span>
<span class="linenos" data-linenos=" 3 "></span><span class="sd">* Clase que representa un cliente</span>
<span class="linenos" data-linenos=" 4 "></span><span class="sd">* </span>
<span class="linenos" data-linenos=" 5 "></span><span class="sd">* El cliente se encarga de almacenar los soportes que tiene alquilado,</span>
<span class="linenos" data-linenos=" 6 "></span><span class="sd">* de manera que podemos alquilar y devolver productos mediante las operaciones</span>
<span class="linenos" data-linenos=" 7 "></span><span class="sd">* homónimas.</span>
<span class="linenos" data-linenos=" 8 "></span><span class="sd">* </span>
<span class="linenos" data-linenos=" 9 "></span><span class="sd">* @package Dwes\Videoclub\Model</span>
<span class="linenos" data-linenos="10 "></span><span class="sd">* @author Aitor Medrano &lt;a.medrano@edu.gva.es&gt;</span>
<span class="linenos" data-linenos="11 "></span><span class="sd">*/</span>
<span class="linenos" data-linenos="12 "></span><span class="k">class</span> <span class="nc">Cliente</span> <span class="p">{</span>
<span class="linenos" data-linenos="13 "></span>
<span class="linenos" data-linenos="14 "></span>    <span class="k">public</span> <span class="nx">string</span> <span class="nv">$nombre</span><span class="p">;</span> 
<span class="linenos" data-linenos="15 "></span>    <span class="k">private</span> <span class="nx">string</span> <span class="nv">$numero</span><span class="p">;</span>
<span class="linenos" data-linenos="16 "></span>
<span class="linenos" data-linenos="17 "></span>    <span class="sd">/**</span>
<span class="linenos" data-linenos="18 "></span><span class="sd">    * Colección de soportes alquilados</span>
<span class="linenos" data-linenos="19 "></span><span class="sd">    * @var array&lt;Soporte&gt; </span>
<span class="linenos" data-linenos="20 "></span><span class="sd">    */</span>
<span class="linenos" data-linenos="21 "></span>    <span class="k">private</span> <span class="nv">$soportesAlquilados</span><span class="p">[];</span>
<span class="linenos" data-linenos="22 "></span>
<span class="linenos" data-linenos="23 "></span>    <span class="sd">/**</span>
<span class="linenos" data-linenos="24 "></span><span class="sd">    * Comprueba si el soporte recibido ya lo tiene alquilado el cliente</span>
<span class="linenos" data-linenos="25 "></span><span class="sd">    * @param Soporte $soporte Soporte a comprobar</span>
<span class="linenos" data-linenos="26 "></span><span class="sd">    * @return bool true si lo tiene alquilado</span>
<span class="linenos" data-linenos="27 "></span><span class="sd">    */</span>
<span class="linenos" data-linenos="28 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="nf">tieneAlquilado</span><span class="p">(</span><span class="nx">Soporte</span> <span class="nv">$soporte</span><span class="p">)</span> <span class="o">:</span> <span class="nx">bool</span> <span class="p">{</span> 
<span class="linenos" data-linenos="29 "></span>        <span class="c1">// ...</span>
<span class="linenos" data-linenos="30 "></span>    <span class="p">}</span>
</code></pre></div>
<p>Si generamos la documentación y abrimos con un navegador el archivo <code>docs/api/index.html</code> podremos navegar hasta la clase `Cliente:</p>
<figure style="align: center;">
    <img src="imagenes/05/phpdoc.png">
    <figcaption>phpDocumentor de Cliente</figcaption>
</figure>

<h2 id="web-scraping"><em>Web Scraping</em><a class="headerlink" href="#web-scraping" title="Permanent link">&para;</a></h2>
<p>Consiste en navegar a una página web y extraer información automáticamente, a partir del código HTML generado, y organizar la información pública disponible en Internet.</p>
<p>Esta práctica requiere el uso de una librería que facilite la descarga de la información deseada imitando la interacción de un navegador web. Este "robot" puede acceder a varias páginas simultáneamente.</p>
<div class="admonition question">
<p class="admonition-title">¿Es legal?</p>
<p>Si el sitio web indica que tiene el contenido protegido por derechos de autor o en las normas de acceso via usuario/contraseña nos avisa de su prohibición, estaríamos incurriendo en un delito.
Es recomendable estudiar el archivo <code>robots.txt</code> que se encuentra en el raíz de cada sitio web.
Más información en el artículo <a href="https://ichi.pro/es/el-manual-completo-para-el-web-scraping-legal-y-etico-en-2021-69178542830388">El manual completo para el web scraping legal y ético en 2021</a></p>
</div>
<h3 id="goutte">Goutte<a class="headerlink" href="#goutte" title="Permanent link">&para;</a></h3>
<p><a href="https://github.com/FriendsOfPHP/Goutte">Goutte</a> es un sencillo cliente HTTP para PHP creado específicamente para hacer web scraping. Lo desarrolló el mismo autor del framework <em>Symfony</em> y ofrece un API sencilla para extraer datos de las respuestas HTML/XML de los sitios web.</p>
<p>FIXME: Revisar https://godofredo.ninja/web-scraping-con-php-utilizando-goutte/</p>
<p>Los componentes principales que abstrae <em>Goutte</em> sobre <em>Symfony</em> son:</p>
<ul>
<li><code>BrowserKit</code>: simula el comportamiento de un navegador web.</li>
<li><code>CssSelector</code>: traduce consultas CSS en consultas XPath.</li>
<li><code>DomCrawler</code>: facilita el uso del DOM y XPath.</li>
</ul>
<p>Para poder utilizar <em>Goutte</em> en nuestro proyecto, ejecutaremos el siguiente comando en el terminal:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>composer require fabpot/goutte
</code></pre></div>
<h3 id="goutte-con-selectores-css">Goutte con selectores CSS<a class="headerlink" href="#goutte-con-selectores-css" title="Permanent link">&para;</a></h3>
<p>A continuación vamos a hacer un ejemplo muy sencillo utilizando los selectores CSS, extrayendo información de la web <code>https://books.toscrape.com/</code>, la cual es una página para pruebas que no rechazará nuestras peticiones.</p>
<p>Tras crear un cliente con <em>Goutte</em>, hemos de realizar un petición a una URL. Con la respuesta obtenida, podemos utilizar el método <code>filter</code> para indicarle la ruta CSS que queremos recorrer e iterar sobre los resultados mediante una función anónima. Una vez estamos dentro de un determinado nodo, el método <code>text()</code> nos devolverá el contenido del propio nodo.</p>
<p>En concreto, vamos a meter en un array asociativo el título y el precio de todos los libros de la categoría <em>Classics</em>.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos=" 2 "></span><span class="k">require</span> <span class="s1">&#39;../vendor/autoload.php&#39;</span><span class="p">;</span>
<span class="linenos" data-linenos=" 3 "></span>
<span class="linenos" data-linenos=" 4 "></span><span class="nv">$httpClient</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">\Goutte\Client</span><span class="p">();</span>
<span class="linenos" data-linenos=" 5 "></span><span class="nv">$response</span> <span class="o">=</span> <span class="nv">$httpClient</span><span class="o">-&gt;</span><span class="na">request</span><span class="p">(</span><span class="s1">&#39;GET&#39;</span><span class="p">,</span> <span class="s1">&#39;https://books.toscrape.com/catalogue/category/books/classics_6/index.html&#39;</span><span class="p">);</span>
<span class="linenos" data-linenos=" 6 "></span><span class="c1">// colocamos los precios en un array</span>
<span class="linenos" data-linenos=" 7 "></span><span class="nv">$precios</span> <span class="o">=</span> <span class="p">[];</span>
<span class="linenos" data-linenos=" 8 "></span><span class="nv">$response</span><span class="o">-&gt;</span><span class="na">filter</span><span class="p">(</span><span class="s1">&#39;.row li article div.product_price p.price_color&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">each</span><span class="p">(</span>
<span class="linenos" data-linenos=" 9 "></span>    <span class="c1">// le pasamos $precios por referencia para poder editarla dentro del closure</span>
<span class="linenos" data-linenos="10 "></span>    <span class="k">function</span> <span class="p">(</span><span class="nv">$node</span><span class="p">)</span> <span class="k">use</span> <span class="p">(</span><span class="o">&amp;</span><span class="nv">$precios</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-linenos="11 "></span>        <span class="nv">$precios</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$node</span><span class="o">-&gt;</span><span class="na">text</span><span class="p">();</span>
<span class="linenos" data-linenos="12 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="13 "></span><span class="p">);</span>
<span class="linenos" data-linenos="14 "></span>
<span class="linenos" data-linenos="15 "></span><span class="c1">// colocamos el nombre y el precio en un array asociativo</span>
<span class="linenos" data-linenos="16 "></span><span class="nv">$contadorPrecios</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="linenos" data-linenos="17 "></span><span class="nv">$libros</span> <span class="o">=</span> <span class="p">[];</span>
<span class="linenos" data-linenos="18 "></span><span class="nv">$response</span><span class="o">-&gt;</span><span class="na">filter</span><span class="p">(</span><span class="s1">&#39;.row li article h3 a&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">each</span><span class="p">(</span>
<span class="linenos" data-linenos="19 "></span>    <span class="k">function</span> <span class="p">(</span><span class="nv">$node</span><span class="p">)</span> <span class="k">use</span> <span class="p">(</span><span class="nv">$precios</span><span class="p">,</span> <span class="o">&amp;</span><span class="nv">$contadorPrecios</span><span class="p">,</span> <span class="o">&amp;</span><span class="nv">$libros</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-linenos="20 "></span>        <span class="nv">$libros</span><span class="p">[</span><span class="nv">$node</span><span class="o">-&gt;</span><span class="na">text</span><span class="p">()]</span> <span class="o">=</span> <span class="nv">$precios</span><span class="p">[</span><span class="nv">$contadorPrecios</span><span class="p">];</span>
<span class="linenos" data-linenos="21 "></span>        <span class="nv">$contadorPrecios</span><span class="o">++</span><span class="p">;</span>
<span class="linenos" data-linenos="22 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="23 "></span><span class="p">);</span>
</code></pre></div>
<h3 id="crawler">Crawler<a class="headerlink" href="#crawler" title="Permanent link">&para;</a></h3>
<p>Un caso muy común es obtener la información de una página que tiene los resultados paginados, de manera que vayamos recorriendo los enlaces y accediendo a cada uno de los resultados.</p>
<p>En este caso vamos a coger todos los precios de los libros de fantasía, y vamos a sumarlos:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos=" 2 "></span><span class="k">require</span> <span class="s1">&#39;../vendor/autoload.php&#39;</span><span class="p">;</span>
<span class="linenos" data-linenos=" 3 "></span>
<span class="linenos" data-linenos=" 4 "></span><span class="k">use</span> <span class="nx">Goutte\Client</span><span class="p">;</span>
<span class="linenos" data-linenos=" 5 "></span><span class="k">use</span> <span class="nx">Symfony\Component\HttpClient\HttpClient</span><span class="p">;</span>
<span class="linenos" data-linenos=" 6 "></span>
<span class="linenos" data-linenos=" 7 "></span><span class="nv">$client</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Client</span><span class="p">(</span><span class="nx">HttpClient</span><span class="o">::</span><span class="na">create</span><span class="p">([</span><span class="s1">&#39;timeout&#39;</span> <span class="o">=&gt;</span> <span class="mi">60</span><span class="p">]));</span>
<span class="linenos" data-linenos=" 8 "></span><span class="nv">$crawler</span> <span class="o">=</span> <span class="nv">$client</span><span class="o">-&gt;</span><span class="na">request</span><span class="p">(</span><span class="s1">&#39;GET&#39;</span><span class="p">,</span> <span class="s1">&#39;https://books.toscrape.com/catalogue/category/books/fantasy_19/index.html&#39;</span><span class="p">);</span>
<span class="linenos" data-linenos=" 9 "></span>
<span class="linenos" data-linenos="10 "></span><span class="nv">$salir</span> <span class="o">=</span> <span class="k">false</span><span class="p">;</span>
<span class="linenos" data-linenos="11 "></span>
<span class="linenos" data-linenos="12 "></span><span class="nv">$precios</span> <span class="o">=</span> <span class="p">[];</span>
<span class="linenos" data-linenos="13 "></span><span class="k">while</span> <span class="p">(</span><span class="o">!</span><span class="nv">$salir</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-linenos="14 "></span>    <span class="nv">$crawler</span><span class="o">-&gt;</span><span class="na">filter</span><span class="p">(</span><span class="s1">&#39;.row li article div.product_price p.price_color&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">each</span><span class="p">(</span>
<span class="linenos" data-linenos="15 "></span>        <span class="k">function</span> <span class="p">(</span><span class="nv">$node</span><span class="p">)</span> <span class="k">use</span> <span class="p">(</span><span class="o">&amp;</span><span class="nv">$precios</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-linenos="16 "></span>            <span class="nv">$texto</span> <span class="o">=</span> <span class="nv">$node</span><span class="o">-&gt;</span><span class="na">text</span><span class="p">();</span>
<span class="linenos" data-linenos="17 "></span>            <span class="nv">$cantidad</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$texto</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span> <span class="c1">// Le quitamos las libras ¿2 posiciones?</span>
<span class="linenos" data-linenos="18 "></span>            <span class="nv">$precios</span><span class="p">[]</span> <span class="o">=</span> <span class="nb">floatval</span><span class="p">(</span><span class="nv">$cantidad</span><span class="p">);</span>
<span class="linenos" data-linenos="19 "></span>        <span class="p">}</span>
<span class="linenos" data-linenos="20 "></span>    <span class="p">);</span>
<span class="linenos" data-linenos="21 "></span>
<span class="linenos" data-linenos="22 "></span>    <span class="nv">$enlace</span> <span class="o">=</span> <span class="nv">$crawler</span><span class="o">-&gt;</span><span class="na">selectLink</span><span class="p">(</span><span class="s1">&#39;next&#39;</span><span class="p">);</span>
<span class="linenos" data-linenos="23 "></span>    <span class="k">if</span> <span class="p">(</span><span class="nv">$enlace</span><span class="o">-&gt;</span><span class="na">count</span><span class="p">()</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-linenos="24 "></span>        <span class="c1">// el enlace next existe</span>
<span class="linenos" data-linenos="25 "></span>        <span class="nv">$sigPag</span> <span class="o">=</span> <span class="nv">$crawler</span><span class="o">-&gt;</span><span class="na">selectLink</span><span class="p">(</span><span class="s1">&#39;next&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">link</span><span class="p">();</span>
<span class="linenos" data-linenos="26 "></span>        <span class="nv">$crawler</span> <span class="o">=</span> <span class="nv">$client</span><span class="o">-&gt;</span><span class="na">click</span><span class="p">(</span><span class="nv">$sigPag</span><span class="p">);</span> <span class="c1">// hacemos click</span>
<span class="linenos" data-linenos="27 "></span>    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
<span class="linenos" data-linenos="28 "></span>        <span class="c1">// ya no hay enlace next</span>
<span class="linenos" data-linenos="29 "></span>        <span class="nv">$salir</span> <span class="o">=</span> <span class="k">true</span><span class="p">;</span>
<span class="linenos" data-linenos="30 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="31 "></span><span class="p">}</span>
<span class="linenos" data-linenos="32 "></span>
<span class="linenos" data-linenos="33 "></span><span class="nv">$precioTotal</span> <span class="o">=</span> <span class="nb">array_sum</span><span class="p">(</span><span class="nv">$precios</span><span class="p">);</span>
<span class="linenos" data-linenos="34 "></span><span class="k">echo</span> <span class="nv">$precioTotal</span><span class="p">;</span>
</code></pre></div>
<h2 id="pruebas-con-phpunit">Pruebas con PHPUnit<a class="headerlink" href="#pruebas-con-phpunit" title="Permanent link">&para;</a></h2>
<p>El curso pasado, dentro del módulo de <em>Entornos de Desarrollo</em>, estudiamos la importancia de la realización de pruebas, así como las pruebas unitarias mediante <a href="https://junit.org/junit5/">JUnit</a>.</p>
<figure style="float: right;">
    <img src="imagenes/05/tdd.png" width="300">
    <figcaption>Test Driven Development</figcaption>
</figure>

<p>A día de hoy es de gran importancia seguir una buena metodología de pruebas, siendo el desarrollo dirigido por las pruebas (<em>Test Driven Development</em> / TDD) uno de los enfoques más empleados, el cual consiste en:</p>
<ol>
<li>Escribir el test, y como no hay código implementado, la prueba falle (rojo).</li>
<li>Escribir el código de aplicación para que la prueba funcione (verde).</li>
<li>Refactorizar el código de la aplicación con la ayuda de la prueba para comprobar que no rompemos nada (refactor).</li>
</ol>
<p>En el caso de PHP, la herramienta que se utiliza es <em>PHPUnit</em> (<a href="https://phpunit.de/">https://phpunit.de/</a>), que como su nombre indica, está basada en JUnit. La versión actual es la 9.0</p>
<p>Se recomienda consultar su documentación en <a href="https://phpunit.readthedocs.io/es/latest/index.html">https://phpunit.readthedocs.io/es/latest/index.html</a>.</p>
<h3 id="puesta-en-marcha">Puesta en marcha<a class="headerlink" href="#puesta-en-marcha" title="Permanent link">&para;</a></h3>
<p>Vamos a colocar todas las pruebas en una carpeta <code>tests</code> en el raíz de nuestro proyecto.</p>
<p>En el archivo <code>composer.json</code>, añadimos:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="nt">&quot;require-dev&quot;</span><span class="p">:</span> <span class="p">{</span>
<span class="linenos" data-linenos="2 "></span>    <span class="nt">&quot;phpunit/phpunit&quot;</span><span class="p">:</span> <span class="s2">&quot;^9&quot;</span>
<span class="linenos" data-linenos="3 "></span><span class="p">},</span>
<span class="linenos" data-linenos="4 "></span><span class="nt">&quot;scripts&quot;</span><span class="p">:</span> <span class="p">{</span>
<span class="linenos" data-linenos="5 "></span>    <span class="nt">&quot;test&quot;</span><span class="p">:</span> <span class="s2">&quot;phpunit --testdox --colors tests&quot;</span>
<span class="linenos" data-linenos="6 "></span><span class="p">}</span>
</code></pre></div>
<p>Si quisiéramos añadir la librería desde un comando del terminal, también podríamos ejecutar:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>composer require --dev phpunit/phpunit ^9
</code></pre></div>
<div class="admonition tip">
<p class="admonition-title">Librerías de desarrollo</p>
<p>Las librerías que se colocan en <code>require-dev</code> son las de desarrollo y <em>testing</em>, de manera que no se instalarán en un entorno de producción.</p>
</div>
<p>Como hemos creado un <em>script</em>, podemos lanzar las pruebas mediante:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>composer <span class="nb">test</span>
</code></pre></div>
<p>Vasmos a realizar nuestra primera prueba:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos=" 2 "></span><span class="k">use</span> <span class="nx">PHPUnit\Framework\TestCase</span><span class="p">;</span>
<span class="linenos" data-linenos=" 3 "></span>
<span class="linenos" data-linenos=" 4 "></span><span class="k">class</span> <span class="nc">PilaTest</span> <span class="k">extends</span> <span class="nx">TestCase</span>
<span class="linenos" data-linenos=" 5 "></span><span class="p">{</span>
<span class="linenos" data-linenos=" 6 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="nf">testPushAndPop</span><span class="p">()</span>
<span class="linenos" data-linenos=" 7 "></span>    <span class="p">{</span>
<span class="linenos" data-linenos=" 8 "></span>        <span class="nv">$pila</span> <span class="o">=</span> <span class="p">[];</span>
<span class="linenos" data-linenos=" 9 "></span>        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">assertSame</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">count</span><span class="p">(</span><span class="nv">$pila</span><span class="p">));</span>
<span class="linenos" data-linenos="10 "></span>
<span class="linenos" data-linenos="11 "></span>        <span class="nb">array_push</span><span class="p">(</span><span class="nv">$pila</span><span class="p">,</span> <span class="s1">&#39;batman&#39;</span><span class="p">);</span>
<span class="linenos" data-linenos="12 "></span>        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">assertSame</span><span class="p">(</span><span class="s1">&#39;batman&#39;</span><span class="p">,</span> <span class="nv">$pila</span><span class="p">[</span><span class="nb">count</span><span class="p">(</span><span class="nv">$pila</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">]);</span>
<span class="linenos" data-linenos="13 "></span>        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">assertSame</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">count</span><span class="p">(</span><span class="nv">$pila</span><span class="p">));</span>
<span class="linenos" data-linenos="14 "></span>
<span class="linenos" data-linenos="15 "></span>        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">assertSame</span><span class="p">(</span><span class="s1">&#39;batman&#39;</span><span class="p">,</span> <span class="nb">array_pop</span><span class="p">(</span><span class="nv">$pila</span><span class="p">));</span>
<span class="linenos" data-linenos="16 "></span>        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">assertSame</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">count</span><span class="p">(</span><span class="nv">$pila</span><span class="p">));</span>
<span class="linenos" data-linenos="17 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="18 "></span><span class="p">}</span>
</code></pre></div>
<p>Tenemos diferentes formas de ejecutar una prueba:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>./vendor/bin/phpunit tests/PilaTest.php
<span class="linenos" data-linenos="2 "></span>./vendor/bin/phpunit tests
<span class="linenos" data-linenos="3 "></span>./vendor/bin/phpunit --testdox tests
<span class="linenos" data-linenos="4 "></span>./vendor/bin/phpunit --testdox --colors tests
</code></pre></div>
<h3 id="disenando-pruebas">Diseñando pruebas<a class="headerlink" href="#disenando-pruebas" title="Permanent link">&para;</a></h3>
<p>Tal como hemos visto en el ejemplo, la clase de prueba debe heredar de <code>TestCase</code>, y el nombre de la clase debe acabar en <code>Test</code>, de ahí que hayamos llamado la clase de prueba como <code>PilaTest</code>.</p>
<p>Una prueba implica un método de prueba (público) por cada funcionalidad a probar. Cada un de los métodos se les asocia un caso de prueba.</p>
<p>Los métodos deben nombrarse con el prefijo <code>test</code>, por ejemplo, <code>testPushAndPop</code>. Es muy importante que el nombre sea muy claro y descriptivo del propósito de la prueba. (<em>camelCase</em>).</p>
<p>En los casos de prueba prepararemos varias aserciones para toda la casuística: rangos de valores, tipos de datos, excepciones, etc...</p>
<h3 id="aserciones">Aserciones<a class="headerlink" href="#aserciones" title="Permanent link">&para;</a></h3>
<p>Las aserciones permiten comprobar el resultado de los métodos que queremos probar. Las aserciones esperan que el predicado siempre sea verdadero.</p>
<p>PHPUnit ofrece las siguiente aserciones:</p>
<ul>
<li><code>assertTrue</code> / <code>assertFalse</code>: Comprueba que la condición dada sea evaluada como true / false</li>
<li><code>assertEquals</code> / <code>assertSame</code>: Comprueba que dos variables sean iguales</li>
<li><code>assertNotEquals</code> / <code>assertNotSame</code>: Comprueba que dos variables NO sean iguales<ul>
<li><code>Same</code> → comprueba los tipos. Si no coinciden los tipos y los valores, la aserción fallará</li>
<li><code>Equals</code> → sin comprobación estricta</li>
</ul>
</li>
<li><code>assertArrayHasKey</code> / <code>assertArrayNotHasKey</code>: Comprueba que un array posea un <em>key</em> determinado / o NO lo posea</li>
<li><code>assertArraySubset</code>: Comprueba que un array posea otro array como subset del mismo</li>
<li><code>assertAttributeContains</code> / <code>assertAttributeNotContains</code>: Comprueba que un atributo de una clase contenga una variable determinada / o NO contenga una variable determinada</li>
<li><code>assertAttributeEquals</code>: Comprueba que un atributo de una clase sea igual a una variable determinada.</li>
</ul>
<h3 id="comparando-la-salida">Comparando la salida<a class="headerlink" href="#comparando-la-salida" title="Permanent link">&para;</a></h3>
<p>Si los métodos a probar generan contenido mediante <code>echo</code> o una instrucción similar, disponemos de las siguiente expectativas:</p>
<ul>
<li><code>expectOutputString(salidaEsperada)</code></li>
<li><code>expectOutputRegex(expresionRegularEsperada)</code></li>
</ul>
<p>Las expectativas difieren de las aserciones que informan del resultado que se espera antes de invocar al método. Tras definir la expectativa, se invoca al método que realiza el <code>echo</code>/<code>print</code>.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos=" 2 "></span><span class="k">namespace</span> <span class="nx">Dwes\Videoclub\Model</span><span class="p">;</span>
<span class="linenos" data-linenos=" 3 "></span>
<span class="linenos" data-linenos=" 4 "></span><span class="k">use</span> <span class="nx">PHPUnit\Framework\TestCase</span><span class="p">;</span>
<span class="linenos" data-linenos=" 5 "></span><span class="k">use</span> <span class="nx">Dwes\Videoclub\Model\CintaVideo</span><span class="p">;</span>
<span class="linenos" data-linenos=" 6 "></span>
<span class="linenos" data-linenos=" 7 "></span><span class="k">class</span> <span class="nc">CintaVideoTest</span> <span class="k">extends</span> <span class="nx">TestCase</span> <span class="p">{</span>
<span class="linenos" data-linenos=" 8 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="nf">testConstructor</span><span class="p">()</span>
<span class="linenos" data-linenos=" 9 "></span>    <span class="p">{</span>
<span class="linenos" data-linenos="10 "></span>        <span class="nv">$cinta</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">CintaVideo</span><span class="p">(</span><span class="s2">&quot;Los cazafantasmas&quot;</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">,</span> <span class="mi">107</span><span class="p">);</span> 
<span class="linenos" data-linenos="11 "></span>        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">assertSame</span><span class="p">(</span> <span class="nv">$cinta</span><span class="o">-&gt;</span><span class="na">getNumero</span><span class="p">(),</span> <span class="mi">23</span><span class="p">);</span>
<span class="linenos" data-linenos="12 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="13 "></span>
<span class="linenos" data-linenos="14 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="nf">testMuestraResumen</span><span class="p">()</span>
<span class="linenos" data-linenos="15 "></span>    <span class="p">{</span>
<span class="linenos" data-linenos="16 "></span>        <span class="nv">$cinta</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">CintaVideo</span><span class="p">(</span><span class="s2">&quot;Los cazafantasmas&quot;</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">,</span> <span class="mi">107</span><span class="p">);</span>
<span class="linenos" data-linenos="17 "></span>        <span class="nv">$resultado</span> <span class="o">=</span> <span class="s2">&quot;&lt;br&gt;Película en VHS:&quot;</span><span class="p">;</span>
<span class="linenos" data-linenos="18 "></span>        <span class="nv">$resultado</span> <span class="o">.=</span> <span class="s2">&quot;&lt;br&gt;Los cazafantasmas&lt;br&gt;3.5 (IVA no incluido)&quot;</span><span class="p">;</span>
<span class="linenos" data-linenos="19 "></span>        <span class="nv">$resultado</span> <span class="o">.=</span> <span class="s2">&quot;&lt;br&gt;Duración: 107 minutos&quot;</span><span class="p">;</span>
<span class="linenos" data-linenos="20 "></span>        <span class="c1">// definimos la expectativa</span>
<span class="linenos" data-linenos="21 "></span>        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">expectOutputString</span><span class="p">(</span><span class="nv">$resultado</span><span class="p">);</span>
<span class="linenos" data-linenos="22 "></span>        <span class="c1">// invocamos al método que hará echo</span>
<span class="linenos" data-linenos="23 "></span>        <span class="nv">$cinta</span><span class="o">-&gt;</span><span class="na">muestraResumen</span><span class="p">();</span>
<span class="linenos" data-linenos="24 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="25 "></span><span class="p">}</span>
</code></pre></div>
<h3 id="proveedores-de-datos">Proveedores de datos<a class="headerlink" href="#proveedores-de-datos" title="Permanent link">&para;</a></h3>
<p>Cuando tenemos pruebas que solo cambian respecto a los datos de entrada y de salida, es útil utilizar proveedores de datos.</p>
<p>Se declaran en el docblock mediante <code>@dataProvider nombreMetodo</code>, donde se indica el nombre de un método público que devuelve un array de arrays, donde cada elemento es un caso de prueba.</p>
<p>La clase de prueba recibe como parámetros los datos a probar y el resultado de la prueba como último parámetro.</p>
<p>El siguiente ejemplo comprueba con diferentes datos el funcionamiento de <code>muestraResumen</code>:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos=" 2 "></span><span class="sd">/**</span>
<span class="linenos" data-linenos=" 3 "></span><span class="sd"> * @dataProvider cintasProvider</span>
<span class="linenos" data-linenos=" 4 "></span><span class="sd"> */</span>
<span class="linenos" data-linenos=" 5 "></span><span class="k">public</span> <span class="k">function</span> <span class="nf">testMuestraResumenConProvider</span><span class="p">(</span><span class="nv">$titulo</span><span class="p">,</span> <span class="nv">$id</span><span class="p">,</span> <span class="nv">$precio</span><span class="p">,</span> <span class="nv">$duracion</span><span class="p">,</span> <span class="nv">$esperado</span><span class="p">)</span>
<span class="linenos" data-linenos=" 6 "></span><span class="p">{</span>
<span class="linenos" data-linenos=" 7 "></span>    <span class="nv">$cinta</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">CintaVideo</span><span class="p">(</span><span class="nv">$titulo</span><span class="p">,</span> <span class="nv">$id</span><span class="p">,</span> <span class="nv">$precio</span><span class="p">,</span> <span class="nv">$duracion</span><span class="p">);</span>
<span class="linenos" data-linenos=" 8 "></span>    <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">expectOutputString</span><span class="p">(</span><span class="nv">$esperado</span><span class="p">);</span>
<span class="linenos" data-linenos=" 9 "></span>    <span class="nv">$cinta</span><span class="o">-&gt;</span><span class="na">muestraResumen</span><span class="p">();</span>
<span class="linenos" data-linenos="10 "></span><span class="p">}</span>
<span class="linenos" data-linenos="11 "></span>
<span class="linenos" data-linenos="12 "></span><span class="k">public</span> <span class="k">function</span> <span class="nf">cintasProvider</span><span class="p">()</span> <span class="p">{</span>
<span class="linenos" data-linenos="13 "></span>    <span class="k">return</span> <span class="p">[</span>
<span class="linenos" data-linenos="14 "></span>        <span class="s2">&quot;cazafantasmas&quot;</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s2">&quot;Los cazafantasmas&quot;</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">,</span> <span class="mi">107</span><span class="p">,</span> <span class="s2">&quot;&lt;br&gt;Película en VHS:&lt;br&gt;Los cazafantasmas&lt;br&gt;3.5 €(IVA no incluido)&lt;br&gt;Duración: 107 minutos&quot;</span><span class="p">],</span>
<span class="linenos" data-linenos="15 "></span>        <span class="s2">&quot;superman&quot;</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s2">&quot;Superman&quot;</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">188</span><span class="p">,</span> <span class="s2">&quot;&lt;br&gt;Película en VHS:&lt;br&gt;Superman&lt;br&gt;3 € (IVA no incluido)&lt;br&gt;Duración: 188 minutos&quot;</span><span class="p">],</span>
<span class="linenos" data-linenos="16 "></span>    <span class="p">];</span>
<span class="linenos" data-linenos="17 "></span><span class="p">}</span>
</code></pre></div>
<h3 id="probando-excepciones">Probando excepciones<a class="headerlink" href="#probando-excepciones" title="Permanent link">&para;</a></h3>
<p>Las pruebas además de comprobar que las clases funcionan como se espera,  han de cubrir todos los casos posibles. Así pues, debemos poder hacer pruebas que esperen que se lance una excepción (y que el mensaje contenga cierta información):</p>
<p>Para ello, se utilizan las siguiente expectativas:</p>
<ul>
<li><code>expectException(Excepcion::class)</code></li>
<li><code>expectExceptionCode(codigoExcepcion)</code></li>
<li><code>expectExceptionMessage(mensaje)</code></li>
</ul>
<p>Del mismo modo que antes, primero se pone la expectativa, y luego se provoca que se lance la excepción:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos=" 2 "></span><span class="k">public</span> <span class="k">function</span> <span class="nf">testAlquilarCupoLleno</span><span class="p">()</span> <span class="p">{</span>
<span class="linenos" data-linenos=" 3 "></span>    <span class="nv">$soporte1</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">CintaVideo</span><span class="p">(</span><span class="s2">&quot;Los cazafantasmas&quot;</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">,</span> <span class="mi">107</span><span class="p">);</span> 
<span class="linenos" data-linenos=" 4 "></span>    <span class="nv">$soporte2</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Juego</span><span class="p">(</span><span class="s2">&quot;The Last of Us Part II&quot;</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="mf">49.99</span><span class="p">,</span> <span class="s2">&quot;PS4&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="linenos" data-linenos=" 5 "></span>    <span class="nv">$soporte3</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Dvd</span><span class="p">(</span><span class="s2">&quot;Origen&quot;</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="s2">&quot;es,en,fr&quot;</span><span class="p">,</span> <span class="s2">&quot;16:9&quot;</span><span class="p">);</span> 
<span class="linenos" data-linenos=" 6 "></span>    <span class="nv">$soporte4</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Dvd</span><span class="p">(</span><span class="s2">&quot;El Imperio Contraataca&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;es,en&quot;</span><span class="p">,</span><span class="s2">&quot;16:9&quot;</span><span class="p">);</span> 
<span class="linenos" data-linenos=" 7 "></span>
<span class="linenos" data-linenos=" 8 "></span>    <span class="nv">$cliente1</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Cliente</span><span class="p">(</span><span class="s2">&quot;Bruce Wayne&quot;</span><span class="p">,</span> <span class="mi">23</span><span class="p">);</span> 
<span class="linenos" data-linenos=" 9 "></span>    <span class="nv">$cliente1</span><span class="o">-&gt;</span><span class="na">alquilar</span><span class="p">(</span><span class="nv">$soporte1</span><span class="p">);</span> 
<span class="linenos" data-linenos="10 "></span>    <span class="nv">$cliente1</span><span class="o">-&gt;</span><span class="na">alquilar</span><span class="p">(</span><span class="nv">$soporte2</span><span class="p">);</span> 
<span class="linenos" data-linenos="11 "></span>    <span class="nv">$cliente1</span><span class="o">-&gt;</span><span class="na">alquilar</span><span class="p">(</span><span class="nv">$soporte3</span><span class="p">);</span> 
<span class="linenos" data-linenos="12 "></span>
<span class="linenos" data-linenos="13 "></span>    <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">expectException</span><span class="p">(</span><span class="nx">CupoSuperadoException</span><span class="o">::</span><span class="na">class</span><span class="p">);</span>
<span class="linenos" data-linenos="14 "></span>    <span class="nv">$cliente1</span><span class="o">-&gt;</span><span class="na">alquilar</span><span class="p">(</span><span class="nv">$soporte4</span><span class="p">);</span> 
<span class="linenos" data-linenos="15 "></span><span class="p">}</span>
</code></pre></div>
<h3 id="cobertura-de-codigo">Cobertura de código<a class="headerlink" href="#cobertura-de-codigo" title="Permanent link">&para;</a></h3>
<p>La cobertura de pruebas indica la cantidad de código que las pruebas cubren, siendo recomendable que cubran entre el 95 y el 100%.</p>
<p>Una de las métricas asociadas a los informes de cobertura es el CRAP (Análisis y Predicciones sobre el Riesgo en Cambios), el cual mide la cantidad de esfuerzo, dolor y tiempo requerido para mantener una porción de código. Esta métrica debe mantenerse con un valor inferior a 5.</p>
<div class="admonition warning">
<p class="admonition-title">Requisito xdebug</p>
<p>Aunque ya viene instalado dentro de PHPUnit, para que funcione la cobertura del código, es necesario que el código PHP se ejecute con XDEBUG, y e indicarle a Apache que así es (colocando en el archivo de configuración <code>php.ini</code>la directiva <code>xdebug.mode=coverage</code>).</p>
</div>
<p>Añadimos en <code>composer.json</code> un nuevo <em>script</em>:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="nt">&quot;coverage&quot;</span><span class="p">:</span> <span class="s2">&quot;phpunit --coverage-html coverage --coverage-filter app tests&quot;</span>
</code></pre></div>
<p>Y posteriormente ejecutamos</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>composer coverage
</code></pre></div>
<p>Por ejemplo, si accedemos a la clase <code>CintaVideo</code> con la prueba que habíamos realizado anteriormente, podemos observar la cobertura que tiene al 100% y que su CRAP es 2.</p>
<figure style="align: center;">
    <img src="imagenes/05/coverage.png">
    <figcaption>Informe de cobertura de la clase CintaVideo</figcaption>
</figure>

<div class="admonition warning">
<p class="admonition-title">Temas pendientes</p>
<ul>
<li>Dependencia entre casos de prueba con el atributo <code>@depends</code></li>
<li>Completamente configurable mediante el archivo <code>phpxml.xml</code>: <a href="https://phpunit.readthedocs.io/es/latest/configuration.html">https://phpunit.readthedocs.io/es/latest/configuration.html</a></li>
<li>Preparando las pruebas con <code>setUpBeforeClass()</code> y <code>tearDownAfterClass()</code></li>
<li>Objetos y pruebas <em>Mock</em> (dobles) con <code>createMock()</code></li>
</ul>
</div>
<h2 id="referencias">Referencias<a class="headerlink" href="#referencias" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="https://desarrolloweb.com/manuales/tutorial-composer.html">Tutorial de Composer</a></li>
<li><a href="https://www.freecodecamp.org/news/web-scraping-with-php-crawl-web-pages/">Web Scraping with PHP – How to Crawl Web Pages Using Open Source Tools</a></li>
<li><a href="https://zetcode.com/php/monolog/">PHP Monolog</a></li>
<li><a href="https://medium.com/@emilianozublena/unit-testing-con-phpunit-parte-1-148c6d73e822">Unit Testing con PHPUnit — Parte 1</a>, de Emiliano Zublena.</li>
</ul>
<h2 id="actividades">Actividades<a class="headerlink" href="#actividades" title="Permanent link">&para;</a></h2>
<h3 id="monolog_1">Monolog<a class="headerlink" href="#monolog_1" title="Permanent link">&para;</a></h3>
<ol start="501">
<li>
<p>Crea un nuevo proyecto con <em>Composer</em> llamado <code>Monologos</code>:</p>
<ul>
<li>Incluye como librería la última versión de Monolog.</li>
<li>Crea la clase <code>Dwes\Monologos\HolaMonolog</code>.</li>
<li>Define una propiedad privada nombrada <code>miLog</code> para guardar el log.</li>
<li>Define en el constructor un <code>RotatingFileHandler</code> que escriba en la carpeta <code>logs</code> del proyecto, y que almacene los mensajes a partir de <em>debug</em>.</li>
<li>Crea los métodos <code>saludar</code> y <code>despedir</code> que hagan un log de tipo <em>info</em> con la acción correspondiente.</li>
</ul>
</li>
<li>
<p>Siguiendo con el proyecto <code>Monologos</code>:</p>
<ul>
<li>Crea un archivo llamado <code>inicio.php</code> que permita probar <code>HolaMonolog</code>.</li>
<li>Comprueba que los mensajes aparecen en el <em>log</em>.</li>
<li>Cambia el nivel para que el manejador solo muestre los mensajes a partir de <em>warning</em>.</li>
<li>Vuelve a ejectuar <code>inicio.php</code> y comprueba el archivo de log.</li>
</ul>
</li>
<li>Modifica la clase <code>HolaMonolog</code>:<ul>
<li>En el constructor, añade a la pila un manejador que escriba a la salida de error conjunto al procesador de introspección, mostrando mensajes desde el nivel <em>debug</em>.</li>
<li>Añade una propiedad denominada <code>hora</code>, la cual se inicializa únicamente como parámetro del constructor. Si la <code>hora</code> es inferior a 0 o mayor de 24, debe escribir un log de <em>warning</em> con un mensaje apropiado.</li>
<li>Modifica los métodos <code>saludar</code> y <code>despedir</code> para hacerlo acorde a la propiedad <code>hora</code> (buenos días, buenas tardes, hasta mañana, etc...)</li>
</ul>
</li>
</ol>
<h3 id="proyecto-videoclub-iv">Proyecto Videoclub IV<a class="headerlink" href="#proyecto-videoclub-iv" title="Permanent link">&para;</a></h3>
<ol start="511">
<li>
<p>Como ya tenemos <em>Composer</em> instalado:</p>
<ul>
<li>Inicialízalo dentro de tu proyecto <em>Videoclub</em></li>
<li>Incluye <em>Monolog</em> y <em>PhpUnit</em>, cada una en su lugar adecuado.</li>
<li>Añade el <em>autoload</em> al archivo <code>composer.json</code>, y haz los cambios necesarios en las clases para utilizar el <em>autoload</em> de <em>Composer</em>.</li>
<li>Sube los cambios a <em>GitHub</em> y crea la etiqueta <code>v0.511</code>.</li>
</ul>
</li>
<li>
<p>Modifica la clase <code>Cliente</code> para introducir un <code>Logger</code> de <em>Monolog</em>.</p>
<ul>
<li>Añade el log como una propiedad de la clase e inicialízalo en el constructor, con el nombre del canal <code>VideoclubLogger</code>.</li>
<li>Se debe almacenar en <code>logs/videoclub.log</code> mostrando todos los mensajes desde <em>debug</em>.</li>
<li>Antes de lanzar cualquier excepción, debe escribir un log de tipo <em>warning</em>.</li>
<li>Sustituir los <code>echo</code> que haya en el código, que ahora pasarán por el log con el nivel info, a excepción del método <code>muestraResumen</code> que seguirá haciendo <code>echo</code>.</li>
</ul>
</li>
<li>
<p>Vuelve a hacer lo mismo que en el ejercicio anterior, pero ahora con la clase <code>Videoclub</code>. Además:</p>
<ul>
<li>Siempre que se llame a un método del log, se le pasará como segundo parámetro la información que dispongamos.</li>
<li>Ejecuta el archivo de prueba y comprueba que el log se rellena correctamente.</li>
</ul>
</li>
<li>
<p>Vamos a refactorizar el código común de inicialización de <em>Monolog</em> que tenemos repetidos en los constructores a una factoría de <em>Monolog</em>, la cual colocaremos en <code>\Dwes\Videoclub\Util\LogFactory</code>. Comprueba que sigue funcionando correctamente.</p>
</li>
<li>
<p>Modifica la factoría para que devuelva <code>LogInterface</code> y comprueba que sigue funcionando. Sube los cambios a GitHub con la etiqueta <code>v0.515</code>.</p>
</li>
</ol>
<h3 id="phpdocumentor">phpDocumentor<a class="headerlink" href="#phpdocumentor" title="Permanent link">&para;</a></h3>
<ol start="521">
<li>Comprueba que en el contenedor de Docker funciona <em>phpDocumentor</em>.
Ejecuta phpdoc sobre tu proyecto <em>Monolog</em> y comprueba el api que se crea.
Comenta tanto la clase como los métodos, y posteriormente, vuelve a ejecutar phpdoc.</li>
<li>Documenta el proyecto <em>Videoclub</em>, y genera la documentación. Empieza por las clases de <code>Soporte</code> y sus hijos. Comprueba el resultado. Luego sigue con <code>Cliente</code> y finalmente <code>Videoclub</code>.</li>
</ol>
<h3 id="web-scraping_1">Web Scraping<a class="headerlink" href="#web-scraping_1" title="Permanent link">&para;</a></h3>
<ol start="531">
<li>
<p>A partir de los datos de <a href="http://www.seleccionbaloncesto.es">http://www.seleccionbaloncesto.es</a>, calcula la altura y edad media del equipo de baloncesto masculino. Observa que tienes los datos dentro de una tabla debajo de las noticias.</p>
</li>
<li>
<p>Volviendo al Videoclub, en <code>Soporte</code> añade una propiedad llamada <code>metacritic</code> para almacenar la URL de cada soporte. A continuación, modifica los métodos <code>incluirXXX</code> de <code>Videoclub</code> para que admitan como primer parámetro dicha URL. Tras ello, modifica el fichero <code>inicio3.php</code> para pasarle la URL  de cada soporte (para ello deberás consultarlos en Metacritic haciendo búsquedas manuales). Por ejemplo, en el caso de la película Cazafantasmas, su URL es <a href="https://www.metacritic.com/movie/ghostbusters">https://www.metacritic.com/movie/ghostbusters</a>.</p>
</li>
<li>
<p>Finalmente, añade un método abstracto en <code>Soporte</code> llamado <code>getPuntuacion</code>, que haciendo uso de <em>Web Scraping</em> se conecte a <em>Metacritic</em> y obtenga su puntuación. Modifica <code>inicio3.php</code> para obtener todos los alquileres de un cliente mediante <code>getAlquileres() : array</code>, y para cada uno de ellos, además del título, muestra su puntuación.</p>
</li>
</ol>
<h3 id="phpunit">phpUnit<a class="headerlink" href="#phpunit" title="Permanent link">&para;</a></h3>
<ol start="541">
<li>
<p>A partir de la clase <code>HolaMonolog</code>, modifica los métodos para que además de escribir en en log, devuelvan el saludo como una cadena.<br />
Crea la clase <code>HolaMonologTest</code> y añade diferentes casos de prueba para comprobar que los saludos y despedidas son acordes a la hora con la que se crea la clase.</p>
</li>
<li>
<p>Vamos a simular <em>Test Driven Development</em>. Queremos que nuestra aplicación almacene los últimos tres saludos que ha realizado. Para ello:</p>
<ul>
<li>Crea las prueba necesarias (invoca al método <code>saludar</code> varias veces y llama al método que te devuelva los saludos almacenados)</li>
<li>Implementa el código para pasar las pruebas</li>
<li>Refactoriza el código</li>
</ul>
</li>
<li>
<p>Crea una nueva prueba que utilice proveedores de datos para comprobar esta última funcionalidad, pasándole:</p>
<ul>
<li>Un saludo.</li>
<li>Tres saludos.</li>
<li>Cuatro saludos.</li>
</ul>
</li>
<li>
<p>¿Recuerdas que si la hora es negativa o superior a 24 escribíamos en el log un <em>warning</em>?
Ahora debe lanzar una excepción de tipo <code>InvalidArgumentException</code> (como la excepción forma para de PHP, hay que poner su FQN: <code>\InvalidArgumentException</code>). Vuelve a aplicar TDD y completa tus casos de prueba.</p>
</li>
<li>
<p>Comenta la última prueba realizada (la comprobación de las excepciones) y realiza un informe de cobertura de pruebas. Analiza los resultados obtenidos. Elimina los últimos comentarios sobre la última prueba y vuelve a generar y analizar el informe de cobertura.</p>
</li>
</ol>
<h3 id="proyecto-videoclub-v">Proyecto Videoclub V<a class="headerlink" href="#proyecto-videoclub-v" title="Permanent link">&para;</a></h3>
<p>El objetivo de los siguientes ejercicios es conseguir de manera incremental una cobertura de pruebas superior al 95%.</p>
<ol start="551">
<li>
<p>Crea pruebas dentro de la carpeta <code>tests</code> para las clases <code>Soporte</code>, <code>CintaVideo</code>, <code>Dvd</code> y <code>Juego</code>.
Recuerda respetar el espacio de nombres.
Los métodos <code>muestraResumen</code>, tras hacer echo de los mensajes, deben devolver una cadena con el propio mensaje.</p>
</li>
<li>
<p>Crea pruebas para la clase <code>Cliente</code>, aprovechando todo el código que teníamos para comprobar la funcionalidad.
Utiliza proveedores de datos para añadir conjuntos de datos mayores que los empleados.
Comprueba que funciona con diferentes cupos, que al intentar alquilar un soporte marcado como ya alquilado debe lanzar una excepción, que no coincidan los ids de los soportes, etc...</p>
</li>
<li>
<p>Crea las pruebas para la clase <code>Videoclub</code>. Ten en cuenta los últimos métodos añadidos que permitían alquilar y devolver soportes, tanto de manera individual como mediante un array.</p>
</li>
<li>
<p>Crea el informe de cobertura. Una vez creado, analiza los datos de cobertura (&gt;= 90%) y comprueba el valor de CRAP, de manera que siempre sea &lt;= 5.
En caso de no cumplirse, crea nuevos casos de prueba y/o refactoriza el código de tu aplicación.</p>
</li>
</ol>
<p>Sube los cambios a GitHub con la etiqueta <code>v0.554</code>.</p>
<h3 id="ampliacion">Ampliación<a class="headerlink" href="#ampliacion" title="Permanent link">&para;</a></h3>
<ol start="561">
<li>
<p>Queremos que en <code>Videoclub</code>, cuando un cliente no existe (tanto al alquilar como al devolver) se lance una nueva excepción: <code>ClienteNoExisteException</code>.
Además, dado el número creciente de excepciones, queremos mover las excepciones al namespace <code>Dwes\Videoclub\Exception</code>.<br />
Siguiendo TDD, primero crea las pruebas, y luego modifica el código de aplicación.<br />
Vuelve a generar el informe de cobertura y comprueba la calidad de nuestras pruebas.</p>
</li>
<li>
<p>¿Nadie se ha dado cuenta que en los Dvd no estamos almacenando su duración?
Haz todos los cambios necesarios, primero en las pruebas y luego en el código.</p>
</li>
<li>
<p>Tras años luchando contra la tecnología, decidimos introducir los Blu-ray en nuestra empresa.
Hemos decido que <code>Bluray</code> herede de <code>Soporte</code>.
Además del <code>título</code> y la <code>duracion</code>, nos interesa almacenar si <code>es4k</code>.
Haz todos los cambios necesarios, primero en las pruebas y luego en el código.</p>
</li>
</ol>
<p>Sube los cambios a GitHub con la etiqueta <code>v0.563</code>.</p>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Pie">
      
        
        <a href="04web.html" class="md-footer__link md-footer__link--prev" aria-label="Anterior: 4.- Programación Web" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Anterior
              </span>
              4.- Programación Web
            </div>
          </div>
        </a>
      
      
        
        <a href="06accesoDatos.html" class="md-footer__link md-footer__link--next" aria-label="Siguiente: 6.- Acceso a Datos" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Siguiente
              </span>
              6.- Acceso a Datos
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            2021-2022 Aitor Medrano - Licencia CC BY-NC-SA
          </div>
        
        
          Made with
          <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
            Material for MkDocs
          </a>
        
        
      </div>
      
  <div class="md-footer-social">
    
      
      
        
        
      
      <a href="https://twitter.com/aitormedrano" target="_blank" rel="noopener" title="twitter.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M22.46 6c-.77.35-1.6.58-2.46.69.88-.53 1.56-1.37 1.88-2.38-.83.5-1.75.85-2.72 1.05C18.37 4.5 17.26 4 16 4c-2.35 0-4.27 1.92-4.27 4.29 0 .34.04.67.11.98C8.28 9.09 5.11 7.38 3 4.79c-.37.63-.58 1.37-.58 2.15 0 1.49.75 2.81 1.91 3.56-.71 0-1.37-.2-1.95-.5v.03c0 2.08 1.48 3.82 3.44 4.21a4.22 4.22 0 0 1-1.93.07 4.28 4.28 0 0 0 4 2.98 8.521 8.521 0 0 1-5.33 1.84c-.34 0-.68-.02-1.02-.06C3.44 20.29 5.7 21 8.12 21 16 21 20.33 14.46 20.33 8.79c0-.19 0-.37-.01-.56.84-.6 1.56-1.36 2.14-2.23z"/></svg>
      </a>
    
      
      
      <a href="mailto:<a.medrano@edu.gva.es>" target="_blank" rel="noopener" title="" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 12.13c-.15.01-.29.06-.39.17l-1 1 2.05 2 1-1c.22-.21.22-.56 0-.77l-1.24-1.23a.557.557 0 0 0-.38-.17m-2 1.75L13 19.94V22h2.06l6.06-6.07M20 4H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h7v-.89l8.24-8.22c.47-.49 1.12-.76 1.8-.76.34 0 .68.06 1 .19V6c0-1.12-.92-2-2.04-2m0 4-8 5-8-5V6l8 5 8-5"/></svg>
      </a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": ".", "features": ["header.autohide", "toc.integrate", "content.tabs.link"], "translations": {"clipboard.copy": "Copiar al portapapeles", "clipboard.copied": "Copiado al portapapeles", "search.config.lang": "es", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "B\u00fasqueda", "search.result.placeholder": "Teclee para comenzar b\u00fasqueda", "search.result.none": "No se encontraron documentos", "search.result.one": "1 documento encontrado", "search.result.other": "# documentos encontrados", "search.result.more.one": "1 m\u00e1s en esta p\u00e1gina", "search.result.more.other": "# m\u00e1s en esta p\u00e1gina", "search.result.term.missing": "Falta", "select.version.title": "Seleccionar versi\u00f3n"}, "search": "assets/javascripts/workers/search.fcfe8b6d.min.js", "version": null}</script>
    
    
      <script src="assets/javascripts/bundle.b1047164.min.js"></script>
      
    
  </body>
</html>